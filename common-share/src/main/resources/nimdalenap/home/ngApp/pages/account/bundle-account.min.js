angular.module("emixApp.controllers").controller("login_index",["$http","$scope","$rootScope","httpServices","sharedInfo","$cookies",function(n,t,i,r,u){"use strict";NProgress.done();$.unblockUI();t.title=new Date;t.userName="";t.password="";t.showError=!1;t.nextFocus=function(n){document.getElementById(n).focus()};t.headers={};t.login=function(){(t.showError=!0,t.myForm.$valid)&&(NProgress.start(),$.blockUI(),r.login(t.userName,t.password,"","","").then(function(n){var t=n.data;u.saveUserData(t.name+" "+t.family);u.saveUserId(t.userId);u.saveUserLogoPath(t.logoPath);r.redirect(Emix.Pages.dashboard);$("body").attr("class","skin-blue ng-scope");jQuery(".sidebar-toggle").show();jQuery(".navbar-custom-menu").show();i.$emit("CallUpdateInfo",{});i.$emit("CallUpdateMenu",{})},function(n){r.handleError(n.data,n.status,n.headers,n.config)}).finally(function(){NProgress.done();$.unblockUI()}))};r.checkIsLogin()}]);angular.module("emixApp.controllers").controller("logout_index",["$scope","httpServices",function(n,t){"use strict";n.logout=function(){NProgress.start();$.blockUI();t.logout().then(function(n){var i=n.data;$.removeCookie("accessToken",{path:"/"});t.redirect(Emix.Pages.login)},function(n){t.handleError(n.data,n.status,n.headers,n.config)}).finally(function(){NProgress.done();$.unblockUI()})};n.logout()}]);angular.module("emixApp.controllers").controller("profile_index",["$scope","httpServices","FileUploader","$rootScope","sharedInfo",function(n,t,i,r,u){"use strict";var f,e;jQuery.cookie("accessToken")===undefined&&$("body").attr("class")==="skin-blue ng-scope"||(jQuery(".sidebar-toggle").show(),jQuery(".navbar-custom-menu").show());n.result="";n.getCityList=function(){NProgress.start();$.blockUI();t.getCityList().then(function(t){var i=t.data;n.cities=i.returnObject;n.selectedCity=n.cities[0].id},function(n){t.handleError(n.data,n.status,n.headers,n.config)}).finally(function(){NProgress.done();$.unblockUI()})};n.getCityList();n.getUserInfo=function(){NProgress.start();$.blockUI();t.getUserInfo().then(function(t){var i=t.data;n.result=i.returnObject},function(n){t.handleError(n.data,n.status,n.headers,n.config)}).finally(function(){NProgress.done();$.unblockUI()})};n.updateUserInfo=function(){if(n.showError=!0,n.myForm.$valid){NProgress.start();$.blockUI();var i={id:n.result.id,firstName:n.result.firstName,lastName:n.result.lastName,mobileNumber:n.result.mobileNumber,email:n.result.email,cityId:n.result.city.id,address:n.result.address,gender:n.result.gender};t.updateUserInfo(i).then(function(t){var i=t.data;f.uploadAll();toastr.success("تغییرات با موفقیت ثبت شد.");u.saveUserData(n.result.firstName+" "+n.result.lastName);r.$emit("CallUpdateInfo",{})},function(n){t.handleError(n.data,n.status,n.headers,n.config)}).finally(function(){NProgress.done();$.unblockUI()})}};n.getUserInfo();f=n.uploader=new i({queueLimit:1,url:Emix.Api.Profile.uploadProfileImage,headers:{Authorization:"Bearer "+$.cookie("accessToken")}});f.filters.push({name:"imageFilter",fn:function(n){var t="|"+n.type.slice(n.type.lastIndexOf("/")+1)+"|",i;return t=t.toLowerCase(),i="|jpg|jpeg|".indexOf(t)!==-1,i||toastr.error("شما فقط مجاز به انتخاب عکس با پسوند jpg یا jpeg میباشید."),i}});f.filters.push({name:"imageCountFilter",fn:function(){return!(f.queue.length>1)}});f.onWhenAddingFileFailed=function(){};f.onAfterAddingFile=function(t){t.croppedImage="";loadImage(t._file,function(i){n.$apply(function(){t.image=i.toDataURL("image/jpeg");r.$emit("NeedResizePage",{})})},{canvas:!0,orientation:!0})};f.onAfterAddingAll=function(){};f.onBeforeUploadItem=function(t){var i=e(t.croppedImage);t._file=i;t.alias="image";t.formData.push({id:n.result.id})};e=function(n){for(var i=atob(n.split(",")[1]),u=n.split(",")[0].split(":")[1].split(";")[0],r=[],t=0;t<i.length;t++)r.push(i.charCodeAt(t));return new Blob([new Uint8Array(r)],{type:u})};f.onProgressItem=function(){};f.onProgressAll=function(){};f.onSuccessItem=function(){toastr.success("عکس شما با موفقیت به روزرسانی شد.");var n=new Date;$("#userpic").attr("src",$("#userpic").attr("src")+"?dt="+n.getTime());$("#userpicheader").attr("src",$("#userpic").attr("src")+"?dt="+n.getTime());f.clearQueue()};f.onErrorItem=function(n,t){var i=t;toastr.error("در حین آپلود عکس خطایی رخ داد.");f.clearQueue()};f.onCancelItem=function(){};f.onCompleteItem=function(){};f.onCompleteAll=function(){console.info("onCompleteAll")};n.mRemoveItem=function(n){n.remove()};f.clearQueue();n.enableCrop=!0;n.changeOnFly=!1;n.maximizeCrop=!0;n.size="large";n.type="circle";n.aspectRatio="1x1";n.imageDataURI="";n.resImageDataURI="";n.resImgFormat="image/jpeg";n.resImgQuality=1;n.selMinSize=200;n.resImgSize=100;n.onChange=function(){console.log("onChange fired")};n.onLoadBegin=function(){console.log("onLoadBegin fired")};n.onLoadDone=function(){console.log("onLoadDone fired")};n.onLoadError=function(){console.log("onLoadError fired")}}]);changeBirthDate=function(){var n=angular.element(document.getElementById("birthDate")).scope();n.birthDate=document.getElementById("birthDate").value;n.$apply()};angular.module("emixApp.controllers").controller("register_index",["$scope","httpServices",function(n,t){"use strict";n.title=new Date;n.userName="";n.password="";n.name="";n.family="";n.gender=2;n.showError=!1;n.getCityList=function(){NProgress.start();$.blockUI();t.getCityList().then(function(t){var i=t.data;n.cities=i.returnObject;n.selectedCity=n.cities[0].id},function(n){t.handleError(n.data,n.status,n.headers,n.config)}).finally(function(){NProgress.done();$.unblockUI()})};n.getCityList();n.nextFocus=function(n){var t=document.getElementById(n);t&&t.focus()};n.back=function(){t.redirect(Emix.Pages.login)};n.checkPassword=function(){n.myForm.confirmPassword.$error.dontMatch=n.password!==n.confirmPassword};n.register=function(){if(n.showError=!0,n.password!==n.confirmPassword&&(n.myForm.$valid=!1),n.myForm.$valid){NProgress.start();$.blockUI();var i={username:n.userName,password:n.password,gender:n.gender,mobileNumber:n.mobile,cityId:n.selectedCity};t.register(i).then(function(n){var i=n.data;toastr.success("ثبت نام شما با موفقیت انجام شد.");t.redirectWithDelay(Emix.Pages.login)},function(n){t.handleError(n.data,n.status,n.headers,n.config)}).finally(function(){NProgress.done();$.unblockUI()})}};t.checkIsLogin()}]);