function todaydate(e){var t=new Array("يكشنبه","دوشنبه","سه شنبه","چهارشنبه","پنج شنبه","جمعه","شنبه"),n=new Array("فروردين","ارديبهشت","خرداد","تير","مرداد","شهريور","مهر","آبان","آذر","دي","بهمن","اسفند"),a=new Date,r=a.getDay(),o=a.getDate()+1,i=a.getMonth()+1,l=a.getYear();switch(!((l=0==l?2e3:l)<1e3)||(l+=1900),l-=i<3||3==i&&o<21?622:621,i){case 1:o<21?(i=10,o+=10):(i=11,o-=20);break;case 2:o<20?(i=11,o+=11):(i=12,o-=19);break;case 3:o<21?(i=12,o+=9):(i=1,o-=20);break;case 4:o<21?(i=1,o+=11):(i=2,o-=20);break;case 5:case 6:o<22?(i-=3,o+=10):(i-=2,o-=21);break;case 7:case 8:case 9:o<23?(i-=3,o+=9):(i-=2,o-=22);break;case 10:o<23?(i=7,o+=8):(i=8,o-=22);break;case 11:case 12:o<22?(i-=3,o+=9):(i-=2,o-=21)}return"longdate"==e?t[r]+"  "+o+"  "+n[i-1]+"  "+l:l+"/"+i+"/"+o}angular.module("emixApp.controllers",[]).directive("bnLazySrc",function(e,t){var n=function(){var n=[],a=null,r=100,o=$(e),i=t,l=i.height(),s=null,u=2e3,c=!1;function d(){if(!a){var e=i.height();e!==l&&(l=e,g())}}function p(){console.log("Checking for visible images...");for(var e=[],t=[],a=o.height(),r=o.scrollTop(),i=r+a,l=0;l<n.length;l++){var s=n[l];s.isVisible(r,i)?e.push(s):t.push(s)}for(l=0;l<e.length;l++)e[l].render();n=t,f(),n.length||m()}function f(){clearTimeout(a),a=null}function g(){a=setTimeout(p,r)}function m(){c=!1,o.off("resize.bnLazySrc"),o.off("scroll.bnLazySrc"),clearInterval(s)}function v(){a||g()}return{addImage:function(e){n.push(e),a||g(),c||(c=!0,o.on("resize.bnLazySrc",v),o.on("scroll.bnLazySrc",v),s=setInterval(d,u))},removeImage:function(e){for(var t=0;t<n.length;t++)if(n[t]===e){n.splice(t,1);break}n.length||(f(),m())}}}();return{link:function(e,t,a){var r=new function(e){var t=null,n=!1,a=null;function r(){e[0].src=t}return{isVisible:function(t,n){if(!e.is(":visible"))return!1;null===a&&(a=e.height());var r=e.offset().top,o=r+a;return r<=n&&r>=t||o<=n&&o>=t||r<=t&&o>=n},render:function(){n=!0,r()},setSource:function(e){t=e,n&&r()}}}(t);n.addImage(r),a.$observe("bnLazySrc",function(e){r.setSource(e)}),e.$on("$destroy",function(){n.removeImage(r)})},restrict:"A"}}),angular.module("emixApp.directives").directive("autofocus",function(){"use strict";return{restrict:"A",link:function(e,t,n){var a=$("input[autofocus],textarea[autofocus],button,select");t.bind("keydown",function(e){if(13===(e.keyCode||e.which)){var t=a.index(this);(a.eq(t+1).length?a.eq(t+1):a.eq(0)).focus()}})}}}),angular.module("emixApp.directives").directive("backbutton",["$translate","$filter","$injector",function(e,t,n){"use strict";return{restrict:"A",link:function(e,a,r){var o=$(a);"بازگشت"!==o.text().trim()&&""!==o.text().trim()||e.$watch(function(){return t("translate")("common.back")},function(e){o.text(e),o.prop("title",e)}),$(a).on("click",function(){if(n.has("$modalStack")){var t=n.get("$modalStack").getTop();if(t&&t.key)return void t.key.dismiss("cancel")}r.backurl?window.location=r.backurl:history.back(),setTimeout(function(){$("html, body").scrollTop(0)},500),e.$apply()})}}}]),angular.module("emixApp.directives").directive("deletebutton",["$translate",function(e){"use strict";return{priority:-100,restrict:"A",link:function(t,n,a){var r=$(n),o="";"حذف"!==r.text().trim()&&""!==$(n).text().trim()||(o=e.instant("common.delete"),0===r.html().length&&r.text(o),r.prop("title",o)),n.bind("click",function(t){var n=a.ngConfirmClick||e.instant("common.deleteConfirm");confirm(n)||(t.stopImmediatePropagation(),t.preventDefault())})}}}]),angular.module("emixApp.directives").directive("buttonType",["$translate","$filter",function(e,t){"use strict";return{restrict:"A",link:function(e,n,a){var r=$(n),o=a.buttonType||"back",i="",l="";("ok"===o||"ثبت"===r.text().trim()&&r)&&(i="common.save"),"back"!==o&&"بازگشت"!==r.text().trim()||(i="common.back"),"cancel"!==o&&"انصراف"!==r.text().trim()||(i="common.cancel"),"delete"!==o&&"حذف"!==r.text().trim()||(i="common.delete"),"new"!==o&&"جدید"!==r.text().trim()||(i="common.new"),"edit"!==o&&"ویرایش"!==r.text().trim()||(i="common.edit"),"approve"!==o&&"تایید"!==r.text().trim()||(i="common.verify"),"details"!==o&&"جزئیات"!==r.text().trim()||(i="common.details"),"print"!==o&&"چاپ"!==r.text().trim()||(i="common.print"),void 0===r.attr("button-text")&&e.$watch(function(){return t("translate")(i)},function(e){l=e,r.text(l),r.prop("title",l)})}}}]),angular.module("emixApp.directives").directive("buttonText",["$translate","$filter",function(e,t){"use strict";return{restrict:"A",link:function(n,a,r){var o=$(a),i=r.buttonText,l=e.instant(i);n.$watch(function(){return t("translate")(i)},function(e){l=e,o.text(l),o.prop("title",l)})}}}]),angular.module("emixApp.directives").directive("messageType",["$translate",function(e){"use strict";return{restrict:"A",link:function(e,t,n){"error"==(n.messageType||"error")&&$(t).css("color","red")}}}]),angular.module("ui.emixLte",[]).directive("ngToggleAsideLte",function(){"use strict";return{restrict:"A",link:function(e,t){$(t).click(function(e){e.preventDefault(),$("body").toggleClass("sidebar-collapse"),$("body").toggleClass("sidebar-open"),"undefined"!=typeof $disowl&&$disowl.trigger("refresh.owl.carousel")})}}}).directive("ngMobileToggleAsideLte",function(){"use strict";return{restrict:"A",link:function(e,t){$(t).click(function(e){$(window).width()<=767&&$("body").hasClass("sidebar-open")&&($("body").removeClass("sidebar-open"),$("body").addClass("sidebar-collapse"))})}}}).directive("ngSidebarTree",function(){"use strict";return{restrict:"A",link:function(e,t){$(document).ready(function(){$("li a",$(t)).click(function(e){var t=$(this),n=t.next();if(n.is(".treeview-menu")&&n.is(":visible"))n.slideUp("normal",function(){n.removeClass("menu-open")}),n.parent("li").removeClass("active");else if(n.is(".treeview-menu")&&!n.is(":visible")){var a=t.parents("ul").first();a.find("ul:visible").slideUp("normal").removeClass("menu-open");var r=t.parent("li");n.slideDown("normal",function(){n.addClass("menu-open"),a.find("li.active").removeClass("active"),r.addClass("active")})}n.is(".treeview-menu")&&e.preventDefault()})})}}}).directive("ngFixLayoutOnResize",["$timeout","$rootScope",function(e,t){"use strict";return{restrict:"A",link:function(e,n){var a=function(){var e=$(".main-header").outerHeight()+$(".main-footer").outerHeight(),t=$(window).height(),n=$(".sidebar").height();$("body").hasClass("fixed")?$(".content-wrapper, .right-side").css("min-height",t-$(".main-footer").outerHeight()):t>=n?$(".content-wrapper, .right-side").css("min-height",t-e):$(".content-wrapper, .right-side").css("min-height",n)};$(document).ready(function(){a(),$(window,".wrapper").resize(function(){a()})}),t.$on("$viewContentLoaded",function(){a()}),t.$on("NeedResizePage",function(){a()})}}}]);"use strict";function format(e,t){if(!e)return e;var n=e.toString();if(void 0===t)return n;if(!angular.isArray(t)&&!angular.isObject(t))return n.split("$0").join(t);var a=angular.isArray(t)?"$":":";return angular.forEach(t,function(e,t){n=n.split(a+t).join(e)}),n}angular.module("emixApp.controllers",[]).directive("ngThumb",["$window",function(e){var t=!(!e.FileReader||!e.CanvasRenderingContext2D),n=function(t){return angular.isObject(t)&&t instanceof e.File},a=function(e){var t="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(t)};return{restrict:"A",template:"<canvas/>",link:function(e,r,o){if(t){var i=e.$eval(o.ngThumb);if(n(i.file)&&a(i.file)){var l=r.find("canvas"),s=new FileReader;s.onload=function(e){var t=new Image;t.onload=u,t.src=e.target.result},s.readAsDataURL(i.file)}}function u(){var e=i.width||this.width/this.height*i.height,t=i.height||this.height/this.width*i.width;l.attr({width:e,height:t}),l[0].getContext("2d").drawImage(this,0,0,e,t)}}}}]),angular.module("emixApp.directives").directive("ngdatebox",function(){return{restrict:"A",link:function(e,t,n){$(t).attr("autocomplete","off"),$(t).on("click",function(){PersianDatePicker.Show(this,this.value),e.$apply()}),$(t).focus(function(){PersianDatePicker.Show(this,this.value),e.$apply()}),$(t).focusout(function(){setTimeout(function(){e.$emit("changeDate",t,n)},1)})}}}),angular.module("/angular-time-picker.tpl.html",[]).run(["$templateCache",function(e){e.put("/angular-time-picker.tpl.html",'<div class="angular-time-picker-rapper">\n\t<span class="angular-time-picker-button"\n\t\tng-class="theme"\n\t\tng-attr-title="{{elementTitle | translate}}"\n\t\tng-click="dropdownToggleState = !dropdownToggleState && enable;">\n\t\t\t<span ng-show="!noRange">{{ timeSettings.toHour + \':\' + timeSettings.toMinute + \' - \' +timeSettings.fromHour + \':\' + timeSettings.fromMinute }}</span>\n\t\t\t<span ng-show="noRange">{{ timeSettings.fromHour + \':\' + timeSettings.fromMinute }}</span>\n\t\t<i class="angular-time-picker-caret" ng-class="theme"></i>\n\t</span>\n\t<div ng-show="dropdownToggleState" class="angular-time-picker-dropdown__menu  angular-time-picker-theme" ng-class="theme">\n\t\t<div>\n\t\t\t{{startTitle | translate}}:\n\t\t\t<span class="angular-time-picker-float--right">\n\t\t\t\t\x3c!-- `browser-default` class is being used as materializecss framework override default select css--\x3e\n\t\t\t\t\x3c!-- Thus to prevent this, adding a class. Materializecss is a famous framework for Material Design. --\x3e\n\t\t\t\t<select ng-model="startingMinute" class="browser-default">\n\t\t\t\t\t<option ng-repeat="option in startingTimeHMinutesRange" ng-disabled="option.disabled" value="{{option.value}}">{{option.name}}</option>\n\t\t\t\t</select>\n\t\t\t\t:\n\t\t\t\t<select ng-model="startingHour" class="browser-default">\n\t\t\t\t\t<option ng-repeat="option in startingTimeHoursRange" ng-disabled="option.disabled" value="{{option.value}}">{{option.name}}</option>\n\t\t\t\t</select>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="angular-time-picker-push--top" ng-show="!noRange">\n\t\t\t{{endTitle | translate}}:\n\t\t\t<span class="angular-time-picker-float--right">\n\t\t\t\t<select ng-model="endingMinute" class="browser-default">\n\t\t\t\t\t<option ng-repeat="option in endingTimeHMinutesRange" ng-disabled="option.disabled" value="{{option.value}}">{{option.name}}</option>\n\t\t\t\t</select>\n\t\t\t\t:\n\t\t\t\t<select ng-model="endingHour" class="browser-default">\n\t\t\t\t\t<option ng-repeat="option in endingTimeHoursRange" ng-disabled="option.disabled" value="{{option.value}}">{{option.name}}</option>\n\t\t\t\t</select>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="angular-time-picker-push--top">\n\t\t\t<button class="btn btn-primary angular-time-picker-push-half--left  angular-time-picker-float--right" ng-click="resetToOriginalTimeSettings()">{{"common.reset" | translate}}</button>\n\t\t\t<button class="btn btn-primary angular-time-picker-push-half--left  angular-time-picker-float--right  angular-time-picker-cancel-btn" ng-click="closeTimeFilterDropdown()">{{"common.cancel" | translate}}</button>\n\t\t\t<button class="btn btn-primary  angular-time-picker-apply-btn" ng-click="applyTimeRangeFilter()">{{"common.apply" | translate}}</button>\n\t\t</div>\n\t</div>\n</div>\n')}]),angular.module("emixApp.directives").directive("wyTimePicker",["$timeout","$translate",function(e,t){return{restrict:"EA",replace:!0,templateUrl:"/angular-time-picker.tpl.html",scope:{timeSettings:"=",dropdownToggleState:"=?",format:"=?",theme:"=?",noRange:"=",noValidation:"=",applyCallback:"&",clearCallback:"&",enable:"=?",elementTitle:"=?",startTitle:"=?",endTitle:"=?"},link:function(t,n){var a,r=[],o=[];for(t.startingTimeHoursRange=[],t.endingTimeHoursRange=[],t.startingTimeHMinutesRange=[],t.endingTimeHMinutesRange=[],t.timeSettings=t.timeSettings||{},angular.isUndefined(t.enable)&&(t.enable=!0),t.theme=(t.theme?"angular-time-picker-"+t.theme:"angular-time-picker-light")+(t.enable?"":" disablebutton"),t.elementTitle=t.elementTitle||"shop.workHoursStartEnd",t.startTitle=t.startTitle||"shop.workHoursStart",t.endTitle=t.endTitle||"shop.workHoursEnd",t.timeHourFormat=t.format&&12===parseInt(t.format,10)?12:24,a=0;a<t.timeHourFormat;a++)r.push({name:a<10?"0"+a:a+"",value:a<10?"0"+a:a+""});for(a=0;a<60;a+=15)o.push({name:a<10?"0"+a:a+"",value:a<10?"0"+a:a+""});angular.copy(r,t.startingTimeHoursRange),angular.copy(o,t.startingTimeHMinutesRange),angular.copy(r,t.endingTimeHoursRange),angular.copy(o,t.endingTimeHMinutesRange),!t.noValidation&&t.timeSettings.toHour<t.timeSettings.fromHour&&(t.timeSettings.toHour=t.timeSettings.fromHour),t.updateTimeRangeFilter=function(){t.timeSettings.fromHour=t.startingHour,t.timeSettings.fromMinute=t.startingMinute,t.noRange||(t.timeSettings.toHour=t.endingHour,t.timeSettings.toMinute=t.endingMinute)},t.setInitialTimeRange=function(){angular.isUndefined(t.timeSettings.fromHour)&&(t.timeSettings.fromHour=t.startingTimeHoursRange[0].value),t.initStartingHour=t.startingHour=t.timeSettings.fromHour,angular.isUndefined(t.timeSettings.fromMinute)&&(t.timeSettings.fromMinute=t.endingTimeHMinutesRange[0].value),t.initStartingMinute=t.startingMinute=t.timeSettings.fromMinute,!t.noRange&&angular.isUndefined(t.timeSettings.toHour)&&(t.timeSettings.toHour=t.startingTimeHoursRange[t.timeHourFormat-1].value),t.initEndingHourHour=t.endingHour=t.timeSettings.toHour,!t.noRange&&angular.isUndefined(t.timeSettings.toMinute)&&(t.timeSettings.toMinute=t.endingTimeHMinutesRange[59].value),t.initEndingMinute=t.endingMinute=t.timeSettings.toMinute},t.resetToOriginalTimeSettings=function(){t.startingHour=t.initStartingHour,t.startingMinute=t.initStartingMinute,t.noRange||(t.endingHour=t.initEndingHourHour,t.endingMinute=t.initEndingMinute),t.applyTimeRangeFilter()},t.clearTimeRange=function(){t.clearCallback(),t.closeTimeFilterDropdown()},t.applyTimeRangeFilter=function(){t.updateTimeRangeFilter(),t.applyCallback(),t.closeTimeFilterDropdown()},t.closeTimeFilterDropdown=function(){t.dropdownToggleState=!1,t.startingHour=t.timeSettings.fromHour,t.startingMinute=t.timeSettings.fromMinute,t.noRange||(t.endingHour=t.timeSettings.toHour,t.endingMinute=t.timeSettings.toMinute)},t.validateHours=function(){if(t.startingHour!==t.endingHour)for(var e=0;e<o.length;e++)t.startingTimeHMinutesRange[e].disabled=!1,t.endingTimeHMinutesRange[e].disabled=!1;else t.startingMinute>=t.endingMinute?"00"!==t.endingMinute?(t.startingMinute=t.endingMinute-1,t.startingMinute=t.startingMinute<10?"0"+t.startingMinute:t.startingMinute+"",t.validateStartingMinuteTime()):"00"===t.endingMinute&&(t.endingMinute="01"):t.startingHour===t.endingHour&&(t.validateStartingMinuteTime(),t.validateEndingMinuteTime());t.areInitialSettingsValidated&&t.applyTimeRangeFilter()},t.validateStartingMinuteTime=function(){for(var e=0;e<o.length;e++)e>parseInt(t.endingMinute,10)-1&&e<o.length?t.startingTimeHMinutesRange[e].disabled=!0:t.startingTimeHMinutesRange[e].disabled=!1},t.validateEndingMinuteTime=function(){for(var e=0;e<o.length;e++)e>=0&&e<parseInt(t.startingMinute,10)+1?t.endingTimeHMinutesRange[e].disabled=!0:t.endingTimeHMinutesRange[e].disabled=!1},t.noRange||t.noValidation||(t.$watch("startingHour",function(e,n){if(e&&e!==n){for(var a=0;a<r.length;a++)a>=0&&a<parseInt(t.startingHour,10)?t.endingTimeHoursRange[a].disabled=!0:t.endingTimeHoursRange[a].disabled=!1;t.validateHours(t.startingHour,t.endingTimeHoursRange)}}),t.$watch("startingMinute",function(e,n){e&&e!==n&&t.startingHour===t.endingHour&&t.validateEndingMinuteTime()}),t.$watch("endingHour",function(e,n){if(e&&e!==n){for(var a=0;a<r.length;a++)a>parseInt(t.endingHour,10)&&a<r.length?t.startingTimeHoursRange[a].disabled=!0:t.startingTimeHoursRange[a].disabled=!1;t.validateHours(t.endingHour,t.startingTimeHoursRange)}}),t.$watch("endingMinute",function(e,n){e&&e!==n&&t.startingHour===t.endingHour&&(t.validateStartingMinuteTime(),t.areInitialSettingsValidated||(t.areInitialSettingsValidated=!0))})),e(function(){t.setInitialTimeRange()},0),n.bind("click",function(e){null!==e&&"function"==typeof e.stopPropagation&&e.stopPropagation()});var i=function(){!0===t.dropdownToggleState&&t.applyTimeRangeFilter(),t.closeTimeFilterDropdown(),t.$digest()};angular.element(document).bind("click",i),t.$on("$destroy",function(){return angular.element(document).unbind("click",i)})}}}]),angular.module("emixApp.directives").directive("ngConfirmClick",function(){return{restrict:"A",link:function(e,t,n){t.bind("click",function(){var t=n.ngConfirmMessage?n.ngConfirmMessage:"آیا از انجام عملیات اطمینان دارید؟";t&&confirm(t)&&e.$apply(n.ngConfirmClick)})}}}),angular.module("emixApp.directives").directive("checklistModel",["$parse","$compile",function(e,t){function n(e,t,n){if(angular.isArray(e))for(var a=e.length;a--;)if(n(e[a],t))return!0;return!1}function a(e,t,a){return n(e=angular.isArray(e)?e:[],t,a)||e.push(t),e}function r(e,t,n){if(angular.isArray(e))for(var a=e.length;a--;)if(n(e[a],t)){e.splice(a,1);break}return e}function o(o,i,l){var s=l.checklistModel;l.$set("checklistModel",null),t(i)(o),l.$set("checklistModel",s);var u=e(s),c=e(l.checklistChange),d=e(l.checklistBeforeChange),p=e(l.ngModel),f=function(e,t){return isNaN(e)||isNaN(t)?angular.equals(e,t):String(e)===String(t)};if(l.hasOwnProperty("checklistComparator"))if("."==l.checklistComparator[0]){var g=l.checklistComparator.substring(1);f=function(e,t){return e[g]===t[g]}}else f=e(l.checklistComparator)(o.$parent);var m=o.$watch(l.ngModel,function(e,t){e!==t&&(d&&!1===d(o)?p.assign(o,n(u(o.$parent),y(),f)):(b(y(),e),c&&c(o)))}),v=o.$watch(y,function(e,t){if(e!=t&&angular.isDefined(t)&&!0===o[l.ngModel]){var n=u(o.$parent);u.assign(o.$parent,r(n,t,f)),u.assign(o.$parent,a(n,e,f))}},!0),h=o.$on("$destroy",function(){m(),v(),h()});function y(){return l.checklistValue?e(l.checklistValue)(o.$parent):l.value}function b(e,t){var n=u(o.$parent);angular.isFunction(u.assign)&&(!0===t?u.assign(o.$parent,a(n,e,f)):u.assign(o.$parent,r(n,e,f)))}function L(e,t){d&&!1===d(o)?b(y(),p(o)):p.assign(o,n(e,y(),f))}angular.isFunction(o.$parent.$watchCollection)?o.$parent.$watchCollection(s,L):o.$parent.$watch(s,L,!0)}return{restrict:"A",priority:1e3,terminal:!0,scope:!0,compile:function(e,t){if(!t.checklistValue&&!t.value)throw"You should provide `value` or `checklist-value`.";return t.ngModel||t.$set("ngModel","checked"),o}}}]),function(e){if("object"==typeof exports)module.exports=e("undefined"!=typeof angular?angular:require("angular"),"undefined"!=typeof Chart?Chart:require("chart.js"));else if("function"==typeof define&&define.amd)define(["angular","chart"],e);else{if("undefined"==typeof angular)throw new Error("AngularJS framework needs to be included, see https://angularjs.org/");if("undefined"==typeof Chart)throw new Error("Chart.js library needs to be included, see http://jtblin.github.io/angular-chart.js/");e(angular,Chart)}}(function(e,t){t.defaults.elements.line.borderWidth=2,t.defaults.plugins.legend.display=!1,t.defaults.colors=["#97BBCD","#DCDCDC","#F7464A","#46BFBD","#FDB45C","#949FB1","#4D5360"];var n="object"==typeof window.G_vmlCanvasManager&&null!==window.G_vmlCanvasManager&&"function"==typeof window.G_vmlCanvasManager.initElement;return n&&(t.defaults.animation=!1),e.module("emixApp.directives").provider("ChartJs",function(){var n={responsive:!0},a={Chart:t,getOptions:function(t){var a=t&&n[t]||{};return e.extend({},n,a)}};this.setOptions=function(t,r){r?n[t]=e.merge(n[t]||{},r):(r=t,n=e.merge(n,r)),e.merge(a.Chart.defaults,n)},this.$get=function(){return a}}).factory("ChartJsFactory",["ChartJs","$timeout",function(a,r){return function(t){return{restrict:"CA",scope:{chartGetColor:"=?",chartType:"=",chartData:"=?",chartLabels:"=?",chartOptions:"=?",chartSeries:"=?",chartColors:"=?",chartClick:"=?",chartHover:"=?",chartDatasetOverride:"=?"},link:function(a,r){function l(n,i){if(!f(n)&&!e.equals(n,i)){var l=t||a.chartType;l&&o(l,a,r)}}n&&window.G_vmlCanvasManager.initElement(r[0]),a.$watch("chartData",function(e,n){if(!e||!e.length||Array.isArray(e[0])&&!e[0].length)return void g(a);var l=t||a.chartType;if(!l)return;if(a.chart&&function(e,t){if(e&&t&&e.length&&t.length)return Array.isArray(e[0])?e.length===t.length&&e.every(function(e,n){return e.length===t[n].length}):t.reduce(i,0)>0&&e.length===t.length;return!1}(e,n))return function(e,t){Array.isArray(t.chartData[0])?t.chart.data.datasets.forEach(function(t,n){t.data=e[n]}):t.chart.data.datasets[0].data=e;t.chart.update(),t.$emit("chart-update",t.chart)}(e,a);o(l,a,r)},!0),a.$watch("chartSeries",l,!0),a.$watch("chartLabels",l,!0),a.$watch("chartOptions",l,!0),a.$watch("chartColors",l,!0),a.$watch("chartDatasetOverride",l,!0),a.$watch("chartType",function(t,n){if(f(t))return;if(e.equals(t,n))return;o(t,a,r)},!1),a.$on("$destroy",function(){g(a)}),a.$on("$resize",function(){a.chart&&a.chart.resize()})}}};function o(n,i,c){var d=function(t,n){return e.extend({},a.getOptions(t),n.chartOptions)}(n,i);if(function(e){return e.chartData&&e.chartData.length}(i)&&function(e,t,n,a){if(a.responsive&&0===n[0].clientHeight)return r(function(){o(e,t,n)},50,!1),!1;return!0}(n,i,c,d)){var p=c[0],f=p.getContext("2d");i.chartGetColor=function(e){return"function"==typeof e.chartGetColor?e.chartGetColor:u}(i);var m=function(n,r){var o=function(n,r){var o=e.copy(r.chartColors||a.getOptions(n).chartColors||t.defaults.colors),i=o.length<r.chartData.length;for(;o.length<r.chartData.length;)o.push(r.chartGetColor());i&&(r.chartColors=o);return o.map(s)}(n,r);return Array.isArray(r.chartData[0])?function(t,n,a,r,o){return{labels:t,datasets:n.map(function(t,n){var i=e.extend({},r[n],{label:a[n],data:t});return o&&o.length>=n&&e.merge(i,o[n]),i})}}(r.chartLabels,r.chartData,r.chartSeries||[],o,r.chartDatasetOverride):function(t,n,a,r){var o={labels:t,datasets:[{data:n,backgroundColor:a.map(function(e){return e.pointBackgroundColor}),hoverBackgroundColor:a.map(function(e){return e.backgroundColor})}]};r&&e.merge(o.datasets[0],r);return o}(r.chartLabels,r.chartData,o,r.chartDatasetOverride)}(n,i);g(i),i.chart=new a.Chart(f,{type:n,data:m,options:d}),i.$emit("chart-create",i.chart),function(t,n){t.onclick=n.chartClick?l(n,"chartClick",!1):e.noop,t.onmousemove=n.chartHover?l(n,"chartHover",!0):e.noop}(p,i)}}function i(e,t){return e+t}function l(t,n,a){var r={point:void 0,points:void 0};return function(o){var i=t.chart.getElementAtEvent||t.chart.getPointAtEvent,l=t.chart.getElementsAtEvent||t.chart.getPointsAtEvent;if(l){var s=l.call(t.chart,o),u=i?i.call(t.chart,o)[0]:void 0;!1!==a&&(e.equals(r.points,s)||e.equals(r.point,u))||(r.point=u,r.points=s,t[n](s,o,u))}}}function s(e){return"string"==typeof e&&"r"===e[0]?c(function(e){var t=e.match(/^rgba?\(([\d,.]+)\)$/);if(!t)throw new Error("Cannot parse rgb value");return(e=t[1].split(",")).map(Number)}(e)):"string"==typeof e&&"#"===e[0]?c((t=e.substr(1),[(n=parseInt(t,16))>>16&255,n>>8&255,255&n])):"object"==typeof e&&null!==e?e:u();var t,n}function u(){var e=[d(0,255),d(0,255),d(0,255)];return c(e)}function c(e){var t=e[3]||1;return{backgroundColor:p(e=e.slice(0,3),.2),pointBackgroundColor:p(e,t),pointHoverBackgroundColor:p(e,.8),borderColor:p(e,t),pointBorderColor:"#fff",pointHoverBorderColor:p(e,t)}}function d(e,t){return Math.floor(Math.random()*(t-e+1))+e}function p(e,t){return n?"rgb("+e.join(",")+")":"rgba("+e.concat(t).join(",")+")"}function f(e){return!e||Array.isArray(e)&&!e.length||"object"==typeof e&&!Object.keys(e).length}function g(e){e.chart&&(e.chart.destroy(),e.$emit("chart-destroy",e.chart))}}]).directive("chartBase",["ChartJsFactory",function(e){return new e}]).directive("chartLine",["ChartJsFactory",function(e){return new e("line")}]).directive("chartBar",["ChartJsFactory",function(e){return new e("bar")}]).directive("chartHorizontalBar",["ChartJsFactory",function(e){return new e("horizontalBar")}]).directive("chartRadar",["ChartJsFactory",function(e){return new e("radar")}]).directive("chartDoughnut",["ChartJsFactory",function(e){return new e("doughnut")}]).directive("chartPie",["ChartJsFactory",function(e){return new e("pie")}]).directive("chartPolarArea",["ChartJsFactory",function(e){return new e("polarArea")}]).directive("chartBubble",["ChartJsFactory",function(e){return new e("bubble")}]).name}),angular.module("emixApp.directives").directive("myPattern",function(){return{require:"ngModel",link:function(e,t,n,a){var r=function(e){if(!e)return a.$setValidity("pattern",!0),e;var t=new RegExp(n.myPattern);return t&&a.$setValidity("pattern",t.test(e)),e};a.$formatters.push(r),a.$parsers.push(r)}}}),angular.module("ui.mask",[]).value("uiMaskConfig",{maskDefinitions:{9:/\d/,A:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/},clearOnBlur:!0,clearOnBlurPlaceholder:!1,escChar:"\\",eventsToHandle:["input","keyup","click","focus"],addDefaultPlaceholder:!0,allowInvalidValue:!1}).provider("uiMask.Config",function(){var e={};this.maskDefinitions=function(t){return e.maskDefinitions=t},this.clearOnBlur=function(t){return e.clearOnBlur=t},this.clearOnBlurPlaceholder=function(t){return e.clearOnBlurPlaceholder=t},this.eventsToHandle=function(t){return e.eventsToHandle=t},this.addDefaultPlaceholder=function(t){return e.addDefaultPlaceholder=t},this.allowInvalidValue=function(t){return e.allowInvalidValue=t},this.$get=["uiMaskConfig",function(t){var n=t;for(var a in e)angular.isObject(e[a])&&!angular.isArray(e[a])?angular.extend(n[a],e[a]):n[a]=e[a];return n}]}).directive("uiMask",["uiMask.Config",function(e){function t(e){return e===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(e.type||e.href||~e.tabIndex)}return{priority:100,require:"ngModel",restrict:"A",compile:function(){var n=angular.copy(e);return function(e,a,r,o){var i,l,s,u,c,d,p,f,g,m,v,h,y=!1,b=!1,L=r.placeholder,w=r.maxlength,D=o.$isEmpty;function k(e){return angular.isDefined(e)?(function(e){var t=0;if(i=[],l=[],s="",angular.isString(e)){c=0;var n=!1,a=0,o=e.split(""),d=!1;angular.forEach(o,function(e,o){d?(d=!1,s+=e,t++):C.escChar===e?d=!0:C.maskDefinitions[e]?(i.push(t),s+=function(e){var t,n=angular.isDefined(r.uiMaskPlaceholder)?r.uiMaskPlaceholder:r.placeholder;return angular.isDefined(n)&&n[e]?n[e]:"space"===(t=angular.isDefined(r.uiMaskPlaceholderChar)&&r.uiMaskPlaceholderChar?r.uiMaskPlaceholderChar:"_").toLowerCase()?" ":t[0]}(o-a),l.push(C.maskDefinitions[e]),t++,n||c++,n=!1):"?"===e?(n=!0,a++):(s+=e,t++)})}i.push(i.slice().pop()+1),u=function(){var e,t=s.split("");i&&!isNaN(i[0])&&angular.forEach(i,function(e){t[e]="_"});var n=0;return(e=t.join("")).replace(/[_]+/g,"_").split("_").filter(function(e){return""!==e}).map(function(t){var a=e.indexOf(t,n);return n=a+1,{value:t,position:a}})}(),y=i.length>1}(e),y?(function(){d=g=A(o.$modelValue||""),f=P(d),p=T(d),r.maxlength&&a.attr("maxlength",2*i[i.length-1]),!L&&C.addDefaultPlaceholder&&a.attr("placeholder",s);for(var e=o.$modelValue,t=o.$formatters.length;t--;)e=o.$formatters[t](e);o.$viewValue=e||"",o.$render()}(),b||(a.bind("blur",O),a.bind("mousedown mouseup",E),a.bind("keydown",F),a.bind(C.eventsToHandle.join(" "),I),b=!0),!0):M()):M()}function x(e){e&&(s=e,!y||0===a.val().length&&angular.isDefined(r.placeholder)||a.val(P(A(a.val()))))}o.$isEmpty=function(e){return D(y?A(e||""):e)};var S=!1;function $(e){return y?(d=A(e||""),p=T(d),o.$setValidity("mask",p),d.length&&(p||C.allowInvalidValue)?P(d):void 0):e}r.$observe("modelViewValue",function(e){"true"===e&&(S=!0)}),r.$observe("allowInvalidValue",function(e){C.allowInvalidValue=""===e||!!e,$(o.$modelValue)});var C={};function M(){return y=!1,b&&(a.unbind("blur",O),a.unbind("mousedown",E),a.unbind("mouseup",E),a.unbind("keydown",F),a.unbind("input",I),a.unbind("keyup",I),a.unbind("click",I),a.unbind("focus",I),b=!1),angular.isDefined(L)?a.attr("placeholder",L):a.removeAttr("placeholder"),angular.isDefined(w)?a.attr("maxlength",w):a.removeAttr("maxlength"),a.val(o.$modelValue),o.$viewValue=o.$modelValue,!1}function T(e){return!e.length||e.length>=c}function A(e){var t,n,r="",o=a[0],i=l.slice(),c=m,d=c+R(o),p="";return e=e.toString(),t=0,n=e.length-s.length,angular.forEach(u,function(a){var r=a.position;r>=c&&r<d||(r>=c&&(r+=n),e.substring(r,r+a.value.length)===a.value&&(p+=e.slice(t,r),t=r+a.value.length))}),e=p+e.slice(t),angular.forEach(e.split(""),function(e){i.length&&i[0].test(e)&&(r+=e,i.shift())}),r}function P(e){var t="",n=i.slice();return angular.forEach(s.split(""),function(a,r){e.length&&r===n[0]?(t+=e.charAt(0)||"_",e=e.substr(1),n.shift()):t+=a}),t}r.uiOptions?(C=e.$eval("["+r.uiOptions+"]"),C=angular.isObject(C[0])?function(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(void 0===t[n]?t[n]=angular.copy(e[n]):angular.isObject(t[n])&&!angular.isArray(t[n])&&(t[n]=angular.extend({},e[n],t[n])));return t}(n,C[0]):n):C=n,r.$observe("uiMask",k),angular.isDefined(r.uiMaskPlaceholder)?r.$observe("uiMaskPlaceholder",x):r.$observe("placeholder",x),angular.isDefined(r.uiMaskPlaceholderChar)&&r.$observe("uiMaskPlaceholderChar",function(){return k(r.uiMask)}),o.$formatters.unshift($),o.$parsers.unshift(function(e){return y?(d=A(e||""),p=T(d),o.$viewValue=d.length?P(d):"",o.$setValidity("mask",p),p||C.allowInvalidValue?S?o.$viewValue:d:void 0):e});var H=a.val();function O(){if((C.clearOnBlur||C.clearOnBlurPlaceholder&&0===d.length&&r.placeholder)&&(m=0,v=0,p&&0!==d.length||(a.val(""),e.$apply(function(){o.$pristine||o.$setViewValue("")}))),d!==H){var t=a.val(),n=""===d&&t&&angular.isDefined(r.uiMaskPlaceholderChar)&&"space"===r.uiMaskPlaceholderChar;n&&a.val(""),function(e){var t;if(angular.isFunction(window.Event)&&!e.fireEvent)try{t=new Event("change",{view:window,bubbles:!0,cancelable:!1})}catch(e){(t=document.createEvent("HTMLEvents")).initEvent("change",!1,!0)}finally{e.dispatchEvent(t)}else"createEvent"in document?((t=document.createEvent("HTMLEvents")).initEvent("change",!1,!0),e.dispatchEvent(t)):e.fireEvent&&e.fireEvent("onchange")}(a[0]),n&&a.val(t)}H=d}function E(e){"mousedown"===e.type?a.bind("mouseout",V):a.unbind("mouseout",V)}function V(){v=R(this),a.unbind("mouseout",V)}function F(e){var t=8===e.which,n=B(this)-1||0,r=90===e.which&&e.ctrlKey;if(t){for(;n>=0;){if(N(n)){j(this,n+1);break}n--}h=-1===n}r&&(a.val(""),e.preventDefault())}function I(t){var n=(t=t||{}).which,r=t.type;if(16!==n&&91!==n){var l,u=a.val(),c=f,d=!1,p=A(u),y=g,b=B(this)||0,L=m||0,w=b-L,D=i[0],k=i[p.length]||i.slice().shift(),x=v||0,S=R(this)>0,$=x>0,C=u.length>c.length||x&&u.length>c.length-x,M=u.length<c.length||x&&u.length===c.length-x,T=n>=37&&n<=40&&t.shiftKey,H=8===n||"keyup"!==r&&M&&-1===w,O=46===n||"keyup"!==r&&M&&0===w&&!$,E=(37===n||H||"click"===r)&&b>D;if(v=R(this),!T&&(!S||"click"!==r&&"keyup"!==r&&"focus"!==r)){if(H&&h)return a.val(s),e.$apply(function(){o.$setViewValue("")}),void j(this,L);if("input"===r&&M&&!$&&p===y){for(;H&&b>D&&!N(b);)b--;for(;O&&b<k&&-1===i.indexOf(b);)b++;var V=i.indexOf(b);(p=p.substring(0,V)+p.substring(V+1))!==y&&(d=!0)}for(l=P(p),f=l,g=p,!d&&u.length>l.length&&(d=!0),a.val(l),d&&e.$apply(function(){o.$setViewValue(l)}),C&&b<=D&&(b=D+1),E&&b--,b=b>k?k:b<D?D:b;!N(b)&&b>D&&b<k;)b+=E?-1:1;(E&&b<k||C&&!N(L))&&b++,m=b,j(this,b)}}}function N(e){return i.indexOf(e)>-1}function B(e){if(!e)return 0;if(void 0!==e.selectionStart)return e.selectionStart;if(document.selection&&t(a[0])){e.focus();var n=document.selection.createRange();return n.moveStart("character",e.value?-e.value.length:0),n.text.length}return 0}function j(e,n){if(!e)return 0;if(0!==e.offsetWidth&&0!==e.offsetHeight)if(e.setSelectionRange)t(a[0])&&(e.focus(),e.setSelectionRange(n,n));else if(e.createTextRange){var r=e.createTextRange();r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",n),r.select()}}function R(e){return e?void 0!==e.selectionStart?e.selectionEnd-e.selectionStart:window.getSelection?window.getSelection().toString().length:document.selection?document.selection.createRange().text.length:0:0}a.bind("mousedown mouseup",E),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(null===this)throw new TypeError;var t=Object(this),n=t.length>>>0;if(0===n)return-1;var a=0;if(arguments.length>1&&((a=Number(arguments[1]))!=a?a=0:0!==a&&a!==1/0&&a!==-1/0&&(a=(a>0||-1)*Math.floor(Math.abs(a)))),a>=n)return-1;for(var r=a>=0?a:Math.max(n-Math.abs(a),0);r<n;r++)if(r in t&&t[r]===e)return r;return-1})}}}}]),angular.module("emixApp.directives").directive("numbersOnly",function(){var e=function(e){return e.replace(/[\u0660-\u0669\u06f0-\u06f9]/g,function(e){return 15&e.charCodeAt(0)})};return{require:"ngModel",link:function(t,n,a,r){r.$parsers.push(function(t){if(t){var n=(t=e(t)).replace(/[^0-9]/g,"");return n!==t&&(r.$setViewValue(n),r.$render()),n}return""})}}}),angular.module("emixApp.directives").directive("englishNumbers",function(){var e=function(e){return e.replace(/[\u0660-\u0669\u06f0-\u06f9]/g,function(e){return 15&e.charCodeAt(0)})};return{require:"ngModel",link:function(t,n,a,r){r.$parsers.push(function(t){return t?t=e(t):""})}}}),angular.module("emixApp.directives").directive("txDataType",function(){return{restrict:"EA",require:"ngModel",link:function(e,t,n,a){function r(e,t,n){return/^([0-5]?[0-9])$/.test(n)||(e=[t,":"].join("")),e}"integer"===n.txDataType?a.$parsers.push(function(e){if(e){var t=e.replace(/[^0-9]/g,"");return t!==e&&(a.$setViewValue(t),a.$render()),n.txMaxValue&&parseInt(t,10)>parseInt(n.txMaxValue,10)&&(t=t.substring(0,t.length-1),a.$setViewValue(t),a.$render()),t}return}):"decimal"===n.txDataType?a.$parsers.push(function(e){n.txDecimalPoint||(n.txDecimalPoint=2);if(e){var t=e.replace(/[^0-9.]/g,""),r=t.match(/^[^.]*\.|[^.]+/g),o=(t=r?r.join(""):t).split(".");if(o[1]){var i=o[1].slice(0,n.txDecimalPoint);t=[o[0],i].join(".")}return t!==e&&(a.$setViewValue(t),a.$render()),n.txMaxValue&&parseFloat(t,10)>parseFloat(n.txMaxValue,10)&&(t=(t=t.substring(0,t.length-1)).replace(/[^0-9]/g,""),a.$setViewValue(t),a.$render()),n.txMaxValue&&parseFloat(t,10)===parseFloat(n.txMaxValue,10)&&(t=t.replace(/[^0-9]/g,""),a.$setViewValue(t),a.$render()),n.txMaxLength&&t.length>n.txMaxLength&&(t=t.substr(0,n.txMaxLength),a.$setViewValue(t),a.$render()),t}return}):"time"===n.txDataType?a.$parsers.push(function(e){if(e){var t=e.replace(/[^0-9:]/g,""),n=t.match(/^[^:]*\:|[^:]+/g),o=(t=n?n.join(""):t).split(":");if(o[0]){var i=/^([0-1]?[0-9]|2[0-3])?$/.test(o[0]);i||(t=""),o[1]&&(o[1].length>2&&(o[1]=o[1].slice(0,2),t=[o[0],":",o[1]].join("")),t=r(t,o[0],o[1]),1===o[1].length&&o[1]>5&&(o[1]=[o[1],"0"].join(""),t=r(t,o[0],o[1])))}else t="00:";return t!==e&&(a.$setViewValue(t),a.$render()),t}return}):(n.txDataType,n.txMaxLength&&a.$parsers.push(function(e){return e.length>n.txMaxLength&&(e=e.substr(0,n.txMaxLength),a.$setViewValue(e),a.$render()),e})),t.bind("blur",function(){if("time"===n.txDataType){var e=a.$viewValue;if(e){var t=e.split(":");!t[1]&&t[0]?(e+=":00",a.$setViewValue(e),a.$render()):t[0]&&t[1]&&1===t[1].length&&(e+="0",a.$setViewValue(e),a.$render())}}})}}}),angular.module("emixApp.directives").directive("limitToMax",function(){return{link:function(e,t,n){t.on("keydown keyup",function(e){Number(t.val())>Number(n.max)&&46!=e.keyCode&&8!=e.keyCode?(e.preventDefault(),e.stopPropagation(),t.val(""),toastr.error("مقدار وارد شده صحیح نمی باشد.حداکثر مقدار قابل قبول "+n.max+" می باشد.")):n.min&&t.val().length>0&&Number(t.val())<Number(n.min)&&46!=e.keyCode&&8!=e.keyCode&&(e.preventDefault(),e.stopPropagation(),t.val(""),toastr.error("مقدار وارد شده صحیح نمی باشد.حداقل مقدار قابل قبول "+n.min+" می باشد."))})}}}),angular.module("emixApp.directives").directive("preventTypingGreater",function(){return{link:function(e,t,n){var a=null;t.on("keydown keyup",function(e){Number(t.val())>Number(n.max)&&46!=e.keyCode&&8!=e.keyCode?(e.preventDefault(),e.stopPropagation(),t.val(a)):a=Number(t.val())})}}}),angular.module("emixApp.directives").directive("enterEvent",function(){return function(e,t,n){t.bind("keydown keypress",function(t){13===(t.which||t.keyCode)&&(e.$apply(function(){e.$eval(n.enterEvent)}),t.preventDefault())})}}),function(e,t){"function"==typeof define&&define.amd?define(["angular"],t):t(angular)}(0,function(e){e.module("emixApp.directives").directive("ckeditor",["$parse",function(e){return{restrict:"A",require:["ckeditor","ngModel"],controller:["$scope","$element","$attrs","$parse","$q","$timeout",n],link:function(n,a,r,o){var i=o[0],l=o[1];i.ready().then(function(){["dataReady","change","blur","saveSnapshot"].forEach(function(e){i.onCKEvent(e,function(){l.$setViewValue(i.instance.getData()||"")})});var a="true"===(r.ngDisabled||"").toLowerCase();i.instance.setReadOnly(a),r.$observe("ngDisabled",function(e){var t="true"===(e||"").toLowerCase();i.instance.setReadOnly(t)}),t(function(){e(r.ready)(n)})}),l.$render=function(){i.ready().then(function(){i.instance.setData(l.$viewValue||"",{noSnapshot:!0,callback:function(){i.instance.fire("updateSnapshot")}})})}}}}]);var t=window&&window.setImmediate?window.setImmediate:function(e){setTimeout(e,0)};function n(e,n,a,r,o,i){var l=r(a.ckeditor)(e)||{allowedContent:!0,entities:!1,removePlugins:"iframe,flash,smiley,form",skin:"moono-lisa"};void 0!=a.removePlugins&&(l.removePlugins=a.removePlugins),void 0!=a.skin&&(l.skin=a.skin),void 0!=a.width&&(l.width=a.width),void 0!=a.height&&(l.height=a.height),void 0!=a.resizeEnabled&&(l.resize_enabled="false"!=a.resizeEnabled);var s,u=n[0],c=o.defer();s=u.hasAttribute("contenteditable")&&"true"==u.getAttribute("contenteditable").toLowerCase()?this.instance=CKEDITOR.inline(u,l):this.instance=CKEDITOR.replace(u,l),this.onCKEvent=function(n,a){function r(){var t=arguments;e.$apply(function(){a.apply(null,t)})}return s.on(n,function(){var e=arguments;t(function(){r.apply(null,e)})}),function(){s.removeListener(n,r)}},this.onCKEvent("instanceReady",function(){c.resolve(!0)}),this.ready=function(){return c.promise},e.$on("$destroy",function(){c.promise.then(function(){s.destroy(!1)})})}}),angular.module("emixApp.directives").directive("tabs",function(){return{restrict:"E",transclude:!0,scope:{onSeletedChange:"&seletedChange"},controller:["$scope",function(e){var t=e.panes=[];e.select=function(n){angular.forEach(t,function(e){e.selected=!1}),n.selected=!0,e.onSeletedChange({selectedPane:n})},this.addPane=function(n){0==t.length&&e.select(n),t.push(n)}}],template:'<div class="tabbable nav-tabs-custom"><ul class="nav nav-tabs pull-right"><li ng-repeat="pane in panes" ng-class="{active:pane.selected}"><a href="" ng-click="select(pane)" id="{{pane.id}}">{{pane.title}}</a></li></ul><div class="tab-content" ng-transclude></div></div>',replace:!0}}).directive("pane",function(){return{require:"^tabs",restrict:"E",transclude:!0,scope:{title:"@",id:"@"},link:function(e,t,n,a){a.addPane(e)},template:'<div class="tab-pane" ng-class="{active: selected}" ng-transclude></div>',replace:!0}}),angular.module("emixApp.directives").directive("ngCropper",["$q","$parse",function(e,t){return{restrict:"A",scope:{events:"=ngCropperEvents",options:"=ngCropperOptions",showEvent:"=ngCropperShow",hideEvent:"=ngCropperHide",proxy:"=?ngCropperProxy"},link:function(n,a,r){var o,i=!1;angular.extend(n.events,{changeZoom:function(e){o.zoom(e)},rotate:function(e){o.rotate(e)},scaleX:function(e){o.scaleX(e)},scaleY:function(e){o.scaleY(e)},reset:function(){o.reset()},destroy:function(){o.destroy()},getCroppedCanvas:function(e){return o.getCroppedCanvas(e)},setData:function(e){o.setData(e)}}),n.$on(n.showEvent,function(){i||(i=!0,function(t,n){t=t||{};var a=e.when(t);t.maximize&&(a=function(t,n){return function(t){var n=e.defer(),a=new Image;return a.onload=function(){n.resolve({width:a.width,height:a.height})},a.src=t.src,n.promise}(n).then(function(e){return t.data=e,t})}(t,n));return a}(n.options,a[0]).then(function(e){o=new Cropper(a[0],e),function(){if(!n.proxy)return;t(n.proxy).assign(n.$parent,function(e){o[e]()})}()}))}),n.$on(n.hideEvent,function(){i&&(i=!1,o.destroy())}),n.$watch("options.disabled",function(e){i&&(e&&o.disable(),e||o.enable())}),n.$watch("options.dragMode",function(e){i&&o.setDragMode(e)})}}}]),angular.module("emixApp.services").service("Cropper",["$q",function(e){function t(t){var n=e.defer(),a=new Image;return a.onload=function(e){n.resolve(e.target)},a.src=t,n.promise}function n(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.style.display="none",document.body.appendChild(t),t}function a(e){e.parentElement.removeChild(e)}this.encode=function(t){var n=e.defer(),a=new FileReader;return a.onload=function(e){n.resolve(e.target.result)},a.readAsDataURL(t),n.promise},this.decode=function(e){for(var t=e.split(";")[0].split(":")[1],n=atob(e.split(",")[1]),a=new Uint8Array(n.length),r=0;r<n.length;r++)a[r]=n.charCodeAt(r);return new Blob([a],{type:t})},this.crop=function(e,r){var o=this.decode;return this.encode(e).then(t).then(function(t){var i=n(r);i.getContext("2d").drawImage(t,r.x,r.y,r.width,r.height,0,0,r.width,r.height);var l=i.toDataURL(e.type);return a(i),o(l)})},this.scale=function(e,r){var o=this.decode;return this.encode(e).then(t).then(function(t){var i,l,s,u=t.height,c=t.width;angular.isNumber(r)&&(l=u*(i=r),s=c*i),angular.isObject(r)&&(i=c/u,l=r.height,s=r.width,l&&!s?s=l*i:s&&!l&&(l=s/i));var d=n(r),p=d.getContext("2d");d.height=l,d.width=s,p.drawImage(t,0,0,c,u,0,0,s,l);var f=d.toDataURL(e.type);return a(d),o(f)})}}]),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),angular.module("emixApp.directives").value("customSelectDefaults",{captionText:"",displayText:"",emptyListText:"",emptySearchResultText:"",addText:"",addInputPlaceHodler:"",searchDelay:300}),angular.module("emixApp.directives").directive("stopPropagation",function(){return{restrict:"A",link:function(e,t,n,a){var r=n.stopPropagation;t.bind(r,function(e){e.stopPropagation()})}}}),angular.module("emixApp.directives").directive("customSelect",["$parse","$compile","$timeout","$q","customSelectDefaults","$translate",function(e,t,n,a,r,o){var i=/^\s*(.*?)(?:\s+as\s+(.*?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/;return{restrict:"A",require:"ngModel",link:function(o,l,s,u){var c=s.customSelect;if(!c)throw new Error("Expected custom-select attribute value.");var d=c.match(i);if(!d)throw new Error("Expected expression in form of '_select_ (as _label_)? for _value_ in _collection_[ track by _id_]' but got '"+c+"'.");l.addClass("dropdown custom-select");var p,f=e(d[2]||d[1]),g=d[3],m=e(d[2]?d[1]:g),v=d[4],h=e(v),y=d[5],b=y?" track by "+y:"",L=s.csDependsOn,w=V(),D=-1,k={};o.$on("childScopeSelect",function(e,t){var n=t.data,a=t.options,r=V();(!a||r.captionText==a.captionText)&&O.select(n)});var x=l.html().trim()||"{{"+(d[2]||d[1])+((d[2]||d[1]).indexOf(".")>0?" | translate":"")+"}}",S='<a class="dropdown-toggle" data-toggle="dropdown" href ng-class="{ disabled: disabled }"><span><span class="caption-text">{{displayText.length > 0 && captionText.length > 0 ? (captionText | translate) + " : " : (captionText | translate)}}</span><span class="display-text">{{displayText.length > 0 ? " " + (displayText | translate) : "" }}</span></span><b></b></a><div class="dropdown-menu"><div stop-propagation="click" class="custom-select-search"><input class="'+s.selectClass+' cssrchval" type="text" autocomplete="off" ng-model="searchTerm" /></div><ul role="menu"><li role="presentation" ng-repeat="'+g+" in matches"+b+'"><a role="menuitem" tabindex="-1" href ng-click="select('+g+')">'+x+'</a></li><li ng-hide="matches.length" class="empty-result" stop-propagation="click"><em class="muted"><span ng-hide="searchTerm">{{emptyListText | translate}}</span><span class="word-break" ng-show="searchTerm" translate="customSelect.emptySearchResultText" translate-values="{searchText: \'{{searchTerm}}\'}"></span></em></li></ul><div class="custom-select-action">'+("function"==typeof w.onAdd?'<div class="input-group">\n    <input class="form-control csnewVal" ng-model="newValue" placeholder="{{addInputPlaceHodler | translate : {\'element\' : (captionText | translate)} }}">\n    <span class="input-group-btn">\n      <button type="button" class="btn btn-info add-button csSlctVal" ng-click="add()">{{addText | translate}}</button>\n    </span>\n</div>':"")+"</div></div>";l.empty();var $,C=angular.element(S),M=C.eq(0).dropdown(),T=C.eq(1).find(".cssrchval"),A=C.eq(1).find("ul"),P=C.eq(1).find(".csnewVal"),H=C.eq(1).find(".csSlctVal"),O=o.$new(!0);function E(){var e={};e[g]=u.$modelValue;var t=f(o,e);if(void 0===t){var n=k[B(u.$modelValue)];n&&(t=n.label)}$=!t,O.displayText=t||w.displayText}function V(){return r.displayText="customSelect.displayText",r.emptyListText="customSelect.emptyListText",r.emptySearchResultText="customSelect.emptySearchResultText",r.addText="customSelect.addText",r.addInputPlaceHodler="customSelect.addInputPlaceHodler",angular.extend({},r,o.$eval(s.customSelectOptions))}function F(e){var t={$searchTerm:e};a.when(h(o,t)).then(function(n){if(n){if(e===T.val().trim()){k={},O.matches.length=0;for(var a=0;a<n.length;a++){t[g]=n[a];var r=m(o,t),i=f(o,t);k[B(r)]={value:r,label:i},O.matches.push(n[a])}}$&&E()}},function(){I()})}function I(){O.matches=[],D=-1}O.addText=w.addText,O.addInputPlaceHodler=w.addInputPlaceHodler,O.emptySearchResultText=w.emptySearchResultText,O.emptyListText=w.emptyListText,O.captionText=w.captionText,O.select=function(e){var t={};t[g]=e;var n=m(O,t);O.displayText=f(O,t)||w.displayText,u.$setViewValue(n),M.focus(),"function"==typeof w.onSelect&&w.onSelect(e)},O.newValue="",O.add=function(){a.when(w.onAdd(O.newValue),function(e){if(e){var t={};t[g]=e;var n=m(o,t),a=f(o,t);k[B(n)]={value:n,label:a},O.matches.push(e),O.select(e)}})},O.format=format,E(),M.on("click",function(e){O.disabled||(O.$apply(function(){"",O.searchTerm=""}),D=-1,T.focus(),w.async||F(""))}),L&&o.$watch(L,function(e,t){e!==t&&(O.matches=[],O.select(void 0))}),M.on("keypress",function(e){e.altKey||e.ctrlKey||M.click()}),T.on("keydown",function(e){var t;if(/(13|27|40|^9$)/.test(e.keyCode))switch(e.preventDefault(),e.stopPropagation(),e.keyCode){case 27:M.dropdown("toggle");break;case 13:!function(){var e=A.find("li > a");if(e.length>0){var t=e.eq(0).scope(),n=t[g];O.$apply(function(){O.select(n)}),M.dropdown("toggle")}}();break;case 40:(t=A.find("li > a")).length>0&&(D=0,t.eq(0).focus());break;case 9:M.dropdown("toggle")}}),P.on("keydown",function(e){var t;if(/(13|27|38|^9$)/.test(e.keyCode))switch(e.preventDefault(),e.stopPropagation(),e.keyCode){case 27:M.dropdown("toggle");break;case 13:H.click();break;case 38:(t=A.find("li > a")).length>0&&(D=t.length-1,t.eq(D).focus());break;case 9:M.dropdown("toggle")}}),A.on("keydown",function(e){if(/(38|40)/.test(e.keyCode)){e.preventDefault(),e.stopPropagation();var t=A.find("li > a");t.length&&(38==e.keyCode&&D--,40==e.keyCode&&(D<t.length-1||"function"==typeof w.onAdd)&&D++,D>=0?D<t.length?t.eq(D).focus():"function"==typeof w.onAdd&&(D=t.length,P.focus()):(D=-1,T.focus()))}}),I(),t(C)(O),l.append(C),u.$render=function(){E()},O.$watch(function(){return(w=V()).displayText},E),O.$watch(function(){return l.attr("disabled")},function(e){O.disabled=e}),O.$watch("searchTerm",function(e){p&&n.cancel(p);var t=(e||"").trim();p=n(function(){F(t)},t&&w.searchDelay||0)}),"autofocus"in s&&M.focus();var N=0;function B(e){if(void 0===e)return"undefined";var t,n=typeof e;return"object"==n&&null!==e?"function"==typeof(t=e.$$hashKey)?t=e.$$hashKey():void 0===t&&(t=e.$$hashKey="cs-"+N++):t=e,n+":"+t}}}}]),angular.module("emixApp.directives").directive("moneyBox",["$parse","$rootScope",function(e,t){return{require:"?ngModel",restrict:"A",compile:function(e,n){var a=e.is("input:text");return function(e,n,r,o){e.angularCurrency={aSign:"",mDec:t.shopFractionSize},e.variableOptions=!1;var i=function(e){n.autoNumeric("set",e)};n.autoNumeric("init",e.angularCurrency),!0===e.variableOptions&&e.$watch("angularCurrency",function(e){n.autoNumeric("update",e)}),o&&a?(o.$render=function(){i(o.$viewValue)},n.on("keyup",function(){e.$applyAsync(function(){o.$setViewValue(n.autoNumeric("get"))})}),n.on("change",function(){e.$applyAsync(function(){o.$setViewValue(n.autoNumeric("get"))})})):a&&r.$observe("value",function(e){i(e)})}}}}]);"format cjs";!function(e,t){"function"==typeof define&&define.amd?define(["angular","jquery-minicolors"],t):"object"==typeof exports?(module.exports=t(require("angular"),require("jquery-minicolors")),module.exports="minicolors"):e.angularMinicolors=t(e.angular,e.jqueryMinicolors)}(this,function(e){e.module("minicolors",[]),e.module("minicolors").provider("minicolors",function(){this.defaults={theme:"bootstrap",position:"top left",defaultValue:"",animationSpeed:50,animationEasing:"swing",change:null,changeDelay:0,control:"hue",hide:null,hideSpeed:100,inline:!1,letterCase:"lowercase",opacity:!1,show:null,showSpeed:100},this.$get=function(){return this}}),e.module("minicolors").directive("minicolors",["minicolors","$timeout",function(t,n){return{require:"?ngModel",restrict:"A",priority:1,link:function(a,r,o,i){var l=!1,s=function(){return e.extend({},t.defaults,a.$eval(o.minicolors))};function u(e){return/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(e)}function c(e){u(e)&&null!=r.data("minicolors-settings")&&r.minicolors("value",e)}i.$render=function(){n(function(){c(i.$viewValue)},0,!1)};var d=function(){if(i){var e=s();if(e.change=function(e){a.$apply(function(){u(e)&&i.$setViewValue(e)})},r.hasClass("minicolors-input")&&(r.minicolors("destroy"),r.off("blur",t)),r.minicolors(e),r.on("blur",t),!l)return n(function(){c(i.$viewValue)},0),void(l=!0)}function t(e){a.$apply(function(){var e=r.minicolors("value");u(e)&&i.$setViewValue(e)})}};d();var p=a.$watch(s,d,!0);a.$on("$destroy",function(){r.hasClass("minicolors-input")&&(r.minicolors("destroy"),r.remove()),p&&p()})}}}])}),function(angular){angular.module("leaflet-directive",[]).directive("leaflet",["$q","leafletData","leafletMapDefaults","leafletHelpers","leafletMapEvents",function(e,t,n,a,r){return{restrict:"EA",replace:!0,scope:{center:"=",lfCenter:"=",defaults:"=",maxbounds:"=",bounds:"=",markers:"=",legend:"=",geojson:"=",paths:"=",tiles:"=",layers:"=",controls:"=",decorations:"=",eventBroadcast:"=",markersWatchOptions:"=",geojsonWatchOptions:"="},transclude:!0,template:'<div class="angular-leaflet-map"><div ng-transclude></div></div>',controller:["$scope",function(t){this._leafletMap=e.defer(),this.getMap=function(){return this._leafletMap.promise},this.getLeafletScope=function(){return t}}],link:function(e,o,i,l){var s=a.isDefined,u=n.setDefaults(e.defaults,i.id),c=r.getAvailableMapEvents(),d=r.addEvents;function p(){isNaN(i.width)?o.css("width",i.width):o.css("width",i.width+"px")}function f(){isNaN(i.height)?o.css("height",i.height):o.css("height",i.height+"px")}e.mapId=i.id,t.setDirectiveControls({},i.id),s(i.width)&&(p(),e.$watch(function(){return o[0].getAttribute("width")},function(){p(),g.invalidateSize()})),s(i.height)&&(f(),e.$watch(function(){return o[0].getAttribute("height")},function(){f(),g.invalidateSize()}));var g=new L.Map(o[0],n.getMapCreationDefaults(i.id));if(l._leafletMap.resolve(g),s(i.center)||s(i.lfCenter)||g.setView([u.center.lat,u.center.lng],u.center.zoom),!s(i.tiles)&&!s(i.layers)){var m=L.tileLayer(u.tileLayer,u.tileLayerOptions);m.addTo(g),t.setTiles(m,i.id)}if(s(g.zoomControl)&&s(u.zoomControlPosition)&&g.zoomControl.setPosition(u.zoomControlPosition),s(g.zoomControl)&&!1===u.zoomControl&&g.zoomControl.removeFrom(g),s(g.zoomsliderControl)&&s(u.zoomsliderControl)&&!1===u.zoomsliderControl&&g.zoomsliderControl.removeFrom(g),!s(i.eventBroadcast)){d(g,c,"eventName",e,"broadcast")}g.whenReady(function(){t.setMap(g,i.id)}),e.$on("$destroy",function(){n.reset(),g.remove(),t.unresolveMap(i.id)}),e.$on("invalidateSize",function(){g.invalidateSize()})}}}]),angular.module("leaflet-directive").factory("leafletBoundsHelpers",["$log","leafletHelpers",function(e,t){var n=t.isArray,a=t.isNumber,r=t.isFunction,o=t.isDefined;function i(e){return angular.isDefined(e)&&angular.isDefined(e.southWest)&&angular.isDefined(e.northEast)&&angular.isNumber(e.southWest.lat)&&angular.isNumber(e.southWest.lng)&&angular.isNumber(e.northEast.lat)&&angular.isNumber(e.northEast.lng)}return{createLeafletBounds:function(e){if(i(e))return L.latLngBounds([e.southWest.lat,e.southWest.lng],[e.northEast.lat,e.northEast.lng])},isValidBounds:i,createBoundsFromArray:function(t){if(n(t)&&2===t.length&&n(t[0])&&n(t[1])&&2===t[0].length&&2===t[1].length&&a(t[0][0])&&a(t[0][1])&&a(t[1][0])&&a(t[1][1]))return{northEast:{lat:t[0][0],lng:t[0][1]},southWest:{lat:t[1][0],lng:t[1][1]}};e.error("[AngularJS - Leaflet] The bounds array is not valid.")},createBoundsFromLeaflet:function(t){if(o(t)&&r(t.getNorthEast)&&r(t.getSouthWest)){var n=t.getNorthEast(),a=t.getSouthWest();return{northEast:{lat:n.lat,lng:n.lng},southWest:{lat:a.lat,lng:a.lng}}}e.error("[AngularJS - Leaflet] The leaflet bounds is not valid object.")}}}]),angular.module("leaflet-directive").factory("leafletControlHelpers",["$rootScope","$log","leafletHelpers","leafletLayerHelpers","leafletMapDefaults",function(e,t,n,a,r){var o=n.isDefined,i=n.isObject,l=a.createLayer,s={},u=n.errorHeader+" [Controls] ",c=function(e,t,n){if(!r.getDefaults(n).controls.layers.visible)return!1;var a=!1;return i(e)&&Object.keys(e).forEach(function(t){var n=e[t];o(n.layerOptions)&&!1===n.layerOptions.showOnSelector||(a=!0)}),i(t)&&Object.keys(t).forEach(function(e){var n=t[e];o(n.layerParams)&&!1===n.layerParams.showOnSelector||(a=!0)}),a},d={draw:{isPluginLoaded:function(){return!!angular.isDefined(L.Control.Draw)||(t.error(u+" Draw plugin is not loaded."),!1)},checkValidParams:function(){return!0},createControl:function(e){return new L.Control.Draw(e)}},scale:{isPluginLoaded:function(){return!0},checkValidParams:function(){return!0},createControl:function(e){return new L.control.scale(e)}},fullscreen:{isPluginLoaded:function(){return!!angular.isDefined(L.Control.Fullscreen)||(t.error(u+" Fullscreen plugin is not loaded."),!1)},checkValidParams:function(){return!0},createControl:function(e){return new L.Control.Fullscreen(e)}},search:{isPluginLoaded:function(){return!!angular.isDefined(L.Control.Search)||(t.error(u+" Search plugin is not loaded."),!1)},checkValidParams:function(){return!0},createControl:function(e){return new L.Control.Search(e)}},custom:{},minimap:{isPluginLoaded:function(){return!!angular.isDefined(L.Control.MiniMap)||(t.error(u+" Minimap plugin is not loaded."),!1)},checkValidParams:function(e){return!!o(e.layer)||(t.warn(u+' minimap "layer" option should be defined.'),!1)},createControl:function(e){var n=l(e.layer);if(o(n))return new L.Control.MiniMap(n,e);t.warn(u+' minimap control "layer" could not be created.')}}};return{layersControlMustBeVisible:c,isValidControlType:function(e){return-1!==Object.keys(d).indexOf(e)},createControl:function(e,t){if(d[e].checkValidParams(t))return d[e].createControl(t)},updateLayersControl:function(e,t,n,a,i,l){var u,d=s[t],p=c(a,i,t);if(o(d)&&n){for(u in l.baselayers)d.removeLayer(l.baselayers[u]);for(u in l.overlays)d.removeLayer(l.overlays[u]);e.removeControl(d),delete s[t]}if(p){for(u in d=function(e){var t=r.getDefaults(e),n={collapsed:t.controls.layers.collapsed,position:t.controls.layers.position,autoZIndex:!1};return angular.extend(n,t.controls.layers.options),t.controls.layers&&o(t.controls.layers.control)?t.controls.layers.control.apply(this,[[],[],n]):new L.control.layers([],[],n)}(t),s[t]=d,a){!(o(a[u].layerOptions)&&!1===a[u].layerOptions.showOnSelector)&&o(l.baselayers[u])&&d.addBaseLayer(l.baselayers[u],a[u].name)}for(u in i){!(o(i[u].layerParams)&&!1===i[u].layerParams.showOnSelector)&&o(l.overlays[u])&&d.addOverlay(l.overlays[u],i[u].name)}e.addControl(d)}return p}}}]),angular.module("leaflet-directive").service("leafletData",["$log","$q","leafletHelpers",function(e,t,n){var a=n.getDefer,r=n.getUnresolvedDefer,o=n.setResolvedDefer,i={},l=this,s=["map","tiles","layers","paths","markers","geoJSON","UTFGrid","decorations","directiveControls"];s.forEach(function(e){i[e]={}}),this.unresolveMap=function(e){var t=n.obtainEffectiveMapId(i.map,e);s.forEach(function(e){i[e][t]=void 0})},s.forEach(function(e){var t,n=(t=e).charAt(0).toUpperCase()+t.slice(1);l["set"+n]=function(t,n){r(i[e],n).resolve(t),o(i[e],n)},l["get"+n]=function(t){return a(i[e],t).promise}})}]),angular.module("leaflet-directive").service("leafletDirectiveControlsHelpers",["$log","leafletData","leafletHelpers",function(e,t,n){var a=n.isDefined,r=n.isString,o=n.isObject,i=n.errorHeader+"[leafletDirectiveControlsHelpers";return{extend:function(n,l,s,u){var c=i+".extend] ",d={};if(a(l)){if(r(l)&&a(s)&&a(u))d[l]={create:s,clean:u};else{if(!o(l)||a(s)||a(u))return void e.error(c+"incorrect arguments");d=l}t.getDirectiveControls().then(function(e){angular.extend(e,d),t.setDirectiveControls(e,n)})}else e.error(c+"thingToAddName cannot be undefined")}}}]),angular.module("leaflet-directive").service("leafletGeoJsonHelpers",["leafletHelpers","leafletIterators",function(e,t){var n=e,a=t,r=function(e,t){return this.lat=e,this.lng=t,this},o=function(e){if(n.isUndefined(e))return!1;if(n.isArray(e)){if(2===e.length&&n.isNumber(e[0])&&n.isNumber(e[1]))return!0}else if(n.isDefined(e.type)&&"Point"===e.type&&n.isArray(e.coordinates)&&2===e.coordinates.length&&n.isNumber(e.coordinates[0])&&n.isNumber(e.coordinates[1]))return!0;return a.all(["lat","lng"],function(t){return n.isDefined(e[t])&&n.isNumber(e[t])})};return{getLat:function(e){return Array.isArray(e)&&2===e.length?e[1]:n.isDefined(e.type)&&"Point"===e.type?+e.coordinates[1]:+e.lat},getLng:function(e){return Array.isArray(e)&&2===e.length?e[0]:n.isDefined(e.type)&&"Point"===e.type?+e.coordinates[0]:+e.lng},validateCoords:o,getCoords:function(e){if(e&&o(e)){var t=null;if(Array.isArray(e)&&2===e.length)t=new r(e[1],e[0]);else{if(!n.isDefined(e.type)||"Point"!==e.type)return e;t=new r(e.coordinates[1],e.coordinates[0])}return angular.extend(e,t)}}}}]),angular.module("leaflet-directive").service("leafletHelpers",["$q","$log",function(e,t){var n="[AngularJS - Leaflet] ",a=angular.copy;function r(e,a){var r,o;if(angular.isDefined(a))r=a;else if(0===Object.keys(e).length)r="main";else if(Object.keys(e).length>=1)for(o in e)e.hasOwnProperty(o)&&(r=o);else t.error(n+"- You have more than 1 map on the DOM, you must provide the map ID to the leafletData.getXXX call");return r}function o(t,n){var a,o=r(t,n);return angular.isDefined(t[o])&&!0!==t[o].resolvedDefer?a=t[o].defer:(a=e.defer(),t[o]={defer:a,resolvedDefer:!1}),a}var i=function(e){return angular.isDefined(e)&&null!==e},l=/([\:\-\_]+(.))/g,s=/^moz([A-Z])/,u=/^((?:x|data)[\:\-_])/i,c=function(e){return e.replace(l,function(e,t,n,a){return a?n.toUpperCase():n}).replace(s,"Moz$1")};return{camelCase:c,directiveNormalize:function(e){return c(e.replace(u,""))},copy:a,clone:a,errorHeader:n,getObjectValue:function(e,t){var n;if(e&&angular.isObject(e))return null!==t&&angular.isString(t)?(n=e,t.split(".").forEach(function(e){n&&(n=n[e])}),n):t},getObjectArrayPath:function(e){return e.split(".").reduce(function(e,t){return e+'["'+t+'"]'})},getObjectDotPath:function(e){return e.reduce(function(e,t){return e+"."+t})},defaultTo:function(e,t){return i(e)?e:t},isTruthy:function(e){return"true"===e||!0===e},isEmpty:function(e){return 0===Object.keys(e).length},isUndefinedOrEmpty:function(e){return angular.isUndefined(e)||null===e||0===Object.keys(e).length},isDefined:i,isUndefined:function(e){return!i(e)},isNumber:angular.isNumber,isString:angular.isString,isArray:angular.isArray,isObject:angular.isObject,isFunction:angular.isFunction,equals:angular.equals,isValidCenter:function(e){return angular.isDefined(e)&&angular.isNumber(e.lat)&&angular.isNumber(e.lng)&&angular.isNumber(e.zoom)},isValidPoint:function(e){return!!angular.isDefined(e)&&(angular.isArray(e)?2===e.length&&angular.isNumber(e[0])&&angular.isNumber(e[1]):angular.isNumber(e.lat)&&angular.isNumber(e.lng))},isSameCenterOnMap:function(e,t){var n=t.getCenter(),a=t.getZoom();return!(!e.lat||!e.lng||n.lat.toFixed(4)!==e.lat.toFixed(4)||n.lng.toFixed(4)!==e.lng.toFixed(4)||a!==e.zoom)},safeApply:function(e,t){var n=e.$root.$$phase;"$apply"===n||"$digest"===n?e.$eval(t):e.$evalAsync(t)},obtainEffectiveMapId:r,getDefer:function(e,t){var n=r(e,t);return angular.isDefined(e[n])&&!1!==e[n].resolvedDefer?e[n].defer:o(e,t)},getUnresolvedDefer:o,setResolvedDefer:function(e,t){e[r(e,t)].resolvedDefer=!0},rangeIsSupported:function(){var e=document.createElement("input");return e.setAttribute("type","range"),"range"===e.type},FullScreenControlPlugin:{isLoaded:function(){return angular.isDefined(L.Control.Fullscreen)}},MiniMapControlPlugin:{isLoaded:function(){return angular.isDefined(L.Control.MiniMap)}},AwesomeMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.AwesomeMarkers)&&angular.isDefined(L.AwesomeMarkers.Icon)},is:function(e){return!!this.isLoaded()&&e instanceof L.AwesomeMarkers.Icon},equal:function(e,t){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,t))}},VectorMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.VectorMarkers)&&angular.isDefined(L.VectorMarkers.Icon)},is:function(e){return!!this.isLoaded()&&e instanceof L.VectorMarkers.Icon},equal:function(e,t){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,t))}},DomMarkersPlugin:{isLoaded:function(){return!(!angular.isDefined(L.DomMarkers)||!angular.isDefined(L.DomMarkers.Icon))},is:function(e){return!!this.isLoaded()&&e instanceof L.DomMarkers.Icon},equal:function(e,t){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,t))}},PolylineDecoratorPlugin:{isLoaded:function(){return!!angular.isDefined(L.PolylineDecorator)},is:function(e){return!!this.isLoaded()&&e instanceof L.PolylineDecorator},equal:function(e,t){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,t))}},MakiMarkersPlugin:{isLoaded:function(){return!(!angular.isDefined(L.MakiMarkers)||!angular.isDefined(L.MakiMarkers.Icon))},is:function(e){return!!this.isLoaded()&&e instanceof L.MakiMarkers.Icon},equal:function(e,t){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,t))}},ExtraMarkersPlugin:{isLoaded:function(){return!(!angular.isDefined(L.ExtraMarkers)||!angular.isDefined(L.ExtraMarkers.Icon))},is:function(e){return!!this.isLoaded()&&e instanceof L.ExtraMarkers.Icon},equal:function(e,t){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,t))}},LabelPlugin:{isLoaded:function(){return angular.isDefined(L.Label)},is:function(e){return!!this.isLoaded()&&e instanceof L.MarkerClusterGroup}},MarkerClusterPlugin:{isLoaded:function(){return angular.isDefined(L.MarkerClusterGroup)},is:function(e){return!!this.isLoaded()&&e instanceof L.MarkerClusterGroup}},GoogleLayerPlugin:{isLoaded:function(){return angular.isDefined(L.Google)},is:function(e){return!!this.isLoaded()&&e instanceof L.Google}},LeafletProviderPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.Provider)},is:function(e){return!!this.isLoaded()&&e instanceof L.TileLayer.Provider}},ChinaLayerPlugin:{isLoaded:function(){return angular.isDefined(L.tileLayer.chinaProvider)}},HeatLayerPlugin:{isLoaded:function(){return angular.isDefined(L.heatLayer)}},WebGLHeatMapLayerPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.WebGLHeatMap)}},BingLayerPlugin:{isLoaded:function(){return angular.isDefined(L.BingLayer)},is:function(e){return!!this.isLoaded()&&e instanceof L.BingLayer}},WFSLayerPlugin:{isLoaded:function(){return void 0!==L.GeoJSON.WFS},is:function(e){return!!this.isLoaded()&&e instanceof L.GeoJSON.WFS}},AGSBaseLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.basemapLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.basemapLayer}},AGSLayerPlugin:{isLoaded:function(){return void 0!==lvector&&void 0!==lvector.AGS},is:function(e){return!!this.isLoaded()&&e instanceof lvector.AGS}},AGSFeatureLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.featureLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.featureLayer}},AGSTiledMapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.tiledMapLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.tiledMapLayer}},AGSDynamicMapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.dynamicMapLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.dynamicMapLayer}},AGSImageMapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.imageMapLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.imageMapLayer}},AGSClusteredLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.clusteredFeatureLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.clusteredFeatureLayer}},AGSHeatmapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.heatmapFeatureLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.heatmapFeatureLayer}},YandexLayerPlugin:{isLoaded:function(){return angular.isDefined(L.Yandex)},is:function(e){return!!this.isLoaded()&&e instanceof L.Yandex}},GeoJSONPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.GeoJSON)},is:function(e){return!!this.isLoaded()&&e instanceof L.TileLayer.GeoJSON}},UTFGridPlugin:{isLoaded:function(){return angular.isDefined(L.UtfGrid)},is:function(e){return this.isLoaded()?e instanceof L.UtfGrid:(t.error("[AngularJS - Leaflet] No UtfGrid plugin found."),!1)}},CartoDB:{isLoaded:function(){return cartodb},is:function(){return!0}},Leaflet:{DivIcon:{is:function(e){return e instanceof L.DivIcon},equal:function(e,t){return!!this.is(e)&&angular.equals(e,t)}},Icon:{is:function(e){return e instanceof L.Icon},equal:function(e,t){return!!this.is(e)&&angular.equals(e,t)}}},watchOptions:{doWatch:!0,isDeep:!0,individual:{doWatch:!0,isDeep:!0}}}}]),angular.module("leaflet-directive").service("leafletIterators",["$log","leafletHelpers",function(e,t){var n,a,r,o=t,i=t.errorHeader+"leafletIterators: ",l=Object.keys,s=o.isFunction,u=o.isObject,c=Math.pow(2,53)-1,d=function(e){return e};a=l,n=function(e){var t=arguments.length;if(t<2||null===e)return e;for(var n=1;n<t;n++)for(var o=arguments[n],i=a(o),l=i.length,s=0;s<l;s++){var u=i[s];r&&void 0!==e[u]||(e[u]=o[u])}return e};var p;p=function(e){return e=n({},e),function(t){return function(e,t){var n=l(t),a=n.length;if(null===e)return!a;for(var r=Object(e),o=0;o<a;o++){var i=n[o];if(t[i]!==r[i]||!(i in r))return!1}return!0}(t,e)}};var f,g=function(t,n,a,r){return!(a||o.isDefined(t)&&o.isDefined(n))||!o.isFunction(n)&&(r=o.defaultTo(n,"cb"),e.error(i+r+" is not a function"),!0)},m=function(e,t){!function(e,t,n){if(!g(void 0,n,!0,"internalCb")&&!g(e,t))for(var a in e)e.hasOwnProperty(a)&&n(e[a],a)}(e,t,function(e,n){t(e,n)})};return{each:m,forEach:m,every:f=function(e,t,n){t=function(e,t,n){return null===e?d:s(e)?function(e,t,n){if(void 0===t)return e;switch(null===n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,a){return e.call(t,n,a)};case 3:return function(n,a,r){return e.call(t,n,a,r)};case 4:return function(n,a,r,o){return e.call(t,n,a,r,o)}}return function(){return e.apply(t,arguments)}}(e,t,n):u(e)?p(e):(a=e,function(e){return null===e?void 0:e[a]});var a}(t,n);for(var a=!function(e){var t=null!==e&&e.length;return o.isNumber(t)&&t>=0&&t<=c}(e)&&l(e),r=(a||e).length,i=0;i<r;i++){var f=a?a[i]:i;if(!t(e[f],f,e))return!1}return!0},all:f}}]),angular.module("leaflet-directive").factory("leafletLayerHelpers",["$rootScope","$log","$q","leafletHelpers","leafletIterators",function($rootScope,$log,$q,leafletHelpers,leafletIterators){var Helpers=leafletHelpers,isString=leafletHelpers.isString,isObject=leafletHelpers.isObject,isArray=leafletHelpers.isArray,isDefined=leafletHelpers.isDefined,errorHeader=leafletHelpers.errorHeader,$it=leafletIterators,utfGridCreateLayer=function(e){if(Helpers.UTFGridPlugin.isLoaded()){var t=new L.UtfGrid(e.url,e.pluginOptions);return t.on("mouseover",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMouseover",e)}),t.on("mouseout",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMouseout",e)}),t.on("click",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridClick",e)}),t.on("mousemove",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMousemove",e)}),t}$log.error("[AngularJS - Leaflet] The UTFGrid plugin is not loaded.")},layerTypes={xyz:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer(e.url,e.options)}},mapbox:{mustHaveKey:!0,createLayer:function(e){var t=3;isDefined(e.options.version)&&4===e.options.version&&(t=e.options.version);var n=3===t?"//{s}.tiles.mapbox.com/v3/"+e.key+"/{z}/{x}/{y}.png":"//api.tiles.mapbox.com/v4/"+e.key+"/{z}/{x}/{y}.png?access_token="+e.apiKey;return L.tileLayer(n,e.options)}},geoJSON:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.GeoJSONPlugin.isLoaded())return new L.TileLayer.GeoJSON(e.url,e.pluginOptions,e.options)}},geoJSONShape:{mustHaveUrl:!1,createLayer:function(e){return new L.GeoJSON(e.data,e.options)}},geoJSONAwesomeMarker:{mustHaveUrl:!1,createLayer:function(e){return new L.geoJson(e.data,{pointToLayer:function(t,n){return L.marker(n,{icon:L.AwesomeMarkers.icon(e.icon)})}})}},geoJSONVectorMarker:{mustHaveUrl:!1,createLayer:function(e){return new L.geoJson(e.data,{pointToLayer:function(t,n){return L.marker(n,{icon:L.VectorMarkers.icon(e.icon)})}})}},utfGrid:{mustHaveUrl:!0,createLayer:utfGridCreateLayer},cartodbTiles:{mustHaveKey:!0,createLayer:function(e){var t="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/{z}/{x}/{y}.png";return L.tileLayer(t,e.options)}},cartodbUTFGrid:{mustHaveKey:!0,mustHaveLayer:!0,createLayer:function(e){return e.url="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/"+e.layer+"/{z}/{x}/{y}.grid.json",utfGridCreateLayer(e)}},cartodbInteractive:{mustHaveKey:!0,mustHaveLayer:!0,createLayer:function(e){var t="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/{z}/{x}/{y}.png",n=L.tileLayer(t,e.options);e.url="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/"+e.layer+"/{z}/{x}/{y}.grid.json";var a=utfGridCreateLayer(e);return L.layerGroup([n,a])}},wms:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.wms(e.url,e.options)}},wmts:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.wmts(e.url,e.options)}},wfs:{mustHaveUrl:!0,mustHaveLayer:!0,createLayer:function(params){if(Helpers.WFSLayerPlugin.isLoaded()){var options=angular.copy(params.options);return options.crs&&"string"==typeof options.crs&&(options.crs=eval(options.crs)),new L.GeoJSON.WFS(params.url,params.layer,options)}}},group:{mustHaveUrl:!1,createLayer:function(e){var t=[];return $it.each(e.options.layers,function(e){t.push(createLayer(e))}),e.options.loadedDefer=function(){var t=[];if(isDefined(e.options.layers))for(var n=0;n<e.options.layers.length;n++){var a=e.options.layers[n].layerOptions.loadedDefer;isDefined(a)&&t.push(a)}return t},L.layerGroup(t)}},featureGroup:{mustHaveUrl:!1,createLayer:function(){return L.featureGroup()}},google:{mustHaveUrl:!1,createLayer:function(e){var t=e.type||"SATELLITE";if(Helpers.GoogleLayerPlugin.isLoaded())return new L.Google(t,e.options)}},here:{mustHaveUrl:!1,createLayer:function(e){var t=e.provider||"HERE.terrainDay";if(Helpers.LeafletProviderPlugin.isLoaded())return new L.TileLayer.Provider(t,e.options)}},china:{mustHaveUrl:!1,createLayer:function(e){var t=e.type||"";if(Helpers.ChinaLayerPlugin.isLoaded())return L.tileLayer.chinaProvider(t,e.options)}},agsBase:{mustHaveLayer:!0,createLayer:function(e){if(Helpers.AGSBaseLayerPlugin.isLoaded())return L.esri.basemapLayer(e.layer,e.options)}},ags:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSLayerPlugin.isLoaded()){var t=angular.copy(e.options);angular.extend(t,{url:e.url});var n=new lvector.AGS(t);return n.onAdd=function(e){this.setMap(e)},n.onRemove=function(){this.setMap(null)},n}}},agsFeature:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSFeatureLayerPlugin.isLoaded()){e.options.url=e.url;var t=L.esri.featureLayer(e.options),n=function(){isDefined(e.options.loadedDefer)&&e.options.loadedDefer.resolve()};return t.on("loading",function(){e.options.loadedDefer=$q.defer(),t.off("load",n),t.on("load",n)}),t}$log.warn(errorHeader+" The esri plugin is not loaded.")}},agsTiled:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSTiledMapLayerPlugin.isLoaded())return e.options.url=e.url,L.esri.tiledMapLayer(e.options);$log.warn(errorHeader+" The esri plugin is not loaded.")}},agsDynamic:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSDynamicMapLayerPlugin.isLoaded())return e.options.url=e.url,L.esri.dynamicMapLayer(e.options);$log.warn(errorHeader+" The esri plugin is not loaded.")}},agsImage:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSImageMapLayerPlugin.isLoaded())return e.options.url=e.url,L.esri.imageMapLayer(e.options);$log.warn(errorHeader+" The esri plugin is not loaded.")}},agsClustered:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSClusteredLayerPlugin.isLoaded()){if(Helpers.MarkerClusterPlugin.isLoaded())return L.esri.clusteredFeatureLayer(e.url,e.options);$log.warn(errorHeader+" The markercluster plugin is not loaded.")}else $log.warn(errorHeader+" The esri clustered layer plugin is not loaded.")}},agsHeatmap:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSHeatmapLayerPlugin.isLoaded()){if(Helpers.HeatLayerPlugin.isLoaded())return L.esri.heatmapFeatureLayer(e.url,e.options);$log.warn(errorHeader+" The heatlayer plugin is not loaded.")}else $log.warn(errorHeader+" The esri heatmap layer plugin is not loaded.")}},markercluster:{mustHaveUrl:!1,createLayer:function(e){if(Helpers.MarkerClusterPlugin.isLoaded())return new L.MarkerClusterGroup(e.options);$log.warn(errorHeader+" The markercluster plugin is not loaded.")}},bing:{mustHaveUrl:!1,createLayer:function(e){if(Helpers.BingLayerPlugin.isLoaded())return new L.BingLayer(e.key,e.options)}},webGLHeatmap:{mustHaveUrl:!1,mustHaveData:!0,createLayer:function(e){if(Helpers.WebGLHeatMapLayerPlugin.isLoaded()){var t=new L.TileLayer.WebGLHeatMap(e.options);return isDefined(e.data)&&t.setData(e.data),t}}},heat:{mustHaveUrl:!1,mustHaveData:!0,createLayer:function(e){if(Helpers.HeatLayerPlugin.isLoaded()){var t=new L.heatLayer;return isArray(e.data)&&t.setLatLngs(e.data),isObject(e.options)&&t.setOptions(e.options),t}}},yandex:{mustHaveUrl:!1,createLayer:function(e){var t=e.type||"map";if(Helpers.YandexLayerPlugin.isLoaded())return new L.Yandex(t,e.options)}},imageOverlay:{mustHaveUrl:!0,mustHaveBounds:!0,createLayer:function(e){return L.imageOverlay(e.url,e.bounds,e.options)}},iip:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.iip(e.url,e.options)}},custom:{createLayer:function(e){if(e.layer instanceof L.Class)return angular.copy(e.layer);$log.error("[AngularJS - Leaflet] A custom layer must be a leaflet Class")}},cartodb:{mustHaveUrl:!0,createLayer:function(e){return cartodb.createLayer(e.map,e.url)}}};function isValidLayerType(e){return isString(e.type)?-1===Object.keys(layerTypes).indexOf(e.type)?($log.error("[AngularJS - Leaflet] A layer must have a valid type: "+Object.keys(layerTypes)),!1):layerTypes[e.type].mustHaveUrl&&!isString(e.url)?($log.error("[AngularJS - Leaflet] A base layer must have an url"),!1):layerTypes[e.type].mustHaveData&&!isDefined(e.data)?($log.error('[AngularJS - Leaflet] The base layer must have a "data" array attribute'),!1):layerTypes[e.type].mustHaveLayer&&!isDefined(e.layer)?($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have an layer defined"),!1):layerTypes[e.type].mustHaveBounds&&!isDefined(e.bounds)?($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have bounds defined"),!1):!(layerTypes[e.type].mustHaveKey&&!isDefined(e.key))||($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have key defined"),!1):($log.error("[AngularJS - Leaflet] A layer must have a valid type defined."),!1)}function createLayer(e){if(isValidLayerType(e)){if(isString(e.name)){for(var t in isObject(e.layerParams)||(e.layerParams={}),isObject(e.layerOptions)||(e.layerOptions={}),e.layerParams)e.layerOptions[t]=e.layerParams[t];var n={url:e.url,data:e.data,options:e.layerOptions,layer:e.layer,icon:e.icon,type:e.layerType,bounds:e.bounds,key:e.key,apiKey:e.apiKey,pluginOptions:e.pluginOptions,user:e.user};return layerTypes[e.type].createLayer(n)}$log.error("[AngularJS - Leaflet] A base layer must have a name")}}function safeAddLayer(e,t){t&&"function"==typeof t.addTo?t.addTo(e):e.addLayer(t)}function safeRemoveLayer(e,t,n){if(isDefined(n)&&isDefined(n.loadedDefer))if(angular.isFunction(n.loadedDefer)){var a=n.loadedDefer();$log.debug("Loaded Deferred",a);var r=a.length;if(r>0)for(var o=function(){0===--r&&e.removeLayer(t)},i=0;i<a.length;i++)a[i].promise.then(o);else e.removeLayer(t)}else n.loadedDefer.promise.then(function(){e.removeLayer(t)});else e.removeLayer(t)}return{createLayer:createLayer,safeAddLayer:safeAddLayer,safeRemoveLayer:safeRemoveLayer}}]),angular.module("leaflet-directive").factory("leafletLegendHelpers",function(){var e=function(e,t,n,a){if(e.innerHTML="",t.error)e.innerHTML+='<div class="info-title alert alert-danger">'+t.error.message+"</div>";else if("arcgis"===n)for(var r=0;r<t.layers.length;r++){var o=t.layers[r];e.innerHTML+='<div class="info-title" data-layerid="'+o.layerId+'">'+o.layerName+"</div>";for(var i=0;i<o.legend.length;i++){var l=o.legend[i];e.innerHTML+='<div class="inline" data-layerid="'+o.layerId+'"><img src="data:'+l.contentType+";base64,"+l.imageData+'" /></div><div class="info-label" data-layerid="'+o.layerId+'">'+l.label+"</div>"}}else"image"===n&&(e.innerHTML='<img src="'+a+'"/>')};return{getOnAddLegend:function(t,n,a,r){return function(){var o=L.DomUtil.create("div",n);return L.Browser.touch?L.DomEvent.on(o,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(o),L.DomEvent.on(o,"mousewheel",L.DomEvent.stopPropagation)),e(o,t,a,r),o}},getOnAddArrayLegend:function(e,t){return function(){for(var n=L.DomUtil.create("div",t),a=0;a<e.colors.length;a++)n.innerHTML+='<div class="outline"><i style="background:'+e.colors[a]+'"></i></div><div class="info-label">'+e.labels[a]+"</div>";return L.Browser.touch?L.DomEvent.on(n,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(n),L.DomEvent.on(n,"mousewheel",L.DomEvent.stopPropagation)),n}},updateLegend:e}}),angular.module("leaflet-directive").factory("leafletMapDefaults",["$q","leafletHelpers",function(e,t){var n=t.isDefined,a=t.isObject,r=t.obtainEffectiveMapId,o={};return{reset:function(){o={}},getDefaults:function(e){var t=r(o,e);return o[t]},getMapCreationDefaults:function(e){var t=r(o,e),a=o[t],i={maxZoom:a.maxZoom,keyboard:a.keyboard,dragging:a.dragging,zoomControl:a.zoomControl,doubleClickZoom:a.doubleClickZoom,scrollWheelZoom:a.scrollWheelZoom,tap:a.tap,touchZoom:a.touchZoom,attributionControl:a.attributionControl,worldCopyJump:a.worldCopyJump,crs:a.crs};if(n(a.minZoom)&&(i.minZoom=a.minZoom),n(a.zoomAnimation)&&(i.zoomAnimation=a.zoomAnimation),n(a.fadeAnimation)&&(i.fadeAnimation=a.fadeAnimation),n(a.markerZoomAnimation)&&(i.markerZoomAnimation=a.markerZoomAnimation),a.map)for(var l in a.map)i[l]=a.map[l];return i},setDefaults:function(e,t){var i={keyboard:!0,dragging:!0,worldCopyJump:!1,doubleClickZoom:!0,scrollWheelZoom:!0,tap:!0,touchZoom:!0,zoomControl:!0,zoomsliderControl:!1,zoomControlPosition:"topleft",attributionControl:!0,controls:{layers:{visible:!0,position:"topright",collapsed:!0}},nominatim:{server:" http://nominatim.openstreetmap.org/search"},crs:L.CRS.EPSG3857,tileLayer:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",tileLayerOptions:{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},path:{weight:10,opacity:1,color:"#0000ff"},center:{lat:0,lng:0,zoom:1}};n(e)&&(i.doubleClickZoom=n(e.doubleClickZoom)?e.doubleClickZoom:i.doubleClickZoom,i.scrollWheelZoom=n(e.scrollWheelZoom)?e.scrollWheelZoom:i.doubleClickZoom,i.tap=n(e.tap)?e.tap:i.tap,i.touchZoom=n(e.touchZoom)?e.touchZoom:i.doubleClickZoom,i.zoomControl=n(e.zoomControl)?e.zoomControl:i.zoomControl,i.zoomsliderControl=n(e.zoomsliderControl)?e.zoomsliderControl:i.zoomsliderControl,i.attributionControl=n(e.attributionControl)?e.attributionControl:i.attributionControl,i.tileLayer=n(e.tileLayer)?e.tileLayer:i.tileLayer,i.zoomControlPosition=n(e.zoomControlPosition)?e.zoomControlPosition:i.zoomControlPosition,i.keyboard=n(e.keyboard)?e.keyboard:i.keyboard,i.dragging=n(e.dragging)?e.dragging:i.dragging,n(e.controls)&&angular.extend(i.controls,e.controls),a(e.crs)?i.crs=e.crs:n(L.CRS[e.crs])&&(i.crs=L.CRS[e.crs]),n(e.center)&&angular.copy(e.center,i.center),n(e.tileLayerOptions)&&angular.copy(e.tileLayerOptions,i.tileLayerOptions),n(e.maxZoom)&&(i.maxZoom=e.maxZoom),n(e.minZoom)&&(i.minZoom=e.minZoom),n(e.zoomAnimation)&&(i.zoomAnimation=e.zoomAnimation),n(e.fadeAnimation)&&(i.fadeAnimation=e.fadeAnimation),n(e.markerZoomAnimation)&&(i.markerZoomAnimation=e.markerZoomAnimation),n(e.worldCopyJump)&&(i.worldCopyJump=e.worldCopyJump),n(e.map)&&(i.map=e.map),n(e.path)&&(i.path=e.path));var l=r(o,t);return o[l]=i,i}}}]),angular.module("leaflet-directive").service("leafletMarkersHelpers",["$rootScope","$timeout","leafletHelpers","$log","$compile","leafletGeoJsonHelpers",function(e,t,n,a,r,o){var i=n.isDefined,l=n.defaultTo,s=n.MarkerClusterPlugin,u=n.AwesomeMarkersPlugin,c=n.VectorMarkersPlugin,d=n.MakiMarkersPlugin,p=n.ExtraMarkersPlugin,f=n.DomMarkersPlugin,g=n.safeApply,m=n,v=n.isString,h=n.isNumber,y=n.isObject,b={},w=o,D=n.errorHeader,k=function(e){var t="";return["_icon","_latlng","_leaflet_id","_map","_shadow"].forEach(function(n){t+=n+": "+l(e[n],"undefined")+" \n"}),"[leafletMarker] : \n"+t},x=function(t){if(i(t)&&i(t.type)&&"awesomeMarker"===t.type)return u.isLoaded()||a.error(D+" The AwesomeMarkers Plugin is not loaded."),new L.AwesomeMarkers.icon(t);if(i(t)&&i(t.type)&&"vectorMarker"===t.type)return c.isLoaded()||a.error(D+" The VectorMarkers Plugin is not loaded."),new L.VectorMarkers.icon(t);if(i(t)&&i(t.type)&&"makiMarker"===t.type)return d.isLoaded()||a.error(D+"The MakiMarkers Plugin is not loaded."),new L.MakiMarkers.icon(t);if(i(t)&&i(t.type)&&"extraMarker"===t.type)return p.isLoaded()||a.error(D+"The ExtraMarkers Plugin is not loaded."),new L.ExtraMarkers.icon(t);if(i(t)&&i(t.type)&&"div"===t.type)return new L.divIcon(t);if(i(t)&&i(t.type)&&"dom"===t.type){f.isLoaded()||a.error(D+"The DomMarkers Plugin is not loaded.");var n=angular.isFunction(t.getMarkerScope)?t.getMarkerScope():e,o=r(t.template)(n),l=angular.copy(t);return l.element=o[0],new L.DomMarkers.icon(l)}if(i(t)&&i(t.type)&&"icon"===t.type)return t.icon;return i(t)&&i(t.iconUrl)?new L.Icon(t):new L.Icon.Default({iconUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})},S=function(e,t,n){if(e.closePopup(),i(n)&&i(n.overlays))for(var a in n.overlays)if((n.overlays[a]instanceof L.LayerGroup||n.overlays[a]instanceof L.FeatureGroup)&&n.overlays[a].hasLayer(e))return void n.overlays[a].removeLayer(e);if(i(b))for(var r in b)b[r].hasLayer(e)&&b[r].removeLayer(e);t.hasLayer(e)&&t.removeLayer(e)},$=function(e,n,a){(e._popup._contentNode.innerText||e._popup._contentNode.textContent).length<1&&t(function(){$(e,n,a)});var r=e._popup._contentNode.offsetWidth;return e._popup._updateLayout(),e._popup._updatePosition(),e._popup.options.autoPan&&function(e,t){var n=e._popup._container.offsetHeight,a=new L.Point(e._popup._containerLeft,-n-e._popup._containerBottom);null!==t.layerPointToContainerPoint(a)&&e._popup._adjustPan()}(e,a),r},C=function(t,n,o){var l=angular.isFunction(n.getMessageScope)?n.getMessageScope():e;if(!i(n.compileMessage)||n.compileMessage){if(!i(t._popup)||!i(t._popup._contentNode))return a.error(D+"Popup is invalid or does not have any content."),!1;!function(e,t){r(e._popup._contentNode)(t)}(t,l),$(t,n,o)}},M=function(t,n){var a=angular.isFunction(n.getMessageScope)?n.getMessageScope():e,o=angular.isFunction(n.getLabelScope)?n.getLabelScope():a,l=!i(n.compileMessage)||n.compileMessage;m.LabelPlugin.isLoaded()&&i(n.label)&&(i(n.label.options)&&!0===n.label.options.noHide&&t.showLabel(),l&&i(t.label)&&r(t.label._container)(o))},T=function(e,t,n,r,o,l,s){if(i(t)){if(!w.validateCoords(e))return a.warn("There are problems with lat-lng data, please verify your marker model"),void S(n,s,l);var u=e===t;if(i(e.iconAngle)&&t.iconAngle!==e.iconAngle&&n.setIconAngle(e.iconAngle),v(e.layer)||v(t.layer)&&(i(l.overlays[t.layer])&&l.overlays[t.layer].hasLayer(n)&&(l.overlays[t.layer].removeLayer(n),n.closePopup()),s.hasLayer(n)||s.addLayer(n)),(h(e.opacity)||h(parseFloat(e.opacity)))&&e.opacity!==t.opacity&&n.setOpacity(e.opacity),v(e.layer)&&t.layer!==e.layer){if(v(t.layer)&&i(l.overlays[t.layer])&&l.overlays[t.layer].hasLayer(n)&&l.overlays[t.layer].removeLayer(n),n.closePopup(),s.hasLayer(n)&&s.removeLayer(n),!i(l.overlays[e.layer]))return void a.error(D+"You must use a name of an existing layer");var c=l.overlays[e.layer];if(!(c instanceof L.LayerGroup||c instanceof L.FeatureGroup))return void a.error(D+'A marker can only be added to a layer of type "group" or "featureGroup"');c.addLayer(n),s.hasLayer(n)&&!0===e.focus&&n.openPopup()}if(!0!==e.draggable&&!0===t.draggable&&i(n.dragging)&&n.dragging.disable(),!0===e.draggable&&!0!==t.draggable&&(n.dragging?n.dragging.enable():L.Handler.MarkerDrag&&(n.dragging=new L.Handler.MarkerDrag(n),n.options.draggable=!0,n.dragging.enable())),y(e.icon)||y(t.icon)&&(n.setIcon(x()),n.closePopup(),n.unbindPopup(),v(e.message)&&n.bindPopup(e.message,e.popupOptions)),y(e.icon)&&y(t.icon)&&!angular.equals(e.icon,t.icon)){var d=!1;n.dragging&&(d=n.dragging.enabled()),n.setIcon(x(e.icon)),d&&n.dragging.enable(),n.closePopup(),n.unbindPopup(),v(e.message)&&(n.bindPopup(e.message,e.popupOptions),s.hasLayer(n)&&!0===e.focus&&n.openPopup())}!v(e.message)&&v(t.message)&&(n.closePopup(),n.unbindPopup()),m.LabelPlugin.isLoaded()&&(i(e.label)&&i(e.label.message)?"label"in t&&"message"in t.label&&!angular.equals(e.label.message,t.label.message)?n.updateLabelContent(e.label.message):!angular.isFunction(n.getLabel)||angular.isFunction(n.getLabel)&&!i(n.getLabel())?(n.bindLabel(e.label.message,e.label.options),M(n,e)):M(n,e):"label"in e&&!("message"in e.label)||angular.isFunction(n.unbindLabel)&&n.unbindLabel()),v(e.message)&&!v(t.message)&&n.bindPopup(e.message,e.popupOptions),v(e.message)&&v(t.message)&&e.message!==t.message&&n.setPopupContent(e.message);var p=!1;!0!==e.focus&&!0===t.focus&&(n.closePopup(),p=!0),(!0===e.focus&&(!i(t.focus)||!1===t.focus)||u&&!0===e.focus)&&(n.openPopup(),p=!0),t.zIndexOffset!==e.zIndexOffset&&n.setZIndexOffset(e.zIndexOffset);var f=n.getLatLng();v(e.layer)&&m.MarkerClusterPlugin.is(l.overlays[e.layer])?p?e.lat===t.lat&&e.lng===t.lng||(l.overlays[e.layer].removeLayer(n),n.setLatLng([e.lat,e.lng]),l.overlays[e.layer].addLayer(n)):f.lat!==e.lat||f.lng!==e.lng?(l.overlays[e.layer].removeLayer(n),n.setLatLng([e.lat,e.lng]),l.overlays[e.layer].addLayer(n)):e.lat!==t.lat||e.lng!==t.lng?(l.overlays[e.layer].removeLayer(n),n.setLatLng([e.lat,e.lng]),l.overlays[e.layer].addLayer(n)):y(e.icon)&&y(t.icon)&&!angular.equals(e.icon,t.icon)&&(l.overlays[e.layer].removeLayer(n),l.overlays[e.layer].addLayer(n)):f.lat===e.lat&&f.lng===e.lng||n.setLatLng([e.lat,e.lng])}};return{resetMarkerGroup:function(e){i(b[e])&&b.splice(e,1)},resetMarkerGroups:function(){b={}},deleteMarker:S,manageOpenPopup:C,manageOpenLabel:M,createMarker:function(e){if(i(e)&&w.validateCoords(e)){var t=w.getCoords(e);if(i(t)){var n={icon:x(e.icon),title:i(e.title)?e.title:"",draggable:!!i(e.draggable)&&e.draggable,clickable:!i(e.clickable)||e.clickable,riseOnHover:!!i(e.riseOnHover)&&e.riseOnHover,zIndexOffset:i(e.zIndexOffset)?e.zIndexOffset:0,iconAngle:i(e.iconAngle)?e.iconAngle:0};for(var r in e)e.hasOwnProperty(r)&&!n.hasOwnProperty(r)&&(n[r]=e[r]);var o=new L.marker(t,n);return v(e.message)||o.unbindPopup(),o}a.error(D+"Unable to get coordinates from markerData.")}else a.error(D+"The marker definition is not valid.")},addMarkerToGroup:function(e,t,n,r){v(t)?s.isLoaded()?(i(b[t])||(b[t]=new L.MarkerClusterGroup(n),r.addLayer(b[t])),b[t].addLayer(e)):a.error(D+"The MarkerCluster plugin is not loaded."):a.error(D+"The marker group you have specified is invalid.")},listenMarkerEvents:function(e,t,n,a,r){e.on("popupopen",function(){g(n,function(){(i(e._popup)||i(e._popup._contentNode))&&(t.focus=!0,C(e,t,r))})}),e.on("popupclose",function(){g(n,function(){t.focus=!1})}),e.on("add",function(){g(n,function(){"label"in t&&M(e,t)})})},updateMarker:T,addMarkerWatcher:function(e,t,n,a,r,o){var s=m.getObjectArrayPath("markers."+t);o=l(o,!0);var u=n.$watch(s,function(t,n){if(!i(t))return S(e,r,a),void u();T(t,n,e,0,0,a,r)},o)},string:k,log:function(e,t){(t?console:a).debug(k(e))}}}]),angular.module("leaflet-directive").factory("leafletPathsHelpers",["$rootScope","$log","leafletHelpers",function(e,t,n){var a=n.isDefined,r=n.isArray,o=n.isNumber,i=n.isValidPoint,l=["stroke","weight","color","opacity","fill","fillColor","fillOpacity","dashArray","lineCap","lineJoin","clickable","pointerEvents","className","smoothFactor","noClip"];function s(e){return e.filter(function(e){return i(e)}).map(function(e){return u(e)})}function u(e){return r(e)?new L.LatLng(e[0],e[1]):new L.LatLng(e.lat,e.lng)}function c(e){return e.map(function(e){return s(e)})}var d=function(e,t){for(var n={},r=0;r<l.length;r++){var o=l[r];a(t[o])&&(n[o]=t[o])}e.setStyle(t)},p=function(e){if(!r(e))return!1;for(var t=0;t<e.length;t++){var n=e[t];if(!i(n))return!1}return!0},f={polyline:{isValid:function(e){var t=e.latlngs;return p(t)},createPath:function(e){return new L.Polyline([],e)},setPath:function(e,t){e.setLatLngs(s(t.latlngs)),d(e,t)}},multiPolyline:{isValid:function(e){var t=e.latlngs;if(!r(t))return!1;for(var n in t){var a=t[n];if(!p(a))return!1}return!0},createPath:function(e){return new L.multiPolyline([[[0,0],[1,1]]],e)},setPath:function(e,t){e.setLatLngs(c(t.latlngs)),d(e,t)}},polygon:{isValid:function(e){var t=e.latlngs;return p(t)},createPath:function(e){return new L.Polygon([],e)},setPath:function(e,t){e.setLatLngs(s(t.latlngs)),d(e,t)}},multiPolygon:{isValid:function(e){var t=e.latlngs;if(!r(t))return!1;for(var n in t){var a=t[n];if(!p(a))return!1}return!0},createPath:function(e){return new L.MultiPolygon([[[0,0],[1,1],[0,1]]],e)},setPath:function(e,t){e.setLatLngs(c(t.latlngs)),d(e,t)}},rectangle:{isValid:function(e){var t=e.latlngs;if(!r(t)||2!==t.length)return!1;for(var n in t){var a=t[n];if(!i(a))return!1}return!0},createPath:function(e){return new L.Rectangle([[0,0],[1,1]],e)},setPath:function(e,t){e.setBounds(new L.LatLngBounds(s(t.latlngs))),d(e,t)}},circle:{isValid:function(e){var t=e.latlngs;return i(t)&&o(e.radius)},createPath:function(e){return new L.Circle([0,0],1,e)},setPath:function(e,t){e.setLatLng(u(t.latlngs)),a(t.radius)&&e.setRadius(t.radius),d(e,t)}},circleMarker:{isValid:function(e){var t=e.latlngs;return i(t)&&o(e.radius)},createPath:function(e){return new L.CircleMarker([0,0],e)},setPath:function(e,t){e.setLatLng(u(t.latlngs)),a(t.radius)&&e.setRadius(t.radius),d(e,t)}}};return{setPathOptions:function(e,t,n){a(t)||(t="polyline"),f[t].setPath(e,n)},createPath:function(e,n,r){a(n.type)||(n.type="polyline");var o=function(e,t){for(var n={},r=0;r<l.length;r++){var o=l[r];a(e[o])?n[o]=e[o]:a(t.path[o])&&(n[o]=t.path[o])}return n}(n,r),i=function(e){var t={};return e.latlngs&&(t.latlngs=e.latlngs),e.radius&&(t.radius=e.radius),t}(n);if(f[n.type].isValid(i))return f[n.type].createPath(o);t.error("[AngularJS - Leaflet] Invalid data passed to the "+n.type+" path")}}}]),angular.module("leaflet-directive").service("leafletWatchHelpers",function(){var e=function(e,t,n,a,r){var o=e[t](n,function(e,t){r(e,t),a.doWatch||o()},a.isDeep);return o};return{maybeWatch:function(t,n,a,r){return e(t,"$watch",n,a,r)},maybeWatchCollection:function(t,n,a,r){return e(t,"$watchCollection",n,a,r)}}}),angular.module("leaflet-directive").factory("nominatimService",["$q","$http","leafletHelpers","leafletMapDefaults",function(e,t,n,a){var r=n.isDefined;return{query:function(n,o){var i=a.getDefaults(o).nominatim.server,l=e.defer();return t.get(i,{params:{format:"json",limit:1,q:n}}).success(function(e){e.length>0&&r(e[0].boundingbox)?l.resolve(e[0]):l.reject("[Nominatim] Invalid address")}),l.promise}}}]),angular.module("leaflet-directive").directive("bounds",["$log","$timeout","$http","leafletHelpers","nominatimService","leafletBoundsHelpers",function(e,t,n,a,r,o){return{restrict:"A",scope:!1,replace:!1,require:["leaflet"],link:function(n,i,l,s){var u=a.isDefined,c=o.createLeafletBounds,d=s[0].getLeafletScope(),p=s[0],f=a.errorHeader+" [Bounds] ";p.getMap().then(function(a){var o;d.$on("boundsChanged",function(e){var n=e.currentScope,r=a.getBounds();if(!function(e){return 0===e._southWest.lat&&0===e._southWest.lng&&0===e._northEast.lat&&0===e._northEast.lng}(r)&&!n.settingBoundsFromScope){n.settingBoundsFromLeaflet=!0;var o={northEast:{lat:r._northEast.lat,lng:r._northEast.lng},southWest:{lat:r._southWest.lat,lng:r._southWest.lng},options:r.options};angular.equals(n.bounds,o)||(n.bounds=o),t(function(){n.settingBoundsFromLeaflet=!1})}}),d.$watch("bounds",function(i){if(!n.settingBoundsFromLeaflet){if(u(i.address)&&i.address!==o)return n.settingBoundsFromScope=!0,r.query(i.address,l.id).then(function(e){var t=e.boundingbox,n=[[t[0],t[2]],[t[1],t[3]]];a.fitBounds(n)},function(t){e.error(f+" "+t+".")}),o=i.address,void t(function(){n.settingBoundsFromScope=!1});var s=c(i);s&&!a.getBounds().equals(s)&&(n.settingBoundsFromScope=!0,a.fitBounds(s,i.options),t(function(){n.settingBoundsFromScope=!1}))}},!0)})}}}]);var centerDirectiveTypes=["center","lfCenter"],centerDirectives={};centerDirectiveTypes.forEach(function(e){centerDirectives[e]=["$log","$q","$location","$timeout","leafletMapDefaults","leafletHelpers","leafletBoundsHelpers","leafletMapEvents",function(t,n,a,r,o,i,l,s){var u,c=i.isDefined,d=i.isNumber,p=i.isSameCenterOnMap,f=i.safeApply,g=i.isValidCenter,m=l.isValidBounds,v=i.isUndefinedOrEmpty,h=i.errorHeader;return{restrict:"A",scope:!1,replace:!1,require:"leaflet",controller:function(){u=n.defer(),this.getCenter=function(){return u.promise}},link:function(n,i,y,b){var L=b.getLeafletScope(),w=L[e];b.getMap().then(function(n){var i,b,D,k,x=o.getDefaults(y.id);if(-1!==y[e].search("-"))return t.error(h+' The "center" variable can\'t use a "-" on its key name: "'+y[e]+'".'),void n.setView([x.center.lat,x.center.lng],x.center.zoom);if(i=L.bounds,b=w,c(i)&&m(i)&&v(b))n.fitBounds(l.createLeafletBounds(L.bounds),L.bounds.options),w=n.getCenter(),f(L,function(t){angular.extend(t[e],{lat:n.getCenter().lat,lng:n.getCenter().lng,zoom:n.getZoom(),autoDiscover:!1})}),f(L,function(e){var t=n.getBounds();e.bounds={northEast:{lat:t._northEast.lat,lng:t._northEast.lng},southWest:{lat:t._southWest.lat,lng:t._southWest.lng}}});else{if(!c(w))return t.error(h+' The "center" property is not defined in the main scope'),void n.setView([x.center.lat,x.center.lng],x.center.zoom);c(w.lat)&&c(w.lng)||c(w.autoDiscover)||angular.copy(x.center,w)}if("yes"===y.urlHashCenter){var S=function(){var e,t=a.search();if(c(t.c)){var n=t.c.split(":");3===n.length&&(e={lat:parseFloat(n[0]),lng:parseFloat(n[1]),zoom:parseInt(n[2],10)})}return e};D=S(),L.$on("$locationChangeSuccess",function(t){var a=t.currentScope,r=S();c(r)&&!p(r,n)&&angular.extend(a[e],{lat:r.lat,lng:r.lng,zoom:r.zoom})})}L.$watch(e,function(e){if(!L.settingCenterFromLeaflet){if(c(D)&&(angular.copy(D,e),D=void 0),g(e)||!0===e.autoDiscover)return!0===e.autoDiscover?(d(e.zoom)||n.setView([x.center.lat,x.center.lng],x.center.zoom),void(d(e.zoom)&&e.zoom>x.center.zoom?n.locate({setView:!0,maxZoom:e.zoom}):c(x.maxZoom)?n.locate({setView:!0,maxZoom:x.maxZoom}):n.locate({setView:!0}))):void(k&&p(e,n)||(L.settingCenterFromScope=!0,n.setView([e.lat,e.lng],e.zoom),s.notifyCenterChangedToBounds(L,n),r(function(){L.settingCenterFromScope=!1})));t.warn(h+" invalid 'center'")}},!0),n.whenReady(function(){k=!0}),n.on("moveend",function(){u.resolve(),s.notifyCenterUrlHashChanged(L,n,y,a.search()),p(w,n)||L.settingCenterFromScope||(L.settingCenterFromLeaflet=!0,f(L,function(t){L.settingCenterFromScope||angular.extend(t[e],{lat:n.getCenter().lat,lng:n.getCenter().lng,zoom:n.getZoom(),autoDiscover:!1}),s.notifyCenterChangedToBounds(L,n),r(function(){L.settingCenterFromLeaflet=!1})}))}),!0===w.autoDiscover&&n.on("locationerror",function(){t.warn(h+" The Geolocation API is unauthorized on this page."),g(w)?(n.setView([w.lat,w.lng],w.zoom),s.notifyCenterChangedToBounds(L,n)):(n.setView([x.center.lat,x.center.lng],x.center.zoom),s.notifyCenterChangedToBounds(L,n))})})}}}]}),centerDirectiveTypes.forEach(function(e){angular.module("leaflet-directive").directive(e,centerDirectives[e])}),angular.module("leaflet-directive").directive("controls",["$log","leafletHelpers","leafletControlHelpers",function(e,t,n){return{restrict:"A",scope:!1,replace:!1,require:"?^leaflet",link:function(a,r,o,i){if(i){var l=n.createControl,s=n.isValidControlType,u=i.getLeafletScope(),c=t.isDefined,d=t.isArray,p={},f=t.errorHeader+" [Controls] ";i.getMap().then(function(t){u.$watchCollection("controls",function(n){for(var a in p)c(n[a])||(t.hasControl(p[a])&&t.removeControl(p[a]),delete p[a]);for(var r in n){var o,i=c(n[r].type)?n[r].type:r;if(!s(i))return void e.error(f+" Invalid control type: "+i+".");if("custom"!==i)o=l(i,n[r]),t.addControl(o),p[r]=o;else{var u=n[r];if(d(u))for(var g in u){var m=u[g];t.addControl(m),p[r]=c(p[r])?p[r].concat([m]):[m]}else t.addControl(u),p[r]=u}}})})}}}}]),angular.module("leaflet-directive").directive("decorations",["$log","leafletHelpers",function(e,t){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(n,a,r,o){var i=o.getLeafletScope(),l=t.PolylineDecoratorPlugin,s=t.isDefined,u={};function c(e,t){if(s(e)&&s(t)&&s(t.coordinates)&&s(t.patterns))return e.setPaths(t.coordinates),e.setPatterns(t.patterns),e}o.getMap().then(function(t){i.$watch("decorations",function(n){for(var a in u)s(n[a])&&angular.equals(n[a],u)||(t.removeLayer(u[a]),delete u[a]);for(var r in n){var o=n[r],i=(s(d=o)&&s(d.coordinates)&&(l.isLoaded()||e.error("[AngularJS - Leaflet] The PolylineDecorator Plugin is not loaded.")),L.polylineDecorator(d.coordinates));s(i)&&(u[r]=i,t.addLayer(i),c(i,o))}var d},!0)})}}}]),angular.module("leaflet-directive").directive("eventBroadcast",["$log","$rootScope","leafletHelpers","leafletMapEvents","leafletIterators",function(e,t,n,a,r){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(t,o,i,l){var s=n.isObject,u=n.isDefined,c=l.getLeafletScope(),d=c.eventBroadcast,p=a.getAvailableMapEvents(),f=a.addEvents;l.getMap().then(function(t){var n=[],a="broadcast";u(d.map)?s(d.map)?("emit"!==d.map.logic&&"broadcast"!==d.map.logic?e.warn("[AngularJS - Leaflet] Available event propagation logic are: 'emit' or 'broadcast'."):a=d.map.logic,s(d.map.enable)&&d.map.enable.length>=0?r.each(d.map.enable,function(e){-1===n.indexOf(e)&&-1!==p.indexOf(e)&&n.push(e)}):e.warn("[AngularJS - Leaflet] event-broadcast.map.enable must be an object check your model.")):e.warn("[AngularJS - Leaflet] event-broadcast.map must be an object check your model."):n=p,f(t,n,"eventName",c,a)})}}}]),angular.module("leaflet-directive").directive("geojson",["$log","$rootScope","leafletData","leafletHelpers","leafletWatchHelpers","leafletDirectiveControlsHelpers","leafletIterators","leafletGeoJsonEvents",function(e,t,n,a,r,o,i,l){var s=r.maybeWatch,u=a.watchOptions,c=o.extend,d=a,p=i;return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,t,r,o){var i=a.isDefined,f=o.getLeafletScope(),g={},m=!1;o.getMap().then(function(e){var t=f.geojsonWatchOptions||u,o=d.isDefined(r.geojsonNested)&&d.isTruthy(r.geojsonNested),v=function(){if(g){var t=function(t){i(t)&&e.hasLayer(t)&&e.removeLayer(t)};o?p.each(g,function(e){t(e)}):t(g)}},h=function(t,o){var s=angular.copy(t);if(i(s)&&i(s.data)){var u=function(e,t){return angular.isFunction(e.onEachFeature)?e.onEachFeature:function(n,o){a.LabelPlugin.isLoaded()&&i(n.properties.description)&&o.bindLabel(n.properties.description),l.bindEvents(r.id,o,null,n,f,t,{resetStyleOnMouseout:e.resetStyleOnMouseout,mapId:r.id})}}(s,o);i(s.options)||(s.options={style:s.style,filter:s.filter,onEachFeature:u,pointToLayer:s.pointToLayer});var c=L.geoJson(s.data,s.options);o&&d.isString(o)?g[o]=c:g=c,c.addTo(e),m||(m=!0,n.setGeoJSON(g,r.id))}},y=function(e){if(v(),o){if(!e||!Object.keys(e).length)return;p.each(e,function(e,t){h(e,t)})}else h(e)};c(r.id,"geojson",y,v),s(f,"geojson",t,function(e){y(e)})})}}}]),angular.module("leaflet-directive").directive("layercontrol",["$filter","$log","leafletData","leafletHelpers",function(e,t,n,a){return{restrict:"E",scope:{icons:"=?",autoHideOpacity:"=?",showGroups:"=?",title:"@",baseTitle:"@",overlaysTitle:"@"},replace:!0,transclude:!1,require:"^leaflet",controller:["$scope","$element","$sce",function(e,r,o){t.debug("[Angular Directive - Layers] layers",e,r);var i=a.safeApply,l=a.isDefined;angular.extend(e,{baselayer:"",oldGroup:"",layerProperties:{},groupProperties:{},rangeIsSupported:a.rangeIsSupported(),changeBaseLayer:function(t,r){a.safeApply(e,function(a){a.baselayer=t,n.getMap().then(function(r){n.getLayers().then(function(n){if(!r.hasLayer(n.baselayers[t])){for(var o in a.layers.baselayers)a.layers.baselayers[o].icon=a.icons.unradio,r.hasLayer(n.baselayers[o])&&r.removeLayer(n.baselayers[o]);r.addLayer(n.baselayers[t]),a.layers.baselayers[t].icon=e.icons.radio}})})}),r.preventDefault()},moveLayer:function(t,n,a){var r=Object.keys(e.layers.baselayers).length;if(n>=1+r&&n<=e.overlaysArray.length+r){var o;for(var l in e.layers.overlays)if(e.layers.overlays[l].index===n){o=e.layers.overlays[l];break}o&&i(e,function(){o.index=t.index,t.index=n})}a.stopPropagation(),a.preventDefault()},initIndex:function(t,n){var a=Object.keys(e.layers.baselayers).length;t.index=l(t.index)?t.index:n+a+1},initGroup:function(t){e.groupProperties[t]=e.groupProperties[t]?e.groupProperties[t]:{}},toggleOpacity:function(t,n){if(n.visible){if(e.autoHideOpacity&&!e.layerProperties[n.name].opacityControl)for(var a in e.layerProperties)e.layerProperties[a].opacityControl=!1;e.layerProperties[n.name].opacityControl=!e.layerProperties[n.name].opacityControl}t.stopPropagation(),t.preventDefault()},toggleLegend:function(t){e.layerProperties[t.name].showLegend=!e.layerProperties[t.name].showLegend},showLegend:function(t){return t.legend&&e.layerProperties[t.name].showLegend},unsafeHTML:function(e){return o.trustAsHtml(e)},getOpacityIcon:function(t){return t.visible&&e.layerProperties[t.name].opacityControl?e.icons.close:e.icons.open},getGroupIcon:function(t){return t.visible?e.icons.check:e.icons.uncheck},changeOpacity:function(t){var a=e.layerProperties[t.name].opacity;n.getMap().then(function(r){n.getLayers().then(function(n){var o;for(var i in e.layers.overlays)if(e.layers.overlays[i]===t){o=n.overlays[i];break}r.hasLayer(o)&&(o.setOpacity&&o.setOpacity(a/100),o.getLayers&&o.eachLayer&&o.eachLayer(function(e){e.setOpacity&&e.setOpacity(a/100)}))})})},changeGroupVisibility:function(t){if(l(e.groupProperties[t])){var n=e.groupProperties[t].visible;for(var a in e.layers.overlays){var r=e.layers.overlays[a];r.group===t&&(r.visible=n)}}}});var s=r.get(0);L.Browser.touch?L.DomEvent.on(s,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(s),L.DomEvent.on(s,"mousewheel",L.DomEvent.stopPropagation))}],template:'<div class="angular-leaflet-control-layers" ng-show="overlaysArray.length"><h4 ng-if="title">{{ title }}</h4><div class="lf-baselayers"><h5 class="lf-title" ng-if="baseTitle">{{ baseTitle }}</h5><div class="lf-row" ng-repeat="(key, layer) in baselayersArray"><label class="lf-icon-bl" ng-click="changeBaseLayer(key, $event)"><input class="leaflet-control-layers-selector" type="radio" name="lf-radio" ng-show="false" ng-checked="baselayer === key" ng-value="key" /> <i class="lf-icon lf-icon-radio" ng-class="layer.icon"></i><div class="lf-text">{{layer.name}}</div></label></div></div><div class="lf-overlays"><h5 class="lf-title" ng-if="overlaysTitle">{{ overlaysTitle }}</h5><div class="lf-container"><div class="lf-row" ng-repeat="layer in (o = (overlaysArray | orderBy:\'index\':order))" ng-init="initIndex(layer, $index)"><label class="lf-icon-ol-group" ng-if="showGroups &amp;&amp; layer.group &amp;&amp; layer.group != o[$index-1].group"><input class="lf-control-layers-selector" type="checkbox" ng-show="false" ng-change="changeGroupVisibility(layer.group)" ng-model="groupProperties[layer.group].visible"/> <i class="lf-icon lf-icon-check" ng-class="getGroupIcon(groupProperties[layer.group])"></i><div class="lf-text">{{ layer.group }}</div></label><label class="lf-icon-ol"><input class="lf-control-layers-selector" type="checkbox" ng-show="false" ng-model="layer.visible"/> <i class="lf-icon lf-icon-check" ng-class="layer.icon"></i><div class="lf-text">{{layer.name}}</div></label><div class="lf-icons"><i class="lf-icon lf-up" ng-class="icons.up" ng-click="moveLayer(layer, layer.index - orderNumber, $event)"></i> <i class="lf-icon lf-down" ng-class="icons.down" ng-click="moveLayer(layer, layer.index + orderNumber, $event)"></i> <i class="lf-icon lf-toggle-legend" ng-class="icons.toggleLegend" ng-if="layer.legend" ng-click="toggleLegend(layer)"></i> <i class="lf-icon lf-open" ng-class="getOpacityIcon(layer)" ng-click="toggleOpacity($event, layer)"></i></div><div class="lf-legend" ng-if="showLegend(layer)" ng-bind-html="unsafeHTML(layer.legend)"></div><div class="lf-opacity clearfix" ng-if="layer.visible &amp;&amp; layerProperties[layer.name].opacityControl"><label ng-if="rangeIsSupported" class="pull-left" style="width: 50%">0</label><label ng-if="rangeIsSupported" class="pull-left text-right" style="width: 50%">100</label><input ng-if="rangeIsSupported" class="clearfix" type="range" min="0" max="100" class="lf-opacity-control" ng-model="layerProperties[layer.name].opacity" ng-change="changeOpacity(layer)"/><h6 ng-if="!rangeIsSupported">Range is not supported in this browser</h6></div></div></div></div></div>',link:function(e,t,r,o){var i=a.isDefined,l=o.getLeafletScope(),s=l.layers;e.$watch("icons",function(){var t={uncheck:"fa fa-square-o",check:"fa fa-check-square-o",radio:"fa fa-dot-circle-o",unradio:"fa fa-circle-o",up:"fa fa-angle-up",down:"fa fa-angle-down",open:"fa fa-angle-double-down",close:"fa fa-angle-double-up",toggleLegend:"fa fa-pencil-square-o"};i(e.icons)?(angular.extend(t,e.icons),angular.extend(e.icons,t)):e.icons=t}),r.order=!i(r.order)||"normal"!==r.order&&"reverse"!==r.order?"normal":r.order,e.order="normal"===r.order,e.orderNumber="normal"===r.order?-1:1,e.layers=s,o.getMap().then(function(t){l.$watch("layers.baselayers",function(a){var r={};n.getLayers().then(function(n){var o;for(o in a){var i=a[o];i.icon=e.icons[t.hasLayer(n.baselayers[o])?"radio":"unradio"],r[o]=i}e.baselayersArray=r})}),l.$watch("layers.overlays",function(t){var a=[],r={};n.getLayers().then(function(n){var o;for(o in t){var l=t[o];l.icon=e.icons[l.visible?"check":"uncheck"],a.push(l),i(e.layerProperties[l.name])||(e.layerProperties[l.name]={opacity:i(l.layerOptions.opacity)?100*l.layerOptions.opacity:100,opacityControl:!1,showLegend:!0}),i(l.group)&&(i(e.groupProperties[l.group])||(e.groupProperties[l.group]={visible:!1}),r[l.group]=i(r[l.group])?r[l.group]:{count:0,visibles:0},r[l.group].count++,l.visible&&r[l.group].visibles++),i(l.index)&&n.overlays[o].setZIndex&&n.overlays[o].setZIndex(t[o].index)}for(o in r)e.groupProperties[o].visible=r[o].visibles===r[o].count;e.overlaysArray=a})},!0)})}}}]),angular.module("leaflet-directive").directive("layers",["$log","$q","leafletData","leafletHelpers","leafletLayerHelpers","leafletControlHelpers",function(e,t,n,a,r,o){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",controller:["$scope",function(e){e._leafletLayers=t.defer(),this.getLayers=function(){return e._leafletLayers.promise}}],link:function(e,t,i,l){var s=a.isDefined,u={},c=l.getLeafletScope(),d=c.layers,p=r.createLayer,f=r.safeAddLayer,g=r.safeRemoveLayer,m=o.updateLayersControl,v=!1;l.getMap().then(function(t){e._leafletLayers.resolve(u),n.setLayers(u,i.id),u.baselayers={},u.overlays={};var a=i.id,r=!1;for(var o in d.baselayers){var l=p(d.baselayers[o]);s(l)?(u.baselayers[o]=l,!0===d.baselayers[o].top&&(f(t,u.baselayers[o]),r=!0)):delete d.baselayers[o]}for(o in!r&&Object.keys(u.baselayers).length>0&&f(t,u.baselayers[Object.keys(d.baselayers)[0]]),d.overlays){var h=p(d.overlays[o]);s(h)?(u.overlays[o]=h,!0===d.overlays[o].visible&&f(t,u.overlays[o])):delete d.overlays[o]}c.$watch("layers.baselayers",function(e,n){if(angular.equals(e,n))return v=m(t,a,v,e,d.overlays,u),!0;for(var r in u.baselayers)s(e[r])&&!e[r].doRefresh||(t.hasLayer(u.baselayers[r])&&t.removeLayer(u.baselayers[r]),delete u.baselayers[r],e[r]&&e[r].doRefresh&&(e[r].doRefresh=!1));for(var o in e)if(s(u.baselayers[o]))!0!==e[o].top||t.hasLayer(u.baselayers[o])?!1===e[o].top&&t.hasLayer(u.baselayers[o])&&t.removeLayer(u.baselayers[o]):f(t,u.baselayers[o]);else{var i=p(e[o]);s(i)&&(u.baselayers[o]=i,!0===e[o].top&&f(t,u.baselayers[o]))}var l=!1;for(var c in u.baselayers)if(t.hasLayer(u.baselayers[c])){l=!0;break}!l&&Object.keys(u.baselayers).length>0&&f(t,u.baselayers[Object.keys(u.baselayers)[0]]),v=m(t,a,v,e,d.overlays,u)},!0),c.$watch("layers.overlays",function(e,n){if(angular.equals(e,n))return v=m(t,a,v,d.baselayers,e,u),!0;for(var r in u.overlays)if(!s(e[r])||e[r].doRefresh){if(t.hasLayer(u.overlays[r])){var o=s(e[r])?e[r].layerOptions:null;g(t,u.overlays[r],o)}delete u.overlays[r],e[r]&&e[r].doRefresh&&(e[r].doRefresh=!1)}for(var i in e){if(s(u.overlays[i]))e[i].visible&&!t.hasLayer(u.overlays[i])?f(t,u.overlays[i]):!1===e[i].visible&&t.hasLayer(u.overlays[i])&&g(t,u.overlays[i],e[i].layerOptions);else{var l=p(e[i]);if(!s(l))continue;u.overlays[i]=l,!0===e[i].visible&&f(t,u.overlays[i])}e[i].visible&&t._loaded&&e[i].data&&"heatmap"===e[i].type&&(u.overlays[i].setData(e[i].data),u.overlays[i].update())}v=m(t,a,v,d.baselayers,e,u)},!0)})}}}]),angular.module("leaflet-directive").directive("legend",["$log","$http","leafletHelpers","leafletLegendHelpers",function(e,t,n,a){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(r,o,i,l){var s,u,c,d,p=n.isArray,f=n.isDefined,g=n.isFunction,m=l.getLeafletScope(),v=m.legend;m.$watch("legend",function(e){f(e)&&(s=e.legendClass?e.legendClass:"legend",u=e.position||"bottomright",d=e.type||"arcgis")},!0),l.getMap().then(function(n){m.$watch("legend",function(t){f(t)?f(t.url)||"arcgis"!==d||p(t.colors)&&p(t.labels)&&t.colors.length===t.labels.length?f(t.url)?e.info("[AngularJS - Leaflet] loading legend service."):(f(c)&&(c.removeFrom(n),c=null),c=L.control({position:u}),"arcgis"===d&&(c.onAdd=a.getOnAddArrayLegend(t,s)),c.addTo(n)):e.warn("[AngularJS - Leaflet] legend.colors and legend.labels must be set."):f(c)&&(c.removeFrom(n),c=null)}),m.$watch("legend.url",function(r){f(r)&&t.get(r).success(function(e){f(c)?a.updateLegend(c.getContainer(),e,d,r):((c=L.control({position:u})).onAdd=a.getOnAddLegend(e,s,d,r),c.addTo(n)),f(v.loadedData)&&g(v.loadedData)&&v.loadedData()}).error(function(){e.warn("[AngularJS - Leaflet] legend.url not loaded.")})})})}}}]),angular.module("leaflet-directive").directive("markers",["$log","$rootScope","$q","leafletData","leafletHelpers","leafletMapDefaults","leafletMarkersHelpers","leafletMarkerEvents","leafletIterators","leafletWatchHelpers","leafletDirectiveControlsHelpers",function(e,t,n,a,r,o,i,l,s,u,c){var d=r.isDefined,p=r.errorHeader,f=r,g=r.isString,m=i.addMarkerWatcher,v=i.updateMarker,h=i.listenMarkerEvents,y=i.addMarkerToGroup,b=i.createMarker,w=i.deleteMarker,D=s,k=r.watchOptions,x=u.maybeWatch,S=c.extend,$=function(e,t,n){if(Object.keys(e).length){if(n&&g(n)){if(!e[n]||!Object.keys(e[n]).length)return;return e[n][t]}return e[t]}},C=function(e,t,n,a){return a&&g(a)?(d(t[a])||(t[a]={}),t[a][n]=e):t[n]=e,e},M=function(t,n,a,r,o,i){if(!g(t))return e.error(p+" A layername must be a string"),!1;if(!d(n))return e.error(p+" You must add layers to the directive if the markers are going to use this functionality."),!1;if(!d(n.overlays)||!d(n.overlays[t]))return e.error(p+' A marker can only be added to a layer of type "group"'),!1;var l=n.overlays[t];return l instanceof L.LayerGroup||l instanceof L.FeatureGroup?(l.addLayer(r),!o&&i.hasLayer(r)&&!0===a.focus&&r.openPopup(),!0):(e.error(p+' Adding a marker to an overlay needs a overlay of the type "group" or "featureGroup"'),!1)},T=function(t,n,a,r,o,i,s,u,c,g){for(var L in n)if(!g[L])if(-1===L.search("-")){var w=f.copy(n[L]),D=f.getObjectDotPath(c?[c,L]:[L]),k=$(i,L,c);if(d(k)){var x=d(x)?a[L]:void 0;v(w,x,k,D,s,o,r)}else{var S=b(w),T=(w?w.layer:void 0)||c;if(!d(S)){e.error(p+" Received invalid data on the marker "+L+".");continue}if(C(S,i,L,c),d(w.message)&&S.bindPopup(w.message,w.popupOptions),d(w.group)){var A=d(w.groupOption)?w.groupOption:null;y(S,w.group,A,r)}if(f.LabelPlugin.isLoaded()&&d(w.label)&&d(w.label.message)&&S.bindLabel(w.label.message,w.label.options),d(w)&&(d(w.layer)||d(c))){if(!M(T,o,w,S,u.individual.doWatch,r))continue}else d(w.group)||(r.addLayer(S),u.individual.doWatch||!0!==w.focus||S.openPopup());u.individual.doWatch&&m(S,D,s,o,r,u.individual.isDeep),h(S,w,s,u.individual.doWatch,r),l.bindEvents(t,S,D,w,s,T)}}else e.error('The marker can\'t use a "-" on his key name: "'+L+'".')},A=function(t,n,a,r,o){var i,l,s=!1,u=!1,c=d(n);for(var g in a)s||(e.debug(p+"[markers] destroy: "),s=!0),c&&(l=t[g],i=n[g],u=angular.equals(l,i)&&r),d(t)&&Object.keys(t).length&&d(t[g])&&Object.keys(t[g]).length&&!u||o&&f.isFunction(o)&&o(l,i,g)},P=function(t,n,a,r,o){A(t,n,a,!1,function(t,n,i){e.debug(p+"[marker] is deleting marker: "+i),w(a[i],r,o),delete a[i]})},H=function(t,n,a){var r={};return A(t,n,a,!0,function(t,n,a){e.debug(p+"[marker] is already rendered, marker: "+a),r[a]=t}),r};return{restrict:"A",scope:!1,replace:!1,require:["leaflet","?layers"],link:function(e,t,r,o){var i=o[0],l=i.getLeafletScope();i.getMap().then(function(e){var t,i={};t=d(o[1])?o[1].getLayers:function(){var e=n.defer();return e.resolve(),e.promise};var s=l.markersWatchOptions||k;d(r.watchMarkers)&&(s.doWatch=s.individual.doWatch=!d(r.watchMarkers)||f.isTruthy(r.watchMarkers));var u=d(r.markersNested)&&f.isTruthy(r.markersNested);t().then(function(t){var n=function(n,a){u?D.each(n,function(n,r){var o=d(o)?a[r]:void 0;P(n,o,i[r],e,t)}):P(n,a,i,e,t)},o=function(a,o){n(a,o);var c=null;u?D.each(a,function(n,u){var p=d(p)?o[u]:void 0;c=H(a[u],p,i[u]),T(r.id,n,o,e,t,i,l,s,u,c)}):(c=H(a,o,i),T(r.id,a,o,e,t,i,l,s,void 0,c))};S(r.id,"markers",o,n),a.setMarkers(i,r.id),x(l,"markers",s,function(e,t){o(e,t)})})})}}}]),angular.module("leaflet-directive").directive("maxbounds",["$log","leafletMapDefaults","leafletBoundsHelpers","leafletHelpers",function(e,t,n,a){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,t,r,o){var i=o.getLeafletScope(),l=n.isValidBounds,s=a.isNumber;o.getMap().then(function(e){i.$watch("maxbounds",function(t){if(l(t)){var a=n.createLeafletBounds(t);s(t.pad)&&(a=a.pad(t.pad)),e.setMaxBounds(a),r.center||r.lfCenter||e.fitBounds(a)}else e.setMaxBounds()})})}}}]),angular.module("leaflet-directive").directive("paths",["$log","$q","leafletData","leafletMapDefaults","leafletHelpers","leafletPathsHelpers","leafletPathEvents",function(e,t,n,a,r,o,i){return{restrict:"A",scope:!1,replace:!1,require:["leaflet","?layers"],link:function(l,s,u,c){var d=c[0],p=r.isDefined,f=r.isString,g=d.getLeafletScope(),m=g.paths,v=o.createPath,h=i.bindPathEvents,y=o.setPathOptions;d.getMap().then(function(o){var i,l=a.getDefaults(u.id);i=p(c[1])?c[1].getLayers:function(){var e=t.defer();return e.resolve(),e.promise},p(m)&&i().then(function(t){var a={};n.setPaths(a,u.id);var i=!p(u.watchPaths)||"true"===u.watchPaths,s=function(e,n){var a=g.$watch('paths["'+n+'"]',function(n,r){if(!p(n)){if(p(r.layer))for(var i in t.overlays){t.overlays[i].removeLayer(e)}return o.removeLayer(e),void a()}y(e,n.type,n)},!0)};g.$watchCollection("paths",function(n){for(var c in a)p(n[c])||(o.removeLayer(a[c]),delete a[c]);for(var d in n)if(0!==d.search("\\$"))if(-1===d.search("-")){if(!p(a[d])){var m=n[d],b=v(d,n[d],l);if(p(b)&&p(m.message)&&b.bindPopup(m.message,m.popupOptions),r.LabelPlugin.isLoaded()&&p(m.label)&&p(m.label.message)&&b.bindLabel(m.label.message,m.label.options),p(m)&&p(m.layer)){if(!f(m.layer)){e.error("[AngularJS - Leaflet] A layername must be a string");continue}if(!p(t)){e.error("[AngularJS - Leaflet] You must add layers to the directive if the markers are going to use this functionality.");continue}if(!p(t.overlays)||!p(t.overlays[m.layer])){e.error('[AngularJS - Leaflet] A path can only be added to a layer of type "group"');continue}var w=t.overlays[m.layer];if(!(w instanceof L.LayerGroup||w instanceof L.FeatureGroup)){e.error('[AngularJS - Leaflet] Adding a path to an overlay needs a overlay of the type "group" or "featureGroup"');continue}a[d]=b,w.addLayer(b),i?s(b,d):y(b,m.type,m)}else p(b)&&(a[d]=b,o.addLayer(b),i?s(b,d):y(b,m.type,m));h(u.id,b,d,m,g)}}else e.error('[AngularJS - Leaflet] The path name "'+d+'" is not valid. It must not include "-" and a number.')})})})}}}]),angular.module("leaflet-directive").directive("tiles",["$log","leafletData","leafletMapDefaults","leafletHelpers",function(e,t,n,a){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(r,o,i,l){var s=a.isDefined,u=l.getLeafletScope(),c=u.tiles;s(c)&&s(c.url)?l.getMap().then(function(e){var a,r=n.getDefaults(i.id);u.$watch("tiles",function(n,o){var l=r.tileLayerOptions,u=r.tileLayer;if(s(n.url)||!s(a))return s(a)?!s(n.url)||!s(n.options)||n.type===o.type&&angular.equals(n.options,l)?void(s(n.url)&&a.setUrl(n.url)):(e.removeLayer(a),l=r.tileLayerOptions,angular.copy(n.options,l),u=n.url,(a="wms"===n.type?L.tileLayer.wms(u,l):L.tileLayer(u,l)).addTo(e),void t.setTiles(a,i.id)):(s(n.options)&&angular.copy(n.options,l),s(n.url)&&(u=n.url),(a="wms"===n.type?L.tileLayer.wms(u,l):L.tileLayer(u,l)).addTo(e),void t.setTiles(a,i.id));e.removeLayer(a)},!0)}):e.warn("[AngularJS - Leaflet] The 'tiles' definition doesn't have the 'url' property.")}}}]),["markers","geojson"].forEach(function(e){angular.module("leaflet-directive").directive(e+"WatchOptions",["$log","$rootScope","$q","leafletData","leafletHelpers",function(t,n,a,r,o){var i=o.isDefined,l=o.errorHeader,s=o.isObject,u=o.watchOptions;return{restrict:"A",scope:!1,replace:!1,require:["leaflet"],link:function(n,a,r,o){var c=o[0],d=c.getLeafletScope();c.getMap().then(function(){i(n[e+"WatchOptions"])&&(s(n[e+"WatchOptions"])?angular.extend(u,n[e+"WatchOptions"]):t.error(l+"["+e+"WatchOptions] is not an object"),d[e+"WatchOptions"]=u)})}}}])}),angular.module("leaflet-directive").factory("LeafletEventsHelpersFactory",["$rootScope","$q","$log","leafletHelpers",function(e,t,n,a){var r=a.safeApply,o=a.isDefined,i=a.isObject,l=a.isArray,s=a.errorHeader,u=function(e,t){this.rootBroadcastName=e,n.debug("LeafletEventsHelpersFactory: lObjectType: "+t+"rootBroadcastName: "+e),this.lObjectType=t};return u.prototype.getAvailableEvents=function(){return[]},u.prototype.genDispatchEvent=function(e,t,n,a,r,o,i,l,s){var u=this;return(e=e||"")&&(e="."+e),function(c){var d=u.rootBroadcastName+e+"."+t;u.fire(a,d,n,c,c.target||r,i,o,l,s)}},u.prototype.fire=function(t,n,a,i,l,s,u,c){r(t,function(){var r={leafletEvent:i,leafletObject:l,modelName:u,model:s};o(c)&&angular.extend(r,{layerName:c}),"emit"===a?t.$emit(n,r):e.$broadcast(n,r)})},u.prototype.bindEvents=function(e,t,a,r,u,c,d){var p=[],f=this;if(o(u.eventBroadcast))if(i(u.eventBroadcast))if(o(u.eventBroadcast[f.lObjectType]))if(i(u.eventBroadcast[f.lObjectType])){o(u.eventBroadcast[this.lObjectType].logic)&&"emit"!==u.eventBroadcast[f.lObjectType].logic&&"broadcast"!==u.eventBroadcast[f.lObjectType].logic&&n.warn(s+"Available event propagation logic are: 'emit' or 'broadcast'.");var g=!1,m=!1;o(u.eventBroadcast[f.lObjectType].enable)&&l(u.eventBroadcast[f.lObjectType].enable)&&(g=!0),o(u.eventBroadcast[f.lObjectType].disable)&&l(u.eventBroadcast[f.lObjectType].disable)&&(m=!0),g&&m?n.warn(s+"can not enable and disable events at the same time"):g||m?g?u.eventBroadcast[this.lObjectType].enable.forEach(function(e){-1!==p.indexOf(e)?n.warn(s+"This event "+e+" is already enabled"):-1===f.getAvailableEvents().indexOf(e)?n.warn(s+"This event "+e+" does not exist"):p.push(e)}):(p=this.getAvailableEvents(),u.eventBroadcast[f.lObjectType].disable.forEach(function(e){var t=p.indexOf(e);-1===t?n.warn(s+"This event "+e+" does not exist or has been already disabled"):p.splice(t,1)})):n.warn(s+"must enable or disable events")}else n.warn(s+"event-broadcast."+[f.lObjectType]+" must be an object check your model.");else p=this.getAvailableEvents();else n.error(s+"event-broadcast must be an object check your model.");else p=this.getAvailableEvents();return p.forEach(function(n){t.on(n,f.genDispatchEvent(e,n,"emit",u,t,a,r,c,d))}),"emit"},u}]).service("leafletEventsHelpers",["LeafletEventsHelpersFactory",function(e){return new e}]),angular.module("leaflet-directive").factory("leafletGeoJsonEvents",["$rootScope","$q","$log","leafletHelpers","LeafletEventsHelpersFactory","leafletData",function(e,t,n,a,r,o){var i=a.safeApply,l=r,s=function(){l.call(this,"leafletDirectiveGeoJson","geojson")};return(s.prototype=new l).genDispatchEvent=function(t,n,a,r,s,u,c,d,p){var f=l.prototype.genDispatchEvent.call(this,t,n,a,r,s,u,c,d),g=this;return function(t){"mouseout"===n&&(p.resetStyleOnMouseout&&o.getGeoJSON(p.mapId).then(function(e){(d?e[d]:e).resetStyle(t.target)}),i(r,function(){e.$broadcast(g.rootBroadcastName+".mouseout",t)})),f(t)}},s.prototype.getAvailableEvents=function(){return["click","dblclick","mouseover","mouseout"]},new s}]),angular.module("leaflet-directive").factory("leafletLabelEvents",["$rootScope","$q","$log","leafletHelpers","LeafletEventsHelpersFactory",function(e,t,n,a,r){var o=a,i=r,l=function(){i.call(this,"leafletDirectiveLabel","markers")};return(l.prototype=new i).genDispatchEvent=function(e,t,n,a,r,o,l,s){var u=o.replace("markers.","");return i.prototype.genDispatchEvent.call(this,e,t,n,a,r,u,l,s)},l.prototype.getAvailableEvents=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu"]},l.prototype.genEvents=function(e,t,n,a,r,i,l,s){var u=this,c=this.getAvailableEvents(),d=o.getObjectArrayPath("markers."+i);c.forEach(function(t){r.label.on(t,u.genDispatchEvent(e,t,n,a,r.label,d,l,s))})},l.prototype.bindEvents=function(){},new l}]),angular.module("leaflet-directive").factory("leafletMapEvents",["$rootScope","$q","$log","leafletHelpers","leafletEventsHelpers","leafletIterators",function(e,t,n,a,r,o){var i=a.isDefined,l=r.fire,s=function(e,t,n,a){return a&&(a+="."),function(r){l(e,"leafletDirectiveMap."+a+t,n,r,r.target,e)}};return{getAvailableMapEvents:function(){return["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","contextmenu","focus","blur","preclick","load","unload","viewreset","movestart","move","moveend","dragstart","drag","dragend","zoomstart","zoomanim","zoomend","zoomlevelschange","resize","autopanstart","layeradd","layerremove","baselayerchange","overlayadd","overlayremove","locationfound","locationerror","popupopen","popupclose","draw:created","draw:edited","draw:deleted","draw:drawstart","draw:drawstop","draw:editstart","draw:editstop","draw:deletestart","draw:deletestop"]},genDispatchMapEvent:s,notifyCenterChangedToBounds:function(e){e.$broadcast("boundsChanged")},notifyCenterUrlHashChanged:function(e,t,n,a){if(i(n.urlHashCenter)){var r=t.getCenter(),o=r.lat.toFixed(4)+":"+r.lng.toFixed(4)+":"+t.getZoom();i(a.c)&&a.c===o||e.$emit("centerUrlHash",o)}},addEvents:function(e,t,n,a,r){o.each(t,function(t){var o={};o[n]=t,e.on(t,s(a,t,r,e._container.id||""),o)})}}}]),angular.module("leaflet-directive").factory("leafletMarkerEvents",["$rootScope","$q","$log","leafletHelpers","LeafletEventsHelpersFactory","leafletLabelEvents",function(e,t,n,a,r,o){var i=a.safeApply,l=a.isDefined,s=a,u=o,c=r,d=function(){c.call(this,"leafletDirectiveMarker","markers")};return(d.prototype=new c).genDispatchEvent=function(t,n,a,r,o,l,s,u){var d=c.prototype.genDispatchEvent.call(this,t,n,a,r,o,l,s,u);return function(t){"click"===n?i(r,function(){e.$broadcast("leafletDirectiveMarkersClick",l)}):"dragend"===n&&(i(r,function(){s.lat=o.getLatLng().lat,s.lng=o.getLatLng().lng}),s.message&&!0===s.focus&&o.openPopup()),d(t)}},d.prototype.getAvailableEvents=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu","dragstart","drag","dragend","move","remove","popupopen","popupclose","touchend","touchstart","touchmove","touchcancel","touchleave"]},d.prototype.bindEvents=function(e,t,n,a,r,o){var i=c.prototype.bindEvents.call(this,e,t,n,a,r,o);s.LabelPlugin.isLoaded()&&l(t.label)&&u.genEvents(e,n,i,r,t,a,o)},new d}]),angular.module("leaflet-directive").factory("leafletPathEvents",["$rootScope","$q","$log","leafletHelpers","leafletLabelEvents","leafletEventsHelpers",function(e,t,n,a,r,o){var i=a.isDefined,l=a.isObject,s=a,u=a.errorHeader,c=r,d=o.fire,p=function(e,t,n,a,r,o,i,l){return(e=e||"")&&(e="."+e),function(s){d(a,"leafletDirectivePath"+e+"."+t,n,s,s.target||r,i,o,l)}},f=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu","add","remove","popupopen","popupclose"]};return{getAvailablePathEvents:f,bindPathEvents:function(e,t,a,r,o){var d,g,m=[],v="broadcast";if(i(o.eventBroadcast))if(l(o.eventBroadcast))if(i(o.eventBroadcast.path))if(l(o.eventBroadcast.paths))n.warn(u+"event-broadcast.path must be an object check your model.");else{void 0!==o.eventBroadcast.path.logic&&null!==o.eventBroadcast.path.logic&&("emit"!==o.eventBroadcast.path.logic&&"broadcast"!==o.eventBroadcast.path.logic?n.warn(u+"Available event propagation logic are: 'emit' or 'broadcast'."):"emit"===o.eventBroadcast.path.logic&&(v="emit"));var h=!1,y=!1;if(void 0!==o.eventBroadcast.path.enable&&null!==o.eventBroadcast.path.enable&&"object"==typeof o.eventBroadcast.path.enable&&(h=!0),void 0!==o.eventBroadcast.path.disable&&null!==o.eventBroadcast.path.disable&&"object"==typeof o.eventBroadcast.path.disable&&(y=!0),h&&y)n.warn(u+"can not enable and disable events at the same time");else if(h||y)if(h)for(d=0;d<o.eventBroadcast.path.enable.length;d++)g=o.eventBroadcast.path.enable[d],-1!==m.indexOf(g)?n.warn(u+"This event "+g+" is already enabled"):-1===f().indexOf(g)?n.warn(u+"This event "+g+" does not exist"):m.push(g);else for(m=f(),d=0;d<o.eventBroadcast.path.disable.length;d++){g=o.eventBroadcast.path.disable[d];var b=m.indexOf(g);-1===b?n.warn(u+"This event "+g+" does not exist or has been already disabled"):m.splice(b,1)}else n.warn(u+"must enable or disable events")}else m=f();else n.error(u+"event-broadcast must be an object check your model.");else m=f();for(d=0;d<m.length;d++)g=m[d],t.on(g,p(e,g,v,o,m,a));s.LabelPlugin.isLoaded()&&i(t.label)&&c.genEvents(e,a,v,o,t,r)}}}])}(angular),function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("angular")):"function"==typeof define&&define.amd?define(["angular"],t):t(e.angular)}(window,function(e){e.module("emixApp.directives").directive("angucompleteAlt",["$q","$parse","$http","$sce","$timeout","$templateCache","$interpolate",function(e,t,n,a,r,o,i){var l=40,s=39,u=38,c=37,d=27,p=13,f=9,g=3,m=524288,v=500,h=200,y="autocomplete-required",b="common.searching",L="common.noRecordFound";function w(t,o,i,w){var D,k,x,S,$,C,M=o.find("input"),T=g,A=null,P=y,H=null,O=null,E=!1,V=o[0].querySelector(".angucomplete-dropdown"),F=!1,I=null;function N(e,n){e&&("object"==typeof e?(t.searchStr=z(e),R({originalObject:e})):"string"==typeof e&&e.length>0?t.searchStr=e:console&&console.error&&console.error("Tried to set "+(n?"initial":"")+" value of angucomplete to",e,"which is an invalid value"),G(!0))}function B(e){I=null,t.hideResults(e),document.body.removeEventListener("click",B)}function j(e){return e.which?e.which:e.keyCode}function R(e){"function"==typeof t.selectedObject?t.selectedObject(e,t.selectedObjectData):t.selectedObject=e,G(!!e)}function z(e){return t.titleField.split(",").map(function(t){return q(e,t)}).join(" ")}function q(e,t){var n,a;if(t){n=t.split("."),a=e;for(var r=0;r<n.length;r++)a=a[n[r]]}else a=e;return a}function U(e,n){var r,o,i;if(i=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i"),e)return e.match&&e.replace||(e=e.toString()),r=(o=e.match(i))?e.replace(i,'<span class="'+t.matchClass+'">'+o[0]+"</span>"):e,a.trustAsHtml(r)}function G(e){t.notEmpty=e,H=t.searchStr,t.fieldRequired&&w&&t.inputName&&w[t.inputName].$setValidity(P,e)}function _(e){var n=j(e);if(n!==c&&n!==s)if(n===u||n===p)e.preventDefault();else if(n===l)e.preventDefault(),!t.showDropdown&&t.searchStr&&t.searchStr.length>=T&&(ae(),t.searching=!0,re(t.searchStr));else if(n===d)ne(),t.$apply(function(){M.val(t.searchStr)});else{if(0===T&&!t.searchStr)return;t.searchStr&&""!==t.searchStr?t.searchStr.length>=T&&(ae(),A&&r.cancel(A),t.searching=!0,A=r(function(){re(t.searchStr)},t.pause)):t.showDropdown=!1,H&&H!==t.searchStr&&!t.clearSelected&&t.$apply(function(){R()})}}function J(e){!t.overrideSuggestions||"false"==t.overrideSuggestions.toLowerCase()||t.selectedObject&&t.selectedObject.originalObject===t.searchStr||(e&&e.preventDefault(),r.cancel(A),Q(),R({originalObject:t.searchStr}),t.clearSelected&&(t.searchStr=null),ne())}function W(){return o[0].querySelectorAll(".angucomplete-row")[t.currentIndex]}function Y(e){V.scrollTop=V.scrollTop+e}function Z(){var e=t.results[t.currentIndex];t.matchClass?M.val(z(e.originalObject)):M.val(e.title)}function K(e){return function(n,a,r,o){a||r||o||!n.data||(n=n.data),t.searching=!1,oe(q(k(n),t.remoteUrlDataField),e)}}function X(e,n,a,r){t.searching=E,n||a||r||(n=e.status),0!==n&&-1!==n&&(t.remoteUrlErrorCallback?t.remoteUrlErrorCallback(e,n,a,r):console&&console.error&&console.error("http error"))}function Q(){O&&O.resolve()}function ee(a){var r={},o=t.remoteUrl+encodeURIComponent(a);t.remoteUrlRequestFormatter&&(r={params:t.remoteUrlRequestFormatter(a)},o=t.remoteUrl),t.remoteUrlRequestWithCredentials&&(r.withCredentials=!0),Q(),O=e.defer(),r.timeout=O.promise,E=!0,n.get(o,r).then(K(a)).catch(X).finally(function(){E=!1})}function te(n){Q(),O=e.defer(),t.remoteApiHandler(n,O.promise).then(K(n)).catch(X)}function ne(){t.showDropdown=!1,t.results=[],V&&(V.scrollTop=0)}function ae(){t.showDropdown=S,t.currentIndex=t.focusFirst?0:-1,t.results=[]}function re(e){!e||e.length<T||(t.localData?t.$apply(function(){var n;n=void 0!==t.localSearch()?t.localSearch()(e,t.localData):function(e){var n,a,r,o,i=t.searchFields.split(","),l=[];for(void 0!==t.parseInput()&&(e=t.parseInput()(e)),n=0;n<t.localData.length;n++){for(a=!1,r=0;r<i.length;r++)o=q(t.localData[n],i[r])||"",a=a||o.toString().toLowerCase().indexOf(e.toString().toLowerCase())>=0;a&&(l[l.length]=t.localData[n])}return l}(e),t.searching=!1,oe(n,e)}):t.remoteApiHandler?te(e):ee(e))}function oe(e,n){var a,r,o,i,l,s;if(e&&e.length>0)for(t.results=[],a=0;a<e.length;a++)t.titleField&&""!==t.titleField&&(i=l=z(e[a])),r="",t.descriptionField&&(r=s=q(e[a],t.descriptionField)),o="",t.imageField&&(o=q(e[a],t.imageField)),t.matchClass&&(l=U(i,n),s=U(r,n)),t.results[t.results.length]={title:l,description:s,image:o,originalObject:e[a]};else t.results=[];t.autoMatch&&1===t.results.length&&function(e,n,a){if(!a)return!1;for(var r in n)if(n[r].toLowerCase()===a.toLowerCase())return t.selectResult(e),!0;return!1}(t.results[0],{title:i,desc:r||""},t.searchStr)?t.showDropdown=!1:0!==t.results.length||$?t.showDropdown=!0:t.showDropdown=!1}function ie(){t.localData?(t.searching=!1,oe(t.localData,"")):t.remoteApiHandler?(t.searching=!0,te("")):(t.searching=!0,ee(""))}o.on("mousedown",function(e){e.target.id?(I=e.target.id)===t.id+"_dropdown"&&document.body.addEventListener("click",B):I=e.target.className}),t.currentIndex=t.focusFirst?0:null,t.searching=!1,x=t.$watch("initialValue",function(e){e&&(x(),N(e,!0))}),t.$watch("fieldRequired",function(e,n){e!==n&&(e?H&&-1!==t.currentIndex?G(!0):G(!1):w[t.inputName].$setValidity(P,!0))}),t.$on("angucomplete-alt:clearInput",function(e,n){n&&n!==t.id||(t.searchStr=null,R(),G(!1),ne())}),t.$on("angucomplete-alt:changeInput",function(e,n,a,r){n&&n===t.id&&(r=!!r,N(a),r&&(t.inputChangeHandler(a),_({which:-1})))}),t.onFocusHandler=function(){t.focusIn&&t.focusIn(),0!==T||t.searchStr&&0!==t.searchStr.length||(t.currentIndex=t.focusFirst?0:t.currentIndex,t.showDropdown=!0,ie())},t.hideResults=function(){I&&(I===t.id+"_dropdown"||I.indexOf("angucomplete")>=0)?I=null:(D=r(function(){ne(),t.$apply(function(){t.searchStr&&t.searchStr.length>0&&M.val(t.searchStr)})},h),Q(),t.focusOut&&t.focusOut(),t.overrideSuggestions&&"false"!=t.overrideSuggestions.toLowerCase()&&t.searchStr&&t.searchStr.length>0&&t.currentIndex)},t.resetHideResults=function(){D&&r.cancel(D)},t.hoverRow=function(e){t.currentIndex=e},t.selectResult=function(e){t.matchClass&&(e.title=z(e.originalObject),e.description=q(e.originalObject,t.descriptionField)),t.clearSelected?t.searchStr=null:t.searchStr=e.title,R(e),ne()},t.inputChangeHandler=function(e){return e.length<T?(Q(),ne()):0===e.length&&0===T&&ie(),t.inputChanged&&(e=t.inputChanged(e)),e},t.fieldRequiredClass&&""!==t.fieldRequiredClass&&(P=t.fieldRequiredClass),t.minlength&&""!==t.minlength&&(T=parseInt(t.minlength,10)),t.pause||(t.pause=v),t.clearSelected||(t.clearSelected=!1),t.overrideSuggestions||(t.overrideSuggestions=!1),t.fieldRequired&&w&&(t.initialValue?G(!0):G(!1)),t.inputType=i.type?i.type:"text",t.textSearching=i.textSearching?i.textSearching:b,t.textNoResults=i.textNoResults?i.textNoResults:L,S="false"!==t.textSearching,$="false"!==t.textNoResults,t.maxlength=i.maxlength?i.maxlength:m,M.on("keydown",function(e){var n=j(e),a=null,r=null;n===p&&t.results?(1==t.results.length&&(t.currentIndex=0),t.currentIndex>=0&&t.currentIndex<t.results.length?(e.preventDefault(),t.selectResult(t.results[t.currentIndex])):(J(e),ne()),t.$apply()):n===l&&t.results?(e.preventDefault(),t.currentIndex+1<t.results.length&&t.showDropdown&&(t.$apply(function(){t.currentIndex++,Z()}),F&&(a=W(),V.getBoundingClientRect().top+parseInt(getComputedStyle(V).maxHeight,10)<a.getBoundingClientRect().bottom&&Y(function(e){var t=getComputedStyle(e);return e.offsetHeight+parseInt(t.marginTop,10)+parseInt(t.marginBottom,10)}(a))))):n===u&&t.results?(e.preventDefault(),t.currentIndex>=1?(t.$apply(function(){t.currentIndex--,Z()}),F&&(r=W().getBoundingClientRect().top-(V.getBoundingClientRect().top+parseInt(getComputedStyle(V).paddingTop,10)))<0&&Y(r-1)):0===t.currentIndex&&t.$apply(function(){t.currentIndex=-1,M.val(t.searchStr)})):n===f?t.results&&t.results.length>0&&t.showDropdown?-1===t.currentIndex&&t.overrideSuggestions&&"false"!=t.overrideSuggestions.toLowerCase()||(-1===t.currentIndex&&(t.currentIndex=0),t.selectResult(t.results[t.currentIndex]),t.$digest()):t.searchStr&&t.searchStr.length:n===d&&e.preventDefault()}),M.on("keyup compositionend",_),C="remoteUrlResponseFormatter",k=function(e){return t[C]?t[C](e):e},r(function(){var e=getComputedStyle(V);F=e.maxHeight&&"auto"===e.overflowY})}return o.put("/angucomplete-alt/index.html",'<div class="angucomplete-holder" ng-class="{\'angucomplete-dropdown-visible\': showDropdown}">  <input id="{{id}}_value" name="{{inputName}}" tabindex="{{fieldTabindex}}" ng-class="{\'angucomplete-input-not-empty\': notEmpty}" ng-model="searchStr" ng-disabled="disableInput" type="{{inputType}}" placeholder="{{placeholder}}" maxlength="{{maxlength}}" ng-focus="onFocusHandler()" class="{{inputClass}}" ng-focus="resetHideResults()" ng-blur="hideResults($event)" autocapitalize="off" autocorrect="off" autocomplete="off" ng-change="inputChangeHandler(searchStr)"/>  <div id="{{id}}_dropdown" class="angucomplete-dropdown" ng-show="showDropdown">    <div class="angucomplete-searching" ng-show="searching" ng-bind="textSearching | translate"></div>    <div class="angucomplete-searching" ng-show="!searching && (!results || results.length == 0)" ng-bind="textNoResults | translate"></div>    <div class="angucomplete-row" ng-repeat="result in results" ng-click="selectResult(result)" ng-mouseenter="hoverRow($index)" ng-class="{\'angucomplete-selected-row\': $index == currentIndex}">      <div ng-if="imageField" class="angucomplete-image-holder">        <img ng-if="result.image && result.image != \'\'" ng-src="{{result.image}}" class="angucomplete-image"/>        <div ng-if="!result.image && result.image != \'\'" class="angucomplete-image-default"></div>      </div>      <div class="angucomplete-title" ng-if="matchClass" ng-bind-html="result.title"></div>      <div class="angucomplete-title" ng-if="!matchClass">{{ result.title }}</div>      <div ng-if="matchClass && result.description && result.description != \'\'" class="angucomplete-description" ng-bind-html="result.description"></div>      <div ng-if="!matchClass && result.description && result.description != \'\'" class="angucomplete-description">{{result.description}}</div>    </div>  </div></div>'),{restrict:"EA",require:"^?form",scope:{selectedObject:"=",selectedObjectData:"=",disableInput:"=",initialValue:"=",localData:"=",localSearch:"&",remoteUrlRequestFormatter:"=",remoteUrlRequestWithCredentials:"@",remoteUrlResponseFormatter:"=",remoteUrlErrorCallback:"=",remoteApiHandler:"=",id:"@",type:"@",placeholder:"@",textSearching:"@",textNoResults:"@",remoteUrl:"@",remoteUrlDataField:"@",titleField:"@",descriptionField:"@",imageField:"@",inputClass:"@",pause:"@",searchFields:"@",minlength:"@",matchClass:"@",clearSelected:"@",overrideSuggestions:"@",fieldRequired:"=",fieldRequiredClass:"@",inputChanged:"=",autoMatch:"@",focusOut:"&",focusIn:"&",fieldTabindex:"@",inputName:"@",focusFirst:"@",parseInput:"&"},templateUrl:function(e,t){return t.templateUrl||"/angucomplete-alt/index.html"},compile:function(e){var t=i.startSymbol(),n=i.endSymbol();if("{{"!==t||"}}"!==n){var a=e.html().replace(/\{\{/g,t).replace(/\}\}/g,n);e.html(a)}return w}}}])}),angular.module("emixApp.directives").directive("ngDataTable",["$compile","$rootScope","$sce","$filter","PagerService","httpServices","$http","orderByFilter","sharedInfo","shareFunc","$templateRequest","$templateCache","$timeout","$translate",function(e,t,n,a,r,o,i,l,s,u,c,d,p,f){return{scope:{options:"=",dtData:"=",dtCols:"=",additionalData:"=",events:"="},link:function(n,g,m){n.dataTemplate="/panelshare/directives/datatable/table-template.html"+t.version;var v=g.html().trim();if(v&&v.length>0){var h=(n.options.id||"dtable")+"-custom-template.html"+t.version,y='<div ng-if="items.length >= 1" ng-repeat="data in items" class="'+n.options.rowClass+'" ng-class="{'+n.options.rowNgClass+'}">\n'+v+"</div>\n<div class=\"info-box notfoundbx\" ng-class=\"{'tblldngmd': loadingMode}\" ng-if=\"items.length === 0\">\n   {{ loadingMode ? ('loading' | translate) : ('common.noRecordFound' | translate)}}\n</div>";d.put(h,y),n.dataTemplate=h,g.empty()}c("/panelshare/directives/datatable/template.html"+t.version).then(function(t){var a=angular.element(t);g.append(a),e(a)(n)}),n.loadingMode=!1;var b=function(){var e=[];return n.dtCols.forEach(function(t,a){if(!1!==t.allowExport&&t.name&&t.name.length>0){var r=t.title?f.instant(t.title):t.headerTemplate?function(e){var t=$("#"+n.options.id).find('[data-colname="'+e.name+'"]');return 1===t.length?t.text():e.name}(t):"",o=t.name;e.push({caption:r,key:o})}}),e},L=function(e){switch(e.dataType){case s.dataType.int:case s.dataType.bool:case s.dataType.list:case s.dataType.date:return" = ";case s.dataType.string:return" like ";default:return" = "}},w=function(e){let t=(void 0!==e.filterText?e.filterText:"").toString().trim();return e.unFormatFilterText&&(t=e.unFormatFilterText(t)),t},D=function(e){const t={resultCount:!!e,sortOptions:n.options.propertyName?n.options.propertyName+"="+(n.options.reverse?"desc":"asc"):null};let a;var r=function(e){return e?{start:(e-1)*n.options.pageSize,count:n.options.pageSize}:{}}(e);for(a in r)r.hasOwnProperty(a)&&(t[a]=r[a]);for(a in n.options.apiParams){var o=n.options.apiParams[a]||"";n.options.apiParams.hasOwnProperty(a)&&"undefined"!==o&&void 0!==o&&("string"!=typeof o||o.length>0)&&(t[a]=n.options.apiParams[a])}var i=function(){for(var e="",t=0;t<(n.dtCols||[]).length;t++){var a=n.dtCols[t],r=w(a);a.filterable&&!a.isGlobalFilterParam&&r.length>0&&"undefined"!==r&&(e.length>0&&(e+=","),e+=a.keyName+L(a)+r)}return e}();i.length>0&&(t.prm=i);var l=function(){for(var e=[],t=0;t<(n.dtCols||[]).length;t++){var a=n.dtCols[t],r=a.filterText||"";a.filterable&&a.isGlobalFilterParam&&r.length>0&&"undefined"!==r&&(e[a.keyName]=a.filterText)}return e}();for(a in l)t[a]=l[a];return t};n.$watch("dtData",function(e,t){n.serverSideMode||(n.dummyItems=e||[],n.dummyItems=a("filter")(n.dummyItems,n.bzquery),0===(t||[]).length&&n.restoreState(),n.setPage(n.options.pageNum))}),n.events.setPage=function(e){n.setPage(e)},n.events.export=function(){var e={headers:b(),fileName:"ExportExcel"};if(n.serverSideMode)NProgress.start(),$.blockUI(),S().then(function(t){var n=t.data;e.data=n.returnObject.result,u.downloadXLS(e)},function(e){o.handleError(e.data,e.status,e.headers,e.config)}).finally(function(){NProgress.done(),$.unblockUI()});else{var t=a("filter")(n.dummyItems,n.bzquery);e.data=l(t,k(),n.options.reverse),u.downloadXLS(e)}},n.events.filter=function(){n.events.dataBind()},n.events.dataBind=function(){n.setPage(1)},n.onRowClick=function(e){n.events.onRowClick&&n.events.onRowClick(e)},n.onRowDblClick=function(e){n.events.onRowDblClick&&n.events.onRowDblClick(e)},n.storeState=function(){if(n.options.saveState){var e={};e.propertyName=n.options.propertyName,e.reverse=n.options.reverse||!1,e.pageSize=n.options.pageSize||10,e.pageNum=n.options.pageNum,s.setState(n.options.id,e)}},n.restoreState=function(){if(n.options.saveState){var e=s.getState(n.options.id);e&&(n.options.propertyName=e.propertyName,n.options.reverse=e.reverse||!1,n.options.pageSize=e.pageSize||10,n.options.pageNum=e.pageNum)}};var k=function(){var e=[];return n.options.propertyName&&(e.push(n.options.propertyName),n.options.additionalSortFieldName&&e.push(n.options.additionalSortFieldName)),e};n.clearSort=function(){n.options.reverse=!1,n.options.propertyName=null,n.setPage(1)};var x=function(){n.dummyItems=n.dtData;var e=function(){for(var e={},t=0;t<(n.dtCols||[]).length;t++){var a=n.dtCols[t],r=w(a);a.filterable&&r.length>0&&"undefined"!==r&&(e[a.keyName]=r)}return e}();jQuery.isEmptyObject(e)||(n.dummyItems=a("filter")(n.dummyItems,e))};n.search=function(){n.setPage(1)},n.pageSizeList=[5,10,15,20,25,30,50],n.pageSizeChange=function(){n.setPage(1)};var S=function(e){return i({method:"GET",url:n.options.apiUrl,params:D(e),cache:!1,headers:o.getHeaders()})};n.setPage=function(e){if(n.serverSideMode)n.loadingMode=!0,S(e).then(function(t){var a=t.data,o=a.returnObject.result,i=a.returnObject.resultCount,l=i>0?Math.ceil(i/n.options.pageSize):0;n.options.pageNum=e>l&&l>0?l:e,n.pager=r.GetPager(i,n.options.pageNum,n.options.pageSize),n.dummyItems=o,n.items=o},function(e){o.handleError(e.data,e.status,e.headers,e.config)}).finally(function(){n.loadingMode=!1});else{x();var t=n.dummyItems.length>0?Math.ceil(n.dummyItems.length/n.options.pageSize):0;n.options.pageNum=e>t&&t>0?t:e,n.pager=r.GetPager(n.dummyItems.length,n.options.pageNum,n.options.pageSize),n.dummyItems=l(n.dummyItems,k(),n.options.reverse),n.items=n.dummyItems.slice(n.pager.startIndex,n.pager.endIndex+1)}n.storeState()},p(function(){n.options.id=n.options.id||"dtable",n.options.propertyName=n.options.propertyName||null,n.options.additionalSortFieldName=n.options.additionalSortFieldName||null,n.options.reverse=u.getBoolDefaultValue(n.options.reverse,!1),n.options.saveState=u.getBoolDefaultValue(n.options.saveState,!1),n.options.allowFilter=u.getBoolDefaultValue(n.options.allowFilter,!0),n.options.mobileSearchActive=u.getBoolDefaultValue(n.options.mobileSearchActive,!1),n.options.allowExport=u.getBoolDefaultValue(n.options.allowExport,!0),n.options.pageSize=n.options.pageSize||10,n.options.pageNum=n.options.pageNum||1,n.options.panelHeight=n.options.panelHeight||300,n.options.textSearching=n.options.textSearching||"common.searching",n.options.textNoResults=n.options.textNoResults||"common.noRecordFound",n.options.clearSort=function(){n.clearSort()},n.dtData=n.dtData||[],n.dtCols=n.dtCols||[],n.options.apiUrl=n.options.apiUrl||"",n.options.apiParams=n.options.apiParams||{},n.serverSideMode=n.options.apiUrl.length>0,n.serverSideMode&&n.events.dataBind()})}}}]),angular.module("emixApp.directives").directive("ngDataTableHeader",["$compile","$rootScope","$http","httpServices","$templateRequest","shareFunc","$timeout","sharedInfo",function(e,t,n,a,r,o,i,l){return{scope:{headerOptions:"=",options:"=",additionalData:"=",events:"=",isCommandCol:"=",serverSideMode:"="},link:function(s,u,c){s.filterListResult=[];i(function(){s.serverSideMode=s.options.apiUrl.length>0,s.isMobile=$("body").hasClass("mbdy"),s.isCommandCol=o.getBoolDefaultValue(s.isCommandCol,!1);var i=(s.headerOptions.cellTemplate||"").length>0;if(s.headerOptions.filterControlClass=s.headerOptions.filterControlClass||"",s.headerOptions.filterable=o.getBoolDefaultValue(s.headerOptions.filterable,!i||s.serverSideMode),s.headerOptions.isGlobalFilterParam=o.getBoolDefaultValue(s.headerOptions.isGlobalFilterParam,!1),s.headerOptions.filterListKey=s.headerOptions.filterListKey||"id",s.headerOptions.filterListValue=s.headerOptions.filterListValue||"name",s.headerOptions.dataType=s.headerOptions.dataType||l.dataType.string,s.headerOptions.keyName=s.headerOptions.keyName||s.headerOptions.name,s.headerOptions.filterable&&s.headerOptions.dataType===l.dataType.list&&("string"==typeof s.headerOptions.filterList?n({method:"GET",url:s.headerOptions.filterList,params:{},cache:!1,headers:a.getHeaders()}).then(function(e){var t=e.data;s.headerOptions.filterList=t.returnObject,d()},function(e){a.handleError(e.data,e.status,e.headers,e.config)}).finally(function(){}):d()),s.headerOptions.headerTemplate){var c=$(s.headerOptions.headerTemplate);c.attr("data-colname",s.headerOptions.name);var p=e(c.prop("outerHTML"))(s);$(u).append(p)}else r("/panelshare/directives/datatable/header-template.html"+t.version).then(function(t){var n=angular.element(t);u.append(n),e(n)(s)})});var d=function(){var e={};e[s.headerOptions.filterListKey]="",e[s.headerOptions.filterListValue]="----------",s.filterListResult=s.headerOptions.filterList||[],s.filterListResult.unshift(e),s.headerOptions.filterText=""};s.sortBy=function(e,t){t&&(s.options.propertyName===e&&s.options.reverse?s.options.propertyName=null:(s.options.reverse=s.options.propertyName===e&&!s.options.reverse,s.options.propertyName=e),s.events.setPage(1))},s.export=function(){s.events.export()},s.filter=function(){s.events.filter()},s.toggleMobileSearchActive=function(){s.options.mobileSearchActive=!s.options.mobileSearchActive}}}}]),angular.module("emixApp.directives").directive("ngDataTableCell",["$compile","$rootScope","$sce","$templateCache",function(e,t,n,a){return{scope:{cellOptions:"=",data:"=",additionalData:"=",events:"="},link:function(t,n,a){if(t.getDataValue=function(e,n){var a=e;if(!n)return"";for(var r=n.split("."),o=0;o<r.length;o++)a=a[r[o]];return t.cellOptions.formatValue?t.cellOptions.formatValue(a):a},t.cellOptions.cellTemplate){var r=t.cellOptions.cellTemplate,o=e(r)(t);$(n).append(o)}else{r=t.getDataValue(t.data,t.cellOptions.name);$(n).append(r)}}}}]),angular.module("emixApp.directives").directive("ngSaveState",["sharedInfo","shareFunc","$rootScope",function(e,t,n){return{require:"ngModel",scope:{ngModel:"=",afterRestoreSavedState:"&"},link:function(a,r,o,i){if(!(null!==o.disableSaveState&&void 0!==o.disableSaveState&&t.getBoolDefaultValue(o.disableSaveState))){a.validStorageName=null!==o.ngSaveState&&void 0!==o.ngSaveState&&o.ngSaveState.length>0,a.storageName=n.currentLang+"_"+o.ngSaveState;var l=!0;a.$watch("ngModel",function(e,t){l&&a.validStorageName?(a.restoreState(),l=!1):a.validStorageName&&a.storeState()}),a.storeState=function(){e.setState(a.storageName,a.ngModel)},a.restoreState=function(){var t=e.getState(a.storageName);t&&(a.ngModel=t,a.afterRestoreSavedState&&a.afterRestoreSavedState())}}}}}]),angular.module("emixApp.directives").directive("ngSwitchBox",function(){return{restrict:"AE",replace:!0,transclude:!0,template:function(e,t){var n="";return n+='<div class="ngswitchboxcontainer'+(t.containerclass?" "+t.containerclass:"")+'">',n+='<span class="ngswitchboxtext">',n+=t.text,n+="</span>",n+="<span",n+=' class="ngswitchbox'+(t.class?" "+t.class:"")+'"',n+=t.ngModel?' ng-click="'+t.disabled+" ? "+t.ngModel+" : "+t.ngModel+"=!"+t.ngModel+(t.ngChange?"; "+t.ngChange+'()"':'"'):"",n+=' ng-class="{ checked:'+t.ngModel+", disabled:"+t.disabled+' }"',n+=">",n+="<small></small>",n+='<input type="checkbox"',n+=t.id?' id="'+t.id+'"':"",n+=t.name?' name="'+t.name+'"':"",n+=t.ngModel?' ng-model="'+t.ngModel+'"':"",n+=' style="display:none" />',n+='<span class="ngswitchbox-text">',n+=t.on?'<span class="on">'+t.on+"</span>":"",n+=t.off?'<span class="off">'+t.off+"</span>":" ",n+="</span>",n+="</div>"}}}),angular.module("emixApp.directives").directive("accountSummery",["$rootScope",function(e){return{scope:{params:"=",events:"="},templateUrl:"/panelshare/directives/account-info/account-summery.html"+e.version,link:function(t,n,a){t.shopCurrency=e.shopCurrency,t.shopFractionSize=e.shopFractionSize,t.loadAccountTypeDetail=function(e){t.events&&t.events.loadAccountTypeDetail&&t.events.loadAccountTypeDetail(e)}}}}]),function(e){e.merge||(e.merge=e.extend),String.prototype.toPersianDigits=function(){var e=["۰","۱","۲","۳","۴","۵","۶","۷","۸","۹"];return this.replace(/[0-9]/g,function(t){return e[+t]})},String.prototype.toEnglishDigits=function(){var e={"۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9"};return this.replace(/[^0-9.]/g,function(t){return e[t]||t})},String.prototype.lZero=function(){return this.length<2?"0"+this:this},Array.prototype.toNumber=function(){return this.map(function(e){return Number(e)})},Array.prototype.dtp_toDate=function(e){var t="-";/invalid/i.test(new Date("1991-9-12"))&&(t="/");var n=this.join(t);return 5==this.length&&(n=this.slice(0,3).join(t)+" "+this.slice(3,5).join(":")),e?(n=new Date(n),"unix"==e?n.getTime():n):n},Number.prototype.lZero=function(){return this<10?"0"+this:this},Date.prototype.dtp_shortDate=function(){return[this.getFullYear(),this.getMonth()+1,this.getDate()].dtp_toDate()};e.module("ADM-dateTimePicker",[]).constant("constants",{}).provider("ADMdtp",function(){var t={calType:"gregorian",format:"YYYY/MM/DD hh:mm",multiple:!0,autoClose:!1,transition:!0,disabled:[],smartDisabling:!0,minuteStep:1,gregorianStartDay:0,gregorianDic:{title:"Gregorian",monthsNames:["January","February","March","April","May","June","July","August","September","October","November","December"],daysNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],todayBtn:"Today"},jalaliDic:{title:"جلالی",monthsNames:["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"],daysNames:["ش","ی","د","س","چ","پ","ج"],todayBtn:"امروز"},showToggleCalendar:!1},n={getOptions:function(e){return e&&t[e]||t}};this.setOptions=function(n,a){if(!a)return a=n,void(t=e.merge(t,a));t[n]=e.merge(t[n]||{},a)},this.$get=function(){return n}}).filter("digitType",[function(){return function(e,t){return"jalali"==t?String(e).toPersianDigits():e}}]).factory("ADMdtpConvertor",[function(){function e(e){var r,o,i,l=function(e){var t=[{id:1,count:31},{id:2,count:28},{id:3,count:31},{id:4,count:30},{id:5,count:31},{id:6,count:30},{id:7,count:31},{id:8,count:31},{id:9,count:30},{id:10,count:31},{id:11,count:30},{id:12,count:31}],r=a(e.year),o=n(e.year);r+=365*(e.year-1);for(var i=0;i<e.month-1;i++)o&&i+1==2&&(t[i].count=29),r+=t[i].count;return r+=e.day}(e);return o=function(e){var n=Math.floor((e-1)/365),a=0;if(n>22){var r=n-22-1,o=n-22,i=Math.floor(r/33),l=o-33*i;l>=28&&(l=28);var u=Math.floor(l/4),c=u+8*i+6,d=Math.floor((e-c)/365);return a=t(d),e-365*d-a-(s(d)?1:0)>0?++d:d}return a=n<1?0:n>=1&&n<=4?1:n>=5&&n<=8?2:n>=9&&n<=12?3:n>=13&&n<=16?4:n>=17&&n<22?5:6,(n=Math.floor((e-a-1)/365))+1}(r=l-=226894),i=function(e,n){var a=t(n);e-=a+365*(n-1);for(var r=[{id:1,count:31},{id:2,count:31},{id:3,count:31},{id:4,count:31},{id:5,count:31},{id:6,count:31},{id:7,count:30},{id:8,count:30},{id:9,count:30},{id:10,count:30},{id:11,count:30},{id:12,count:29}],o=0;o<r.length;o++){if(e<=r[o].count)return r[o].id;e-=r[o].count}return 12}(r,o),{day:function(e,n,a){var r=t(n);e-=r+365*(n-1);for(var o=1;o<a;o++)e-=o<=6?31:30;return e}(r,o,i),month:i,year:o}}function t(e){if(e<23)switch(e){case 1:return 0;case 2:case 3:case 4:case 5:return 1;case 6:case 7:case 8:case 9:return 2;case 10:case 11:case 12:case 13:return 3;case 14:case 15:case 16:case 17:return 4;case 18:case 19:case 20:case 21:case 22:return 5}var t=e-22,n=Math.floor((t-1)/33),a=t-33*n;a>28&&(a=28);var r=Math.floor(a/4)+8*n+6;return s(e)&&t-33*n<=28&&r--,r}function n(e){return e%4==0&&(e%100!=0||e%400==0)}function a(e){var t=e-1;return Math.floor(t/4)-Math.floor(t/100)+Math.floor(t/400)}function r(e){var t=a(Math.floor(e/365)),r=Math.floor((e-t)/365);return 0!=e-365*r-t?r++:n(r+1)&&(r+=t/365),Math.floor(r)}function o(e){var t=r(e);e-=365*(t-1)+a(t);for(var o=[{id:1,count:31},{id:2,count:28},{id:3,count:31},{id:4,count:30},{id:5,count:31},{id:6,count:30},{id:7,count:31},{id:8,count:31},{id:9,count:30},{id:10,count:31},{id:11,count:30},{id:12,count:31}],i=0,l=n(t),s=0;s<o.length;s++){if(l&&2==o[s].id&&(o[s].count=29),e<o[s].count)return 0==e&&0!=i||i++,i;e-=o[s].count,i=o[s].id}return i}function i(e){return function(e,t,r){for(var o=a(e),i=[{id:1,count:31},{id:2,count:28},{id:3,count:31},{id:4,count:30},{id:5,count:31},{id:6,count:30},{id:7,count:31},{id:8,count:31},{id:9,count:30},{id:10,count:31},{id:11,count:30},{id:12,count:31}],l=0,s=0;s<i.length;s++)i[s].id<t&&(l+=i[s].count);return n(e)&&t>2&&l++,r-365*(e-1)-o-l}(r(e),o(e),e)}function l(e){var n=e.day;return n+=function(e){for(var t=0,n=[{id:1,count:31},{id:2,count:31},{id:3,count:31},{id:4,count:31},{id:5,count:31},{id:6,count:31},{id:7,count:30},{id:8,count:30},{id:9,count:30},{id:10,count:30},{id:11,count:30},{id:12,count:29}],a=0;a<e-1;a++)t+=n[a].count;return t}(e.month),n+=function(e){var n=t(e);return n+=365*(e-1)}(e.year)}var s=function(e){if(1==e||5==e||9==e||13==e||17==e||22==e)return!0;if(e<22)return!1;var t=e-22,n=Math.floor(t/33);return(t-33*n)%4==0&&(t-33*n)/4!=8};return{toJalali:function(t,n,a){var r={year:t=t<=99?2e3+t:t,month:n,day:a};return r=e(r)},toGregorian:function(e,t,n){return function(e){var t=l(e)+226894,n=i(t),a=o(t),s=r(t);return 0==n&&(n=31,a=12,s--),{day:n,month:a,year:s}}({day:n,month:t,year:e=e<=99?1300+e:e})},isLeapJalali:s}}]).factory("ADMdtpFactory",["ADMdtpConvertor",function(t){return this.dateFormat=function(e,t,n,a){if(!e.year)return"";for(var r=[{key:"YYYY",value:e.year},{key:"YY",value:a?e.year:e.year%100},{key:"MM",value:e.month.lZero()},{key:"DD",value:e.day.lZero()},{key:"hh",value:t.hour.lZero()},{key:"mm",value:t.minute.lZero()}],o=0,i=r.length;o<i;o++)n=n.replace(r[o].key,r[o].value);return n},this.parseString=function(e,t){var n=[],a={},r=["YY/MM/DD","YY/MM/DD hh:mm","YY-MM-DD","YY-MM-DD hh:mm","MM/DD/YY","MM-DD-YY","MM/DD/YY hh:mm","MM-DD-YY hh:mm"];r.unshift(t);for(var o=0,i=r.length;o<i;o++)if(new RegExp("^"+r[o].replace(/[a-z]+/gi,function(e){var t=!1;return-1!=e.indexOf("YY")?(n.push("year"),t=!0):-1!=e.indexOf("MM")?(n.push("month"),t=!0):-1!=e.indexOf("DD")?(n.push("day"),t=!0):-1!=e.indexOf("hh")?(n.push("hour"),t=!0):-1!=e.indexOf("mm")&&(n.push("minute"),t=!0),t?"[0-9]+":e}).replace(/[(]/g,"[(]").replace(/[)]/g,"[)]")+"$").test(e))return n.reverse(),e.replace(/[0-9]+/g,function(e){return a[n.pop()]=Number(e),e}),a.hour=a.hour||0,a.minute=a.minute||0,a;return!1},this.toRegularFormat=function(e,t,n){return!!e&&("string"==typeof e?e=this.parseString(e,n):"number"==typeof e&&(e=this.convertFromUnix(e,t)),!!e&&(e.year<=99&&(e.year="jalali"==t?1300+e.year:2e3+e.year),[e.year,e.month.lZero(),e.day.lZero(),e.hour.lZero(),e.minute.lZero()].dtp_toDate()))},this.isDateEqual=function(e,t){return 0==new Date(e)-new Date(t)},this.isDateBigger=function(e,t){return new Date(e)-new Date(t)>=0},this.isMonthBigger=function(e,t){return new Date(e.year,e.month)-new Date(t.year,t.month)>=0},this.joinTime=function(e,t){return new Date(new Date(new Date(e).setHours(t.hour)).setMinutes(t.minute))},this.removeTime=function(e){return[e.getFullYear(),e.getMonth()+1,e.getDate()].dtp_toDate("date")},this.validateJalaliDateSeparate=function(e,n){if(3!=e.length||2!=n.length)return!1;if(n[0]>23||n[0]<0||n[1]>59||n[1]<0||e[0]<0||e[1]<1||e[1]>12)return!1;if(e[1]>0&&e[1]<7){if(e[2]<1||e[2]>31)return!1}else if(e[1]>6&&e[1]<12){if(e[2]<1||e[2]>30)return!1}else if(12==e[1]){var a=t.isLeapJalali(e[0]);if(a&&(e[2]<1||e[2]>30)||!a&&(e[2]<1||e[2]>29))return!1}return!0},this.validateJalaliDate=function(n,a){var r;if("number"==typeof n){var o=new Date(n);if(/invalid/i.test(o))return!1;var i=this.convertToJalali(o);r=e.merge(i,{hour:o.getHours(),minute:o.getMinutes()})}else"string"==typeof n?r=this.parseString(n,a):n instanceof Object&&(r=n);if(!r)return!1;var l=[r.year,r.month,r.day],s=[r.hour,r.minute];if(this.validateJalaliDateSeparate(l,s)){var u=t.toGregorian(l[0],l[1],l[2]);return o=[u.year,u.month,u.day,s[0],s[1]].dtp_toDate("date"),{year:l[0],month:l[1],day:l[2],hour:s[0],minute:s[1],unix:o.getTime(),gDate:o}}return!1},this.convertToUnix=function(e,t,n){if(!e)return null;if("number"==typeof e)return e;if("string"==typeof e)e=this.parseString(e,n);else{if(!(e instanceof Date))return null;e={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes()}}if(e.year<=99&&(e.year="jalali"==t?1300+e.year:2e3+e.year),"jalali"==t)return(a=this.validateJalaliDate(e,n)).unix||null;if("gregorian"==t){var a=new Date(this.toRegularFormat(e,t));return/invalid/i.test(a)?null:a.getTime()}return null},this.convertFromUnix=function(e,t){var n=new Date(e);return"jalali"==t?this.convertToJalali(n):"gregorian"==t?{year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate(),unix:e}:void 0},this.convertToJalali=function(n){if(n instanceof Date&&(n={year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate(),unix:n.getTime()}),n instanceof Object)return e.merge(t.toJalali(n.year,n.month,n.day),{unix:n.unix})},this.parseDisablePattern=function(e){var t=e.disabled,n=e.smartDisabling,a=e.calType,r=e.format,o=Array.apply(null,Array(7)).map(Number.prototype.valueOf,0),i=Array.apply(null,Array(31)).map(Number.prototype.valueOf,0),l={};if(t instanceof Array)for(var s=0,u=t.length;s<u;s++)if("number"==typeof t[s]){var c=new Date(t[s]);/invalid/i.test(c)||(l[this.removeTime(c).getTime()]=!0)}else if("string"==typeof t[s])if(t[s]=t[s].toLowerCase(),-1==t[s].indexOf("d")&&-1==t[s].indexOf("i")){var d=this.convertToUnix(t[s],a,r);d&&(l[d]=!0)}else{var p=new RegExp("^[!]?(([0-9]?[0-9])?[d]([+][0-9][0-9]?)?)([&]([0-9]?[0-9])?[d]([+][0-9][0-9]?)?)*?$").test(t[s]),f=new RegExp("^[!]?([i]([+][0-9][0-9]?)?)([&][i]([+][0-9][0-9]?)?)*?$").test(t[s]);if(p||f){var g="!"==t[s][0];t[s]=g?t[s].split("!")[1]:t[s];var m=t[s].split("&");if(p){var v={};m.forEach(function(e){var t=e.split(/d[+]?/).map(function(e){return Number(e)});t[0]=t[0]?t[0]:1,t[1]%=31;for(var n=0;n<31;n++)(1!=t[0]&&n%t[0]==t[1]||1==t[0]&&n==t[1])&&(v[n]=1)});for(var h=0;h<31;h++)g?v[h]||(i[h]=1):v[h]&&(i[h]=1)}else if(f)for(v={},m.forEach(function(e){var t=e.split(/i[+]?/).map(function(e){return Number(e)});t[1]%=7,v[t[1]]=1}),h=0;h<7;h++)g?v[h]||(o[h]=1):v[h]&&(o[h]=1)}else console.warn(t[s]+" is not valid!")}return{smart:n,calType:a,static:l,inWeek:o,inMonth:i}},this.isDayDisable=function(e,t,n){if(t.static[n.unix])return!0;var a=0;t.smart?"gregorian"==t.calType&&"jalali"==e?a=1:"jalali"==t.calType&&"gregorian"==e&&(a=-1):"gregorian"==t.calType&&"jalali"==e?a=-1:"jalali"==t.calType&&"gregorian"==e&&(a=1);var r=(n.dayName+7+a)%7;return!!t.inMonth[n.day-1]||!!+t.inWeek[r]},{dateFormat:this.dateFormat,parseString:this.parseString,toRegularFormat:this.toRegularFormat,isDateEqual:this.isDateEqual,isDateBigger:this.isDateBigger,isMonthBigger:this.isMonthBigger,joinTime:this.joinTime,removeTime:this.removeTime,validateJalaliDateSeparate:this.validateJalaliDateSeparate,validateJalaliDate:this.validateJalaliDate,convertToUnix:this.convertToUnix,convertFromUnix:this.convertFromUnix,convertToJalali:this.convertToJalali,parseDisablePattern:this.parseDisablePattern,isDayDisable:this.isDayDisable,counter:0}}]).directive("admDtp",["ADMdtp","ADMdtpConvertor","ADMdtpFactory","constants","$compile","$timeout","$rootScope",function(t,n,a,r,o,i,l){return{restrict:"E",replace:!0,transclude:!0,require:["ngModel","admDtp"],scope:{options:"=?",fullData:"=?",ngName:"=?",ngId:"=?",ngRequired:"=?",placeholder:"=?",onChange:"&?",onDatechange:"&?",onTimechange:"&?",onOpen:"&?",onClose:"&?"},link:function(n,r,l,s){var u=s[0],c=s[1];n.api=c,n.dtpId="adm-"+ ++a.counter,r.find("ng-transclude").children().length||(n.defaultTemplate=!0,r.find("ng-transclude").remove());var d=n.options;d instanceof Object||(d={}),n.option=e.merge(e.copy(t.getOptions()),d),n.option.minuteStep=Math.max(Math.min(n.option.minuteStep,60),1);var p=e.copy(n.option.gregorianDic.daysNames);n.option.gregorianDic.daysNamesUntouched=p,n.option.gregorianDic.daysNames=p.slice(n.option.gregorianStartDay,7).concat(p.slice(0,n.option.gregorianStartDay)),n.disableDays=a.parseDisablePattern(n.option),n.calType=n.option.calType,n.monthNames=n.option[n.calType+"Dic"].monthsNames,n.daysNames=n.option[n.calType+"Dic"].daysNames,n.timeoutValue=[0,0],n.dtpValue={},n.minDate=n.mindate?new Date(n.mindate):null,n.maxDate=n.maxdate?new Date(n.maxdate):null,n.current={year:"",month:"",monthDscr:"",days:[]},n.updateMasterValue=function(e,t){e||(e=n.dtpValue.unix?n.dtpValue:{}),n.$applyAsync(function(){n.dtpValue=e;var o=Number(n.time.minute);o-=o%n.option.minuteStep,n.time.minute=o.lZero(),n.dtpValue.formated=a.dateFormat(e,n.time,n.option.format),n.dtpValue.fullDate=a.joinTime(e.unix,n.time),n.fullData={formated:n.dtpValue.formated,lDate:n.dtpValue.fullDate.dtp_shortDate(),gDate:n.dtpValue.fullDate,unix:n.dtpValue.fullDate.getTime(),year:e.year,month:e.month,day:e.day,hour:Number(n.time.hour),minute:Number(n.time.minute),minDate:n.minDate,maxDate:n.maxDate,calType:n.calType,format:n.option.format},u.$setViewValue(n.dtpValue.formated),u.$render(),n.hasInputDtp&&(r[0].querySelector("[dtp-input]").value=n.dtpValue.formated),t&&(n.onChange&&n.onChange({date:n.fullData}),"time"==t&&n.onTimechange?n.onTimechange({date:n.fullData}):"day"==t&&n.onDatechange&&n.onDatechange({date:n.fullData}))})},n.parseInputValue=function(e,t,r){"today"===e&&(e=a.removeTime(new Date).getTime());var o=!1;e&&("jalali"===n.calType?o=a.validateJalaliDate(e,n.option.format):("string"==typeof e&&(e=a.toRegularFormat(e,n.calType,n.option.format)),o=new Date(e),o=!/invalid/i.test(o)&&o)),o?(n.dtpValue={year:o.year||o.getFullYear(),month:o.month||o.getMonth()+1,day:o.day||o.getDate(),unix:o.unix||o.getTime(),fullDate:o.gDate||o},n.dtpValue.fullDate=a.removeTime(n.dtpValue.fullDate),n.dtpValue.unix=n.dtpValue.fullDate.getTime(),n.time={hour:(o.getHours?o.getHours():o.hour).lZero(),minute:(o.getMinutes?o.getMinutes():o.minute).lZero()},n.updateMasterValue(!1,r)):t&&(n.time={hour:"00",minute:"00"})},n.parseInputValue(u.$viewValue||n.option.default,!0,!1),u.$formatters.push(function(e){return!e&&n.dtpValue.unix?n.destroy():n.dtpValue&&e==n.dtpValue.formated||n.parseInputValue(e,!1,!0),e}),n.option.watchingOptions&&n.$watch("options",function(r,o){if(r&&"object"==typeof r&&(!o||JSON.stringify(o)!=JSON.stringify(r))){var i=n.option.gregorianDic.daysNamesUntouched;n.option=e.merge(e.copy(t.getOptions()),r),n.option.minuteStep=Math.max(Math.min(n.option.minuteStep,60),1),r.gregorianDic&&r.gregorianDic.daysNames?n.option.gregorianDic.daysNamesUntouched=r.gregorianDic.daysNames:n.option.gregorianDic.daysNamesUntouched=i;var l=e.copy(n.option.gregorianDic.daysNamesUntouched);n.option.gregorianDic.daysNames=l.slice(n.option.gregorianStartDay,7).concat(l.slice(0,n.option.gregorianStartDay)),n.disableDays=a.parseDisablePattern(n.option),n.calTypeChanged&&n.calTypeChanged(n.option.calType)}},!0),l.$observe("disable",function(e){n.$applyAsync(function(){e=n.$eval(e),n.disable=e})}),l.$observe("mindate",function(e){n.$applyAsync(function(){e=n.$eval(e),n.minDate=a.convertToUnix(e,n.calType,n.option.format)})}),l.$observe("maxdate",function(e){n.$applyAsync(function(){e=n.$eval(e),n.maxDate=a.convertToUnix(e,n.calType,n.option.format)})}),n.onKeydown=function(e){9==e.keyCode&&n.closeCalendar()},n.openCalendar=function(){if(!n.showCalendarStat&&!n.disable){n.timeoutValue[0]=0,n.showCalendarStat=!0;var t=e.element('<adm-dtp-calendar id="'+n.dtpId+'" style="opacity:0; z-index: '+n.option.zIndex+';"></adm-dtp-calendar>');e.element(document.body).append(t),n.$applyAsync(function(){o(t)(n)}),i(function(){var t=document.documentElement.scrollTop||document.body.scrollTop,a=document.getElementById(n.dtpId),o=a.getBoundingClientRect(),i=r.children().children()[0].getBoundingClientRect(),l=i.left,s=i.top+i.height,u=o.width+l,c={top:"",bottom:"",left:"",right:""};o.height+s>window.innerHeight?c.top=t+i.top-o.height+"px":c.top=t+i.top+i.height+"px",u>window.innerWidth?c.left=l+window.innerWidth-u-20+"px":c.left=l+"px",e.element(a).css({top:c.top,bottom:c.bottom,left:c.left,opacity:1})},70),n.onOpen&&n.onOpen()}},n.closeCalendar=function(){if(n.showCalendarStat){n.$applyAsync(function(){n.monthPickerStat=!1,n.timePickerStat=!1,n.showCalendarStat=!1});var t=document.getElementById(n.dtpId);t&&(e.element(t).remove(),n.onClose&&n.onClose())}},n.toggleCalendar=function(){n.showCalendarStat?n.closeCalendar():n.openCalendar()},n.destroy=function(e){if(!n.disable){n.monthPickerStat=!1,n.timePickerStat=!1,n.current={year:"",month:"",monthDscr:"",days:[]},n.dtpValue={},n.fullData={minDate:n.minDate,maxDate:n.maxDate},n.time={hour:"00",minute:"00"};var t=new Date;"jalali"==n.calType&&(t=a.convertToJalali(t)),u.$setViewValue(""),u.$render(),e||c.fillDays(t,!n.option.transition),n.onChange&&n.onChange({date:n.fullData})}},(r[0].querySelector("[dtp-open]")||{}).onclick=n.openCalendar,(r[0].querySelector("[dtp-close]")||{}).onclick=n.closeCalendar,n.showToggleCalendar&&((r[0].querySelector("[dtp-toggle]")||{}).onclick=n.toggleCalendar),(r[0].querySelector("[dtp-destroy]")||{}).onclick=n.destroy},controller:["$scope",function(t){this.updateMasterValue=function(e,n){t.updateMasterValue(e,n)},this.fillDays=function(r,o){o?t.timeoutValue[0]=0:t.loadingDays=!0;var l=e.copy(r);if("jalali"==t.calType){var s=n.toGregorian(r.year,r.month,29);r=[s.year,s.month,s.day].dtp_toDate("date")}var u={year:r.getFullYear(),month:r.getMonth()+1,day:r.getDate()};t.$applyAsync(function(){var n=l.month||l.getMonth()+1;e.merge(t.current,{year:l.year||l.getFullYear(),month:n,monthDscr:t.monthNames[n-1]})});var c,d=c=t.option.gregorianStartDay;"jalali"==t.calType&&(d=0,c=6);var p=new Date;p=[p.getFullYear(),p.getMonth()+1,p.getDate(),1,0].dtp_toDate("unix");var f,g=t.dtpValue.unix||-1,m=[u.year,u.month,u.day,1,0].dtp_toDate("date"),v=[],h=-1*(new Date(e.copy(m).setDate(1)).getDay()-d+7)%7,y=!0,b=-1;if("jalali"==t.calType){var L=new Date(e.copy(m).setDate(h)),w=n.toJalali(L.getFullYear(),L.getMonth()+1,L.getDate());h-=7*Math.ceil((w.day-1)/7)+1}for(;;){h++,L=new Date(e.copy(m).setDate(h)),w=!1,"jalali"==t.calType&&(w=n.toJalali(L.getFullYear(),L.getMonth()+1,L.getDate()));var D=w.day||L.getDate();if(1==D&&(y=!y),y&&D<8&&L.getDay()==c)break;var k=!1,x=1;if(t.minDate||t.maxDate){var S=a.joinTime(L,t.time);t.minDate&&!a.isDateBigger(S,t.minDate)||t.maxDate&&!a.isDateBigger(t.maxDate,S)?(x=0,2==b&&(v[v.length-1].isMax=!0)):(x=2,0==b&&(k=!0)),b=x}var $=L.getTime(),C=L.getDay()+("jalali"==t.calType?1:0),M={day:D,month:w.month||L.getMonth()+1,year:w.year||L.getFullYear(),dayName:C,fullDate:L,disable:y,today:$==p,selected:$==g,unix:$,valid:x,isMin:k};a.isDayDisable(t.calType,t.disableDays,M)&&(M.valid=0),M.selected&&(f=v.length),v.push(M)}i(function(){t.timeoutValue[0]=500,t.$applyAsync(function(){t.current.days=v,f&&t.updateMasterValue(t.current.days[f]),i(function(){t.loadingDays=!1},t.timeoutValue[1])})},t.timeoutValue[0])},this.reload=function(){var n=e.copy(t.current);n.day=29;var a=[n.year,n.month,8].dtp_toDate("date");"jalali"==t.calType&&(a=n),this.fillDays(a,!t.option.transition)},this.vm=t}],template:'<div class="ADMdtp ADMdtp-container" ng-class="{rtl: (calType==\'jalali\'), touch: option.isDeviceTouch, disable: disable}"> <div class="clickOutContainer" click-out="closeCalendar()"  alias="{{dtpId}}"> <ng-transclude></ng-transclude> <div ng-if="defaultTemplate" class="ADMdtpInput masterInput" ng-class="{touch: option.isDeviceTouch, disable: disable, open: showCalendarStat, toggleCalendar: option.showToggleCalendar}"> <input type="text" name="{{ngName}}" id="{{ngId}}" class="form-control txtlefttoright" ng-model="dtpValue.formated" autocomplete="off" ng-focus="openCalendar()" ng-click="openCalendar()" ng-readonly="option.freezeInput || (option.isDeviceTouch && false) || disable" ng-blur="modelChanged()" ng-keydown="onKeydown($event)" ng-required="ngRequired" placeholder="{{placeholder}}" > <div class="dtp-ig" ng-if="option.showToggleCalendar" ng-click="toggleCalendar()"> <svg class="dtp-i fakeIcon" viewBox="0 0 24 24"> <use xlink:href="#dtp-i-right" /> </svg> <svg class="dtp-i calendarIcon" viewBox="0 0 24 24"> <use xlink:href="#dtp-i-calendar" /> </svg> <svg class="dtp-i closeIcon" viewBox="0 0 24 24"> <use xlink:href="#dtp-i-off" /> </svg> </div> <svg class="removeIcon" viewBox="0 0 24 24" ng-if="dtpValue.formated" ng-click="destroy()"> <use xlink:href="#dtp-i-close" /> </svg> </div> </div> <svg style="display:none;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"> <defs> <g id="dtp-i-calendar"> <path d="M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"/> <path d="M0 0h24v24H0z" fill="none"/> </g> <g id="dtp-i-clock"> <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"/> <path d="M0 0h24v24H0z" fill="none"/> <path d="M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"/> </g> <g id="dtp-i-right"> <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/> <path d="M0 0h24v24H0z" fill="none"/> </g> <g id="dtp-i-close"> <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/> <path d="M0 0h24v24H0z" fill="none"/> </g> <g id="dtp-i-off"> <path d="M0 0h24v24H0z" fill="none"/> <path d="M13 3h-2v10h2V3zm4.83 2.17l-1.42 1.42C17.99 7.86 19 9.81 19 12c0 3.87-3.13 7-7 7s-7-3.13-7-7c0-2.19 1.01-4.14 2.58-5.42L6.17 5.17C4.23 6.82 3 9.26 3 12c0 4.97 4.03 9 9 9s9-4.03 9-9c0-2.74-1.23-5.18-3.17-6.83z"/> </g> </defs> </svg> </div>'}}]).directive("admDtpCalendar",["ADMdtp","ADMdtpConvertor","ADMdtpFactory","constants","$timeout",function(t,n,a,r,o){return{restrict:"E",replace:!0,link:function(t,r,i){var l,s=t.api;l=t.dtpValue.unix?new Date(t.dtpValue.fullDate):new Date,"jalali"==t.calType&&(l=a.convertToJalali(l)),s.fillDays(l,!t.option.transition),t.previousMonth=function(e){"jalali"!=t.calType||e?(1==t.current.month?(t.current.month=12,t.current.year--):t.current.month--,s.reload()):t.nextMonth(!0)},t.nextMonth=function(e){"jalali"!=t.calType||e?(12==t.current.month?(t.current.month=1,t.current.year++):t.current.month++,s.reload()):t.previousMonth(!0)},t.previousYear=function(e){if("jalali"!=t.calType||e){var n=t.generatedYears.shift();t.generatedYears=[];for(var a=1;a<17;a++)t.generatedYears.push(n-17+a)}else t.nextYear(!0)},t.nextYear=function(e){if("jalali"!=t.calType||e){var n=t.generatedYears.pop();t.generatedYears=[];for(var a=1;a<17;a++)t.generatedYears.push(n+a)}else t.previousYear(!0)},t.selectMonthInit=function(){t.yearSelectStat=!1,t.monthPickerStat=!0},t.selectYearInit=function(){t.yearSelectStat=!0,t.generatedYears=[];for(var e=0;e<16;e++)t.generatedYears.push(t.current.year+e-7)},t.selectMonth=function(e){e+1!=t.current.month&&(t.current.month=e+1,s.reload()),t.monthPickerStat=!1},t.selectYear=function(e){e!=t.current.year&&(t.current.year=e,s.reload()),t.monthPickerStat=!1},t.selectThisDay=function(e){0!=e.valid&&(t.dtpValue.selected=!1,s.updateMasterValue(e,"day"),t.option.autoClose?o(function(){t.closeCalendar()},100):e.disable?o(function(){a.isMonthBigger(e,t.current)?t.nextMonth(!0):t.previousMonth(!0)},0):e.selected=!0)},t.today=function(){var e=new Date;"jalali"==t.calType&&(e=a.convertToJalali(e)),s.fillDays(e,!t.option.transition)},t.changeTimeValue=function(e,n){n*="minute"==e?t.option.minuteStep:1;var r=(Number(t.time[e])+n+("hour"==e?24:60))%("hour"==e?24:60),o={};if(o.hour=t.time.hour,o.minute=t.time.minute,o[e]=r.lZero(),t.dtpValue.unix&&(t.minDate||t.maxDate)){var i=a.joinTime(t.dtpValue.unix,o);if(t.minDate&&!a.isDateBigger(i,t.minDate)||t.maxDate&&!a.isDateBigger(t.maxDate,i))return}t.time[e]=r.lZero(),t.dtpValue.unix&&s.updateMasterValue(!1,"time"),s.reload()},t.modelChanged=function(n){var r=e.isDefined(n)?n:t.dtpValue.formated;if(r){var o=a.convertToUnix(r,t.calType,t.option.format);if(!o||t.option.freezeInput||t.disable||t.minDate&&!a.isDateBigger(o,t.minDate)||t.maxDate&&!a.isDateBigger(t.maxDate,o))s.updateMasterValue(!1);else if(o!=t.fullData.unix){t.parseInputValue(r,!1,!0);var i=new Date(o);"jalali"==t.calType&&(i=a.convertToJalali(i)),s.fillDays(i,!0)}}else t.dtpValue.unix&&t.destroy()},s.modelChanged=t.modelChanged,t.calTypeChanged=function(r){t.calType=r||("gregorian"==t.calType?"jalali":"gregorian"),t.monthNames=t.option[t.calType+"Dic"].monthsNames,t.daysNames=t.option[t.calType+"Dic"].daysNames;var o,i=e.copy(t.current);o="jalali"==t.calType?n.toJalali(i.year,i.month,15):[(o=n.toGregorian(i.year,i.month,15)).year,o.month,o.day].dtp_toDate("date"),t.dtpValue.unix&&s.updateMasterValue(a.convertFromUnix(t.dtpValue.unix,t.calType)),s.fillDays(o,!0)}},template:'<div class="ADMdtp-box ADMdtp-calendar-container" ng-class="{rtl: (calType==\'jalali\'), square: monthPickerStat||timePickerStat}"> <div class="dtpNewBox" ng-class="{active: monthPickerStat}"> <i class="calendarIcon" ng-class="{show: monthPickerStat}" ng-click="monthPickerStat = false"> <svg class="dtp-i" viewBox="0 0 24 24"> <use xlink:href="#dtp-i-calendar" /> </svg> </i> <div class="content"> <div class="ADMdtpMonths" ng-class="{onYear: yearSelectStat, rtl: (calType==\'jalali\')}"> <div class="ADMdtpYears"> <svg class="dtp-i dtp-i-180 dtp-trs-3 arrow left" viewBox="0 0 24 24" ng-if="yearSelectStat" ng-click="previousYear()"> <use xlink:href="#dtp-i-right" /> </svg> <p class="dtp-trs-3" ng-click="selectYearInit()">{{current.year | digitType:calType}}</p> <svg class="dtp-i dtp-trs-3 arrow right" viewBox="0 0 24 24" ng-if="yearSelectStat" ng-click="nextYear()"> <use xlink:href="#dtp-i-right" /> </svg> </div> <span ng-repeat="yearName in generatedYears" ng-if="yearSelectStat"><span class="dtp-trs-5" ng-class="{selected: yearName==current.year}" ng-click="selectYear(yearName)">{{yearName | digitType:calType}}</span></span> <span ng-repeat="monthName in monthNames" ng-if="!yearSelectStat"><span class="dtp-trs-5" ng-class="{selected: monthName==current.monthDscr}" ng-click="selectMonth($index)">{{monthName}}</span></span> </div> </div> </div> <div class="dtpNewBox" ng-class="{active: timePickerStat}"> <i class="calendarIcon" ng-class="{show: timePickerStat}" ng-click="timePickerStat = false"> <svg class="dtp-i" viewBox="0 0 24 24"> <use xlink:href="#dtp-i-calendar" /> </svg> </i> <div class="content"> <div class="ADMdtpTime"> <span class="dtpIcon null up" ng-click="changeTimeValue(\'hour\', 1)"><svg class="dtp-i dtp-trs-5 dtp-i-270" viewBox="0 0 24 24"><use xlink:href="#dtp-i-right" /></svg></span>\x3c!-- --\x3e<span></span>\x3c!-- --\x3e<span class="dtpIcon null up" ng-click="changeTimeValue(\'minute\', 1)"><svg class="dtp-i dtp-trs-5 dtp-i-270" viewBox="0 0 24 24"><use xlink:href="#dtp-i-right" /></svg></span>\x3c!-- --\x3e<span>{{time.hour}}</span>\x3c!-- --\x3e<span class="period">:</span>\x3c!-- --\x3e<span>{{time.minute}}</span>\x3c!-- --\x3e<span class="dtpIcon null down" ng-click="changeTimeValue(\'hour\', -1)"><svg class="dtp-i dtp-trs-5 dtp-i-90" viewBox="0 0 24 24"><use xlink:href="#dtp-i-right" /></svg></span>\x3c!-- --\x3e<span></span>\x3c!-- --\x3e<span class="dtpIcon null down" ng-click="changeTimeValue(\'minute\', -1)"><svg class="dtp-i dtp-trs-5 dtp-i-90" viewBox="0 0 24 24"><use xlink:href="#dtp-i-right" /></svg></span> </div> </div> </div> <header> <svg class="dtp-i dtp-i-180 dtp-trs-3 arrow left" viewBox="0 0 24 24" ng-click="previousMonth()"> <use xlink:href="#dtp-i-right" /> </svg> <span class="yearMonth" ng-click="selectMonthInit()">{{current.monthDscr}} {{current.year | digitType:calType}}</span> <svg class="dtp-i dtp-trs-3 arrow right" viewBox="0 0 24 24" ng-click="nextMonth()"> <use xlink:href="#dtp-i-right" /> </svg> </header> <div class="daysNames"> <span ng-repeat="dayName in daysNames">{{dayName}}</span> </div> <hr> <div class="ADMdtpDays" ng-class="{loading:loadingDays}"> <span ng-repeat="day in current.days" ng-click="selectThisDay(day)"><span ng-class="{disable: day.disable||!day.valid, today: day.today, selected: day.selected, valid:(day.valid==2), max:((day.isMin && calType==\'jalali\') || (day.isMax && calType!=\'jalali\')), min:((day.isMax && calType==\'jalali\') || (day.isMin && calType!=\'jalali\'))}">{{day.day | digitType:calType}}</span></span> </div> <hr> <footer> <div class="calTypeContainer dtp-trs-3" ng-class="$parent.calType" ng-click="calTypeChanged()" ng-if="option.multiple"> <p class="gregorian">{{option.gregorianDic.title}}</p> <p class="jalali">{{option.jalaliDic.title}}</p> </div> <button type="button" class="today dtp-trs-3" ng-click="today()">{{option[calType + "Dic"].todayBtn}}</button> <svg class="dtp-i dtp-trs-5 timeSelectIcon" viewBox="0 0 24 24" ng-show="option.dtpType != \'date\'" ng-click="timePickerStat = !timePickerStat"> <use xlink:href="#dtp-i-clock" /> </svg> </footer> </div>'}}]).directive("dtpInput",[function(){return{require:["^^admDtp","ngModel"],link:function(e,t,n,a){var r=a[0],o=a[1];o.$parsers.push(function(){return o.$modelValue}),r.vm.hasInputDtp=!0,t.on("focus",function(){r.vm.openCalendar()}),t.on("blur",function(){r.vm.modelChanged(t[0].value)})}}}]).directive("clickOut",["$document",function(e){return{restrict:"A",scope:{clickOut:"&"},link:function(t,n,a){void 0==a.id&&a.$set("id","id_"+Math.random()),e.on("click contextmenu",function(e){var n,r=0;if(e.target){var o=void 0!==a.alias?a.alias.replace(", ",",").split(","):[];for(o.push(a.id),n=e.target;n;n=n.parentNode){var i=n.id,l=n.className;if(void 0!==i)for(r=0;r<o.length;r++)if(i.indexOf(o[r])>-1||"string"==typeof l&&l.indexOf(o[r])>-1)return}t.$eval(t.clickOut)}})}}}]).config(["ADMdtpProvider",function(e){e.setOptions({isDeviceTouch:"ontouchstart"in window||navigator.maxTouchPoints});var t=document.createElement("style");t.type="text/css";for(var n,a=1;a<51;a++)t.innerHTML+=".ADMdtpDays>span:nth-child("+a+")>span {-moz-"+(n="transition: all .5s, transform 0.2s "+.01*a+"s cubic-bezier(0.680, -0.550, 0.265, 1.550); ")+"-o-"+n+"-webkit-"+n+n+"}";document.getElementsByTagName("head")[0].appendChild(t)}])}(window.angular),angular.module("emixApp.directives").directive("ngServiceBundle",["sharedInfo","httpServices","$rootScope","shareFunc","$compile","$timeout","$translate",function(e,t,n,a,r,o,i){return{scope:{options:"=",events:"="},templateUrl:"/panelshare/directives/serviceBundle/template.html"+n.version,link:function(r,i,l){r.options.visible=a.getBoolDefaultValue(r.options.visible,!0),r.options.readonly=a.getBoolDefaultValue(r.options.readonly,!1),r.options.showPriceDetail=a.getBoolDefaultValue(r.options.showPriceDetail,!1),r.options.showPayableDetail=a.getBoolDefaultValue(r.options.showPayableDetail,!0),r.options.payableAmount=r.options.payableAmount?r.options.payableAmount:0,r.shopCurrency=n.shopCurrency,r.shopFractionSize=n.shopFractionSize,r.minFinalAmount=1e4,r.bankGetways=e.getBankGetways(),r.selectedBank=r.bankGetways[0].id,r.serviceBundleList=e.getServiceBundleList(),r.options.selectedServiceBundle=r.serviceBundleList[1],r.calcPayableAmount=function(){r.accountInfo&&(r.options.payableAmount=r.options.selectedServiceBundle.price-r.accountInfo.balance,r.options.payableAmount=r.options.payableAmount<0?0:r.options.payableAmount,r.options.payableAmount=r.options.payableAmount<r.minFinalAmount&&r.options.payableAmount>0?r.minFinalAmount:r.options.payableAmount)},r.serviceBundleClick=function(e,t){if((t=!0===t)||!r.options.readonly){var n=$(e.currentTarget),a=n.index()+2;$(".prc tr").find("td:not(:eq(0))").hide(),$(".prc td:nth-child("+a+")").css("display","table-cell"),$(".prc tr").find("th:not(:eq(0))").hide(),$(".prc ul li").removeClass("active"),n.addClass("active");var o=n.data("sbndlid");r.events.setSelectedServiceBundle(o,!0)}};var s=window.matchMedia("(min-width: 600px)");function u(e){e.matches?($(".prc .sep").attr("colspan",5),$(".prc td:nth-child(3)").css("display","table-cell")):$(".prc .sep").attr("colspan",2),r.serviceBundleClick({currentTarget:$($(".prc ul li")[1])},!0)}s.addListener(u),r.chargeWallet=function(){var e={gatewayId:r.selectedBank,amount:parseFloat(r.options.payableAmount)};NProgress.start(),$.blockUI(),t.chargeAccountAsBankPayment(e).then(function(e){var n=e.data;t.redirectToIpg(n.returnObject.bankInfo,n.returnObject.message,"frmBankPayment")},function(e){t.handleError(e.data,e.status,e.headers,e.config)}).finally(function(){NProgress.done(),$.unblockUI()})},r.params={},r.events.init=function(){u(s)},r.events.getMyMainAccountInfo=function(){NProgress.start(),$.blockUI(),t.getMyMainAccountInfo().then(function(e){var t=e.data;r.accountInfo=t.returnObject,r.params.accounts=[r.accountInfo],r.calcPayableAmount(),r.onAccountInfoLoaded&&r.onAccountInfoLoaded(r.accountInfo)},function(e){t.handleError(e.data,e.status,e.headers,e.config)}).finally(function(){NProgress.done(),$.unblockUI()})},r.events.setSelectedServiceBundle=function(e,t){t=1==t,o(function(){var n=r.serviceBundleList.filter(function(t){return t.id==parseInt(e,10)});n.length>0?(r.options.selectedServiceBundle=n[0],t||r.serviceBundleClick({currentTarget:$($('.prc ul li[data-sbndlid="'+e+'"]')[0])},!0),r.calcPayableAmount()):toastr.error("پکیج مورد نظر یافت نشد.")},100)}}}}]),angular.module("emixApp.directives").directive("qrcodeReader",["$translate","$rootScope","$timeout",function(e,t,n){return{scope:{options:"=",events:"="},templateUrl:"/panelshare/directives/qrcode-reader/template.html"+t.version,link:function(e,t,a){var r,o;e.options.id=e.options.id||"qr-reader",e.options.cssClass=e.options.cssClass||"qrreaderbx",e.options.cameraWidth=e.options.cameraWidth||400,e.onScanSuccess=function(t){if(t&&t.length>0){if(t===o)return e.events.onScanDuplicate&&e.events.onScanDuplicate(t),r&&clearTimeout(r),void(r=setTimeout(function(){o=""},2e3));console.log(`Scan result ${t}`),o=t,e.events.onScanSuccess&&e.events.onScanSuccess(t)}},n(function(){var t=document.createElement("video"),n=document.getElementById(e.options.id),a=$(n).width();e.options.cameraWidth=Math.min(e.options.cameraWidth,a)-10;var r=document.getElementById(e.options.id+"-diod"),o=document.getElementById(e.options.id+"-canvas"),i=o.getContext("2d"),l=document.getElementById(e.options.id+"-loadingImage");function s(e,t,n){i.beginPath(),i.moveTo(e.x,e.y),i.lineTo(t.x,t.y),i.lineWidth=4,i.strokeStyle=n,i.stroke()}function u(){if(t.readyState===t.HAVE_ENOUGH_DATA){l.hidden=!0,o.hidden=!1,r.hidden=!1,e.cameraHeight=e.options.cameraWidth*t.videoHeight/t.videoWidth,o.width=e.options.cameraWidth,r.width=e.options.cameraWidth,o.height=e.cameraHeight,document.documentElement.style.setProperty("--canvas-element-height",e.cameraHeight+"px"),i.drawImage(t,0,0,o.width,o.height);var n=i.getImageData(0,0,o.width,o.height),a=jsQR(n.data,n.width,n.height,{inversionAttempts:"dontInvert"});a&&(s(a.location.topLeftCorner,a.location.topRightCorner,"#FF3B58"),s(a.location.topRightCorner,a.location.bottomRightCorner,"#FF3B58"),s(a.location.bottomRightCorner,a.location.bottomLeftCorner,"#FF3B58"),s(a.location.bottomLeftCorner,a.location.topLeftCorner,"#FF3B58"),e.onScanSuccess(a.data))}requestAnimationFrame(u)}void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return t?new Promise(function(n,a){t.call(navigator,e,n,a)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}),navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then(function(e){t.srcObject=e,t.setAttribute("playsinline",!0),t.play(),requestAnimationFrame(u)},function(e){console.log(e)})},0)}}}]),angular.module("emixApp.directives").directive("ngKeyValueList",["sharedInfo","httpServices","$rootScope","shareFunc","$compile","$timeout","$translate",function(e,t,n,a,r,o,i){return{scope:{options:"=",events:"="},templateUrl:"/panelshare/directives/key-value-list/template.html"+n.version,link:function(e,t,n){e.options.keyValueList=e.options.keyValueList||[],e.options.keyName=e.options.keyName||"key",e.options.valueName=e.options.valueName||"value",e.options.blockClass=e.options.blockClass||"bzttag",e.value="";e.checkKeyValue=function(t){return t=!0===t,e.txtKey&&e.txtValue?!function(t,n){n=!0===n;var a=!1;return e.options.keyValueList.forEach(function(r){a||r[e.options.keyName].replace(/\s/g,"")!==t.replace(/\s/g,"")||n&&r[e.options.keyName]===e.oldKeyValue[e.options.keyName]||(a=!0)}),a}(e.txtKey,t)||(toastr.error(i.instant("shop.attributeIsDuplicate",{attributeName:e.txtKey})),angular.element("#txtKey").focus(),!1):(e.showAttributeError=!0,e.txtKey?e.txtValue||angular.element("#txtValue").focus():angular.element("#txtKey").focus(),!1)},e.addKeyValue=function(){if(e.showAttributeError=!1,e.checkKeyValue()){var t={id:0};t[e.options.keyName]=e.txtKey,t[e.options.valueName]=e.txtValue,e.options.keyValueList.push(t),e.resetKeyValueForm()}},e.removeKeyValue=function(t){var n=e.options.keyValueList.indexOf(t);n>-1&&e.options.keyValueList.splice(n,1)},e.bindEditKeyValue=function(t){e.oldKeyValue=t,e.txtKey=t[e.options.keyName],e.txtValue=t[e.options.valueName],e.keyValueEditMode=!0},e.editKeyValue=function(){if(e.oldKeyValue[e.options.keyName]!==e.txtKey||e.oldKeyValue[e.options.valueName]!==e.txtValue){if(e.showAttributeError=!1,e.checkKeyValue(!0)){var t=e.options.keyValueList.indexOf(e.oldKeyValue);e.options.keyValueList[t][e.options.keyName]=e.txtKey,e.options.keyValueList[t][e.options.valueName]=e.txtValue,e.resetKeyValueForm()}}else e.cancelEditKeyValue()},e.cancelEditKeyValue=function(){e.keyValueEditMode=!1,e.resetKeyValueForm()},e.resetKeyValueForm=function(){e.txtKey=e.txtValue=null,e.showAttributeError=e.keyValueEditMode=!1,e.oldKeyValue=null,angular.element("#txtKey").focus()}}}}]),angular.module("emixApp.directives").directive("ngValueList",["sharedInfo","httpServices","$rootScope","shareFunc","$compile","$timeout","$translate",function(e,t,n,a,r,o,i){return{scope:{options:"=",events:"="},templateUrl:"/panelshare/directives/value-list/template.html"+n.version,link:function(e,t,n){e.options.valueList=e.options.valueList||[],e.options.caption=e.options.caption||"",e.options.blockClass=e.options.blockClass||"bzttag",e.value="",e.addValue=function(){e.options.valueList.indexOf(e.value)>=0?toastr.error(i.instant("common.duplicateElement2",{element:i.instant("common.value")})):(e.value&&e.options.valueList.push(e.value),e.value="")},e.removeValue=function(t){var n=e.options.valueList.indexOf(t);e.options.valueList.splice(n,1)},e.editMode=!1,e.oldValueForEdit="",e.editValueState=function(t){e.editMode=!0,e.oldValueForEdit=e.value=t},e.cancleEditValue=function(){e.showValueError=!1,e.editMode=!1,e.value=""},e.editValue=function(){if(e.value==e.oldValueForEdit&&(e.value="",e.editMode=!1),e.options.valueList.indexOf(e.value)>=0)toastr.error("مقدار تکراری می باشد.");else{var t=e.options.valueList.indexOf(e.oldValueForEdit);t>=0&&e.value&&(e.options.valueList[t]=e.value,e.value="",e.editMode=!1)}}}}}]),angular.module("emixApp.directives").directive("ngMapAddress",["sharedInfo","$templateRequest","$rootScope","shareFunc","$compile","$timeout","$translate",function(e,t,n,a,r,o,i){return{scope:{options:"=",events:"="},link:function(a,o,i){a.options.allowMultiMarker=1==a.options.allowMultiMarker,a.options.mapWidth=a.options.mapWidth||"100%",a.options.mapHeight=a.options.mapHeight||"350px",a.options.addressTextAreaStyle=a.options.addressTextAreaStyle||"height:100px",a.options.addressTextAreaRowCount=a.options.addressTextAreaRowCount||3,a.options.addressTextAreaColCount=a.options.addressTextAreaColCount||40,a.options.panelClass=a.options.panelClass||"",a.options.addressRequired=1==a.options.addressRequired,a.options.showError=1==a.options.showError,a.options.address=a.options.address||"",a.options.markers=a.options.markers||new Array,a.options.center=a.options.center||{lat:e.getDefaultPosLat(),lng:e.getDefaultPosLan(),zoom:e.getDefaultMapZoom()},a.options.center.zoom=a.options.center.zoom||e.getDefaultMapZoom(),a.events={},a.options.broadcastEvents={},t("/panelshare/directives/map-address/template.html"+n.version).then(function(e){var t=angular.element(e);o.append(t),r(t)(a)}),a.$on("leafletDirectiveMap.click",function(e,t){l(t.leafletEvent.latlng),a.events.onClick&&a.events.onClick(e,t)}),a.$on("leafletDirectiveMarker.dragend",function(e,t){l(t.leafletObject._latlng),a.events.onClick&&a.events.onDragEnd(e,t)});var l=function(e){a.events.setMarker(e.lat,e.lng)};a.events.setMarker=function(e,t){var n={lat:e,lng:t,draggable:!0};a.options.allowMultiMarker?a.options.markers.push(n):a.options.markers[0]=n,a.options.center={lat:e,lng:t,zoom:a.options.center.zoom}}}}}]),angular.module("emixApp.directives").directive("ngTooltip",["$timeout","$compile",function(e,t){return{restrict:"A",scope:{title:"@",fixedPosition:"=",titleClass:"@"},link:function(n,a,r){n.createTooltip=function(e){if(r.title||r.tooltip){n.getDirection();n.tooltipElement=angular.element("<div>").addClass("angular-tooltip").addClass(n.titleClass),angular.element(document).find("body").append(n.tooltipElement),n.updateTooltip(r.title||r.tooltip),n.tooltipElement.addClass("angular-tooltip-fade-in")}},n.updateTooltip=function(r){n.tooltipElement.html(r),t(n.tooltipElement.contents())(n);var o=n.calculatePosition(n.tooltipElement,n.getDirection());n.tooltipElement.addClass("angular-tooltip-"+o.direction).css(o),e(function(){a.removeAttr("ng-attr-title"),a.removeAttr("title")})},n.$watch("title",function(e){n.tooltipElement&&n.updateTooltip(e)}),n.removeTooltip=function(){angular.element(document.querySelectorAll(".angular-tooltip")).remove()},n.getDirection=function(){return a.attr("tooltip-direction")||a.attr("title-direction")||"top"},n.calculatePosition=function(e,t){var r=e[0].getBoundingClientRect(),o=a[0].getBoundingClientRect(),i=window.scrollX||document.documentElement.scrollLeft,l=window.scrollY||document.documentElement.scrollTop,s={},u=null;return n.stringStartsWith(t,"left")?s.left=o.left-r.width-6+i:n.stringStartsWith(t,"right")?s.left=o.left+o.width+6+i:n.stringContains(t,"left")?s.left=o.left-r.width+12+i:n.stringContains(t,"right")?s.left=o.left+o.width-12+i:s.left=o.left+o.width/2-r.width/2+i,n.stringStartsWith(t,"top")?s.top=o.top-r.height-6+l:n.stringStartsWith(t,"bottom")?s.top=o.top+o.height+6+l:n.stringContains(t,"top")?s.top=o.top-r.height+12+l:n.stringContains(t,"bottom")?s.top=o.top+o.height-12+l:s.top=o.top+o.height/2-r.height/2+l,n.fixedPosition&&(s.left<i?u=t.replace("left","right"):s.left+r.width>window.innerWidth+i&&(u=t.replace("right","left")),s.top<l?u=t.replace("top","bottom"):s.top+r.height>window.innerHeight+l&&(u=t.replace("bottom","top")),u)?n.calculatePosition(e,u):(s.left+="px",s.top+="px",s.direction=t,s)},n.stringStartsWith=function(e,t){return e.substr(0,t.length)===t},n.stringContains=function(e,t){return-1!==e.indexOf(t)},r.title||r.tooltip?(a.on("mouseover",n.createTooltip),a.on("mouseout",n.removeTooltip)):(a.off("mouseover",n.createTooltip),a.off("mouseout",n.removeTooltip)),a.on("destroy",n.removeTooltip),n.$on("$destroy",n.removeTooltip)}}}]),angular.module("emixApp.directives").directive("ngDropBox",["$compile","$rootScope","$sce","$filter","PagerService","httpServices","$http","orderByFilter","sharedInfo","shareFunc","$templateRequest","$templateCache","$translate","$timeout",function(e,t,n,a,r,o,i,l,s,u,c,d,p,f){return{require:"ngModel",scope:{ngModel:"=",options:"=",cols:"=",additionalData:"=",events:"="},link:function(n,a,r){n.elementHtml=a.html().trim(),c("/panelshare/directives/drop-box/template.html"+t.version).then(function(t){var r=angular.element(t);a.prepend(r),e(r)(n)});var l=!0,s=function(e){null!==e?(n.ngModel=e[n.options.dataKeyField],n.ngTextModel=e[n.options.dataCodeField]+" - "+function(e){for(var t=n.options.dataTextField.split(","),a=[],r=0;r<t.length;r++)a.push(e[t[r].trim()]||"");return a.join(" ")}(e),angular.isFunction(n.events.onSelected)&&f(function(){n.events.onSelected(e)},0)):(n.eraseResult(),n.ngModel=null,n.ngTextModel=""),l=!1},d=function(){return(n.ngTextModel||"").split(" ")[0]},p=function(){return i({method:"GET",url:n.options.apiUrl,params:function(){const e={start:0,count:2,resultCount:!1};return d().length>0?e[n.options.dataCodeField]=d():e[n.options.dataKeyField]=n.ngModel,e}(),cache:!1,headers:o.getHeaders()})},g=function(e){return"undefined"!==(typeof e).toString()&&null!==e&&e.toString().length>0},m=function(e,t){var n=t[0],a=t[1],r=e[0],i=e[1];g(n)&&g(r)&&r===n&&i!==a&&!1!==l||!(!g(r)&&!g(i)||g(r)&&g(i)||r===n&&i===a)?(NProgress.start(),$.blockUI(),p().then(function(e){var t=e.data.returnObject.result,n=(t||[]).length;s(1===n?t[0]:null)},function(e){o.handleError(e.data,e.status,e.headers,e.config)}).finally(function(){NProgress.done(),$.unblockUI()})):l=!0};n.inputClicked=function(){n.options.readOnly&&n.openSearchModal()},n.openSearchModal=function(){if(!n.options.disabled){var e={};e.options=n.options,e.dtCols=n.cols,e.additionalData=n.additionalData,e.events=n.events,u.openModal(e,"/panelshare/directives/drop-box/modal/index.html","dropboxgridmodal_index",n.options.modalSize,function(e){s(e)},function(){})}},n.eraseResult=function(){n.options.disabled||(n.ngModel=null,n.ngTextModel="",angular.isFunction(n.events.onSelected)&&f(function(){n.events.onSelected(null)},0))},n.$watch("[ngModel, ngTextModel]",m),n.events.erase=function(){n.eraseResult()},f(function(){n.options.dataKeyField=n.options.dataKeyField||"id",n.options.dataCodeField=n.options.dataCodeField||n.options.dataKeyField,n.options.dataTextField=n.options.dataTextField||"",n.options.label=n.options.label||"",n.options.modalSize=n.options.modalSize||"lg",n.options.id=n.options.id||"srdropdown",n.options.propertyName=n.options.propertyName||null,n.options.additionalSortFieldName=n.options.additionalSortFieldName||null,n.options.reverse=u.getBoolDefaultValue(n.options.reverse,!1),n.options.saveState=u.getBoolDefaultValue(n.options.saveState,!1),n.options.saveStateKey=n.options.saveStateKey||"",n.options.allowFilter=u.getBoolDefaultValue(n.options.allowFilter,!0),n.options.allowExport=u.getBoolDefaultValue(n.options.allowExport,!1),n.options.pageSize=n.options.pageSize||5,n.options.pageNum=n.options.pageNum||1,n.options.textSearching=n.options.textSearching||"common.searching",n.options.textNoResults=n.options.textNoResults||"common.noRecordFound",n.cols=n.cols||[],n.options.required=n.options.required||!1,n.options.disabled=n.options.disabled||!1,n.options.readOnly=n.options.readOnly||!1,n.options.apiUrl=n.options.apiUrl||"",n.options.apiParams=n.options.apiParams||{},f(function(){m([n.ngModel,""],[null,""])})})}}}]),angular.module("emixApp.controllers").controller("dropboxgridmodal_index",["$scope","passObject","$modalInstance","shareFunc","sharedInfo","$translate","$timeout",function(e,t,n,a,r,o,i){e.dtOptions=t.options,e.dtCols=t.dtCols||[],e.dtCols.length>0&&e.dtCols[e.dtCols.length-1].name.length>0&&e.dtCols.push({name:"",title:"",allowSorting:!1,headerClass:"text-center tdmini",cellClass:"tdcommand tdmini"}),e.dtData=[],e.dtAdditionalData=t.additionalData,e.dtEvents=t.events||{},e.dtEvents.onRowClick=function(e){n.close(e)},e.closeModal=function(){n.dismiss("cancel")}}]),angular.module("emixApp.directives").directive("counterBox",["$timeout","$rootScope",function(e,t){return{restrict:"A",scope:{value:"=value"},templateUrl:"/panelshare/directives/input-box/counter-box-template.html"+t.version,replace:!0,link:function(t,n,a){var r,o=angular.isUndefined(a.min)?void 0:parseInt(a.min),i=angular.isUndefined(a.max)?void 0:parseInt(a.max),l=angular.isUndefined(a.step)||0===parseInt(a.step)?1:parseInt(a.step);if(r=function(e){var t=parseInt(e);return isNaN(t)?(console.log("parsedValue must parse to a number."),t=o||0):void 0!==o&&o>t?t=o:void 0!==i&&i<t?t=i:t},angular.isUndefined(t.value))throw"Missing the value attribute on the counter directive.";t.readonly=angular.isUndefined(a.editable),t.addclass=angular.isUndefined(a.addclass)?null:a.addclass,t.width=angular.isUndefined(a.width)?{}:{width:a.width},t.value=r(t.value),t.id=angular.isUndefined(a.id)?"counterbx":a.id,t.label=angular.isUndefined(a.label)?"label":a.label,t.size=angular.isUndefined(a.size)?"":a.size,t.minus=function(){t.value=r(t.value-l)},t.plus=function(){t.value=r(t.value+l)},t.changed=function(){e(function(){t.value=r(t.value)},1e3,!0)},t.blurred=function(){t.value=r(t.value)}}}}]);